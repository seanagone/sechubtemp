ID,Title,Related requirements,Category,Severity,Resource type,AWS Config rule,Schedule type,Parameters,Description
Account.1,Security contact information should be provided for an AWS account.,"NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Identify > Resource Configuration,Medium,AWS::::Account,security-account-information-provided,Periodic,None," This control checks if an Amazon Web Services (AWS) account has security contact information. The control fails if security contact information is not provided for the account. Alternate security contacts allow AWS to contact another person about issues with your account in case you're unavailable. Notifications can be from AWS Support, or other AWS service teams about security-related topics associated with your AWS account usage."
Account.2,AWS accounts should be part of an AWS Organizations organization,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure access management > Access control,High,AWS::::Account,account-part-of-organizations,Periodic,None," This control checks if an AWS account is part of an organization managed through AWS Organizations. The control fails if the account is not part of an organization. Organizations helps you centrally manage your environment as you scale your workloads on AWS. You can use multiple AWS accounts to isolate workloads that have specific security requirements, or to comply with frameworks such as HIPAA or PCI. By creating an organization, you can administer multiple accounts as a single unit and centrally manage their access to AWS services, resources, and Regions."
ACM.1,Imported and ACM-issued certificates should be renewed after a specified time period,"NIST.800-53.r5 SC-28(3), NIST.800-53.r5 SC-7(16)",Protect > Data protection > Encryption of data in transit,Medium,AWS::ACM::Certificate,acm-certificate-expiration-check,Change triggered,," This control checks whether an AWS Certificate Manager (ACM) certificate is renewed within the specified time period. It checks both imported certificates and certificates provided by ACM. The control fails if the certificate isn't renewed within the specified time period. Unless you provide a custom parameter value for the renewal period, Security Hub uses a default value of 30 days. ACM can automatically renew certificates that use DNS validation. For certificates that use email validation, you must respond to a domain validation email. ACM doesn't automatically renew certificates that you import. You must renew imported certificates manually."
ACM.2,"RSA certificates managed by ACM should use a key length of at least 2,048 bits",,Identify > Inventory > Inventory services,High,AWS::ACM::Certificate,acm-certificate-rsa-check,Change triggered,None," This control checks whether RSA certificates managed by AWS Certificate Manager use a key length of at least 2,048 bits. The control fails if the key length is smaller than 2,048 bits. The strength of encryption directly correlates with key size. We recommend key lengths of at least 2,048 bits to protect your AWS resources as computing power becomes less expensive and servers become more advanced."
APIGateway.1,API Gateway REST and WebSocket API execution logging should be enabled,"NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,"AWS::ApiGateway::Stage   ,   AWS::ApiGatewayV2::Stage",api-gw-execution-logging-enabled,Change triggered,," This control checks whether all stages of an Amazon API Gateway REST or WebSocket API have logging enabled. The control fails if the   loggingLevel   isn't   ERROR   or   INFO   for all stages of the API. Unless you provide custom parameter values to indicate that a specific log type should be enabled, Security Hub produces a passed finding if the logging level is either   ERROR   or   INFO   . API Gateway REST or WebSocket API stages should have relevant logs enabled. API Gateway REST and WebSocket API execution logging provides detailed records of requests made to API Gateway REST and WebSocket API stages. The stages include API integration backend responses, Lambda authorizer responses, and the   requestId   for AWS integration endpoints."
APIGateway.2,API Gateway REST API stages should be configured to use SSL certificates for backend authentication,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Data protection,Medium,AWS::ApiGateway::Stage,api-gw-ssl-enabled,Change triggered,None, This control checks whether Amazon API Gateway REST API stages have SSL certificates configured. Backend systems use these certificates to authenticate that incoming requests are from API Gateway. API Gateway REST API stages should be configured with SSL certificates to allow backend systems to authenticate that requests originate from API Gateway.
APIGateway.3,API Gateway REST API stages should have AWS X-Ray tracing enabled,NIST.800-53.r5 CA-7,Detect > Detection services,Low,AWS::ApiGateway::Stage,api-gw-xray-enabled,Change triggered,None, This control checks whether AWS X-Ray active tracing is enabled for your Amazon API Gateway REST API stages. X-Ray active tracing enables a more rapid response to performance changes in the underlying infrastructure. Changes in performance could result in a lack of availability of the API. X-Ray active tracing provides real-time metrics of user requests that flow through your API Gateway REST API operations and connected services.
APIGateway.4,API Gateway should be associated with a WAF Web ACL,NIST.800-53.r5 AC-4(21),Protect > Protective services,Medium,AWS::ApiGateway::Stage,api-gw-associated-with-waf,Change triggered,None," This control checks whether an API Gateway stage uses an AWS WAF web access control list (ACL). This control fails if an AWS WAF web ACL is not attached to a REST API Gateway stage. AWS WAF is a web application firewall that helps protect web applications and APIs from attacks. It enables you to configure an ACL, which is a set of rules that allow, block, or count web requests based on customizable web security rules and conditions that you define. Ensure that your API Gateway stage is associated with an AWS WAF web ACL to help protect it from malicious attacks."
APIGateway.5,API Gateway REST API cache data should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::ApiGateway::Stage,api-gw-cache-encrypted   (custom Security Hub rule),Change triggered,None," This control checks whether all methods in API Gateway REST API stages that have cache enabled are encrypted. The control fails if any method in an API Gateway REST API stage is configured to cache and the cache is not encrypted. Security Hub evaluates the encryption of a particular method only when caching is enabled for that method. Encrypting data at rest reduces the risk of data stored on disk being accessed by a user not authenticated to AWS. It adds another set of access controls to limit unauthorized users ability access the data. For example, API permissions are required to decrypt the data before it can be read. API Gateway REST API caches should be encrypted at rest for an added layer of security."
APIGateway.8,API Gateway routes should specify an authorization type,"NIST.800-53.r5 AC-3, NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Protect > Secure Access Management,Medium,AWS::ApiGatewayV2::Route,api-gwv2-authorization-type-configured,Periodic,," This control checks if Amazon API Gateway routes have an authorization type. The control fails if the API Gateway route doesn't have any authorization type. Optionally, you can provide a custom parameter value if you want the control to pass only if the route uses the authorization type specified in the   authorizationType   parameter. API Gateway supports multiple mechanisms for controlling and managing access to your API. By specifying an authorization type, you can restrict access to your API to only authorized users or processes."
APIGateway.9,Access logging should be configured for API Gateway V2 Stages,"NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::ApiGatewayV2::Stage,api-gwv2-access-logs-enabled,Change triggered,None," This control checks if Amazon API Gateway V2 stages have access logging configured. This control fails if access log settings aren't defined. API Gateway access logs provide detailed information about who has accessed your API and how the caller accessed the API. These logs are useful for applications such as security and access audits and forensics investigation. Enable these access logs to analyze traffic patterns and to troubleshoot issues. For additional best practices, see   Monitoring REST APIs   in the   API Gateway Developer Guide   ."
AppSync.2,AWS AppSync should have field-level logging enabled,,Identify > Logging,Medium,AWS::AppSync::GraphQLApi,appsync-logging-enabled,Change triggered,," This control checks whether an AWS AppSync API has field-level logging turned on. The control fails if the field resolver log level is set to   None   . Unless you provide custom parameter values to indicate that a specific log type should be enabled, Security Hub produces a passed finding if the field resolver log level is either   ERROR   or   ALL   . You can use logging and metrics to identify, troubleshoot, and optimize your GraphQL queries. Turning on logging for AWS AppSync GraphQL helps you get detailed information about API requests and responses, identify and respond to issues, and comply with regulatory requirements."
AppSync.5,AWS AppSync GraphQL APIs should not be authenticated with API keys,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6",Protect > Secure access management > Passwordless authentication,High,AWS::AppSync::GraphQLApi,appsync-authorization-check,Change triggered,," This control checks whether your application uses an API key to interact with an AWS AppSync GraphQL API. The control fails if an AWS AppSync GraphQL API is authenticated with an API key. An API key is a hard-coded value in your application that is generated by the AWS AppSync service when you create an unauthenticated GraphQL endpoint. If this API key is compromised, your endpoint is vulnerable to unintended access. Unless you are supporting a publicly accessible application or website, we don't recommend using an API key for authentication."
Athena.1,Athena workgroups should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::Athena::WorkGroup,athena-workgroup-encrypted-at-rest,Change triggered,None," This control checks if an Athena workgroup is encrypted at rest. The control fails if an Athena workgroup isnât encrypted at rest. In Athena, you can create workgroups for running queries for teams, applications, or different workloads. Each workgroup has a setting to enable encryption on all queries. You have the option to use server-side encryption with Amazon Simple Storage Service (Amazon S3) managed keys, server-side encryption with AWS Key Management Service (AWS KMS) keys, or client-side encryption with customer managed KMS keys. Data at rest refers to any data that's stored in persistent, non-volatile storage for any duration. Encryption helps you protect the confidentiality of such data, reducing the risk that an unauthorized user can access it."
AutoScaling.1,Auto Scaling groups associated with a Classic Load Balancer should use load balancer health checks,"PCI DSS v3.2.1/2.2, NIST.800-53.r5 CA-7, NIST.800-53.r5 CP-2(2), NIST.800-53.r5 SI-2",Identify > Inventory,Low,AWS::AutoScaling::AutoScalingGroup,autoscaling-group-elb-healthcheck-required,Change triggered,None, This control checks whether your Auto Scaling groups that are associated with a Classic Load Balancer are using Elastic Load Balancing health checks. This ensures that the group can determine an instance's health based on additional tests provided by the load balancer. Using Elastic Load Balancing health checks can help support the availability of applications that use EC2 Auto Scaling groups.
AutoScaling.2,Amazon EC2 Auto Scaling group should cover multiple Availability Zones,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-2(2), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High Availability,Medium,AWS::AutoScaling::AutoScalingGroup,autoscaling-multiple-az,Change triggered,," This control checks whether an Amazon EC2 Auto Scaling group spans at least the specified number of Availability Zones (AZs). The control fails if an Auto Scaling group doesn't span at least the specified number of AZs. Unless you provide a custom parameter value for the minimum number of AZs, Security Hub uses a default value of two AZs. An Auto Scaling group that doesn't span multiple AZs can't launch instances in another AZ to compensate if the configured single AZ becomes unavailable. However, an Auto Scaling group with a single Availability Zone may be preferred in some use cases, such as batch jobs or when inter-AZ transfer costs need to be kept to a minimum. In such cases, you can disable this control or suppress its findings."
AutoScaling.3,Auto Scaling group launch configurations should configure EC2 instances to require Instance Metadata Service Version 2 (IMDSv2),"NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6, NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure network configuration,High,AWS::AutoScaling::LaunchConfiguration,autoscaling-launchconfig-requires-imdsv2,Change triggered,None, This control checks whether IMDSv2 is enabled on all instances launched by Amazon EC2 Auto Scaling groups. The control fails if the Instance Metadata Service (IMDS) version is not included in the launch configuration or if both IMDSv1 and IMDSv2 are enabled. IMDS provides data about your instance that you can use to configure or manage the running instance. Version 2 of the IMDS adds new protections that weren't available in IMDSv1 to further safeguard your EC2 instances.
AutoScaling.4,Auto Scaling group launch configuration should not have a metadata response hop limit greater than 1,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Protect > Secure network configuration,High,AWS::AutoScaling::LaunchConfiguration,autoscaling-launch-config-hop-limit,Change triggered,None," This control checks the number of network hops that a metadata token can travel. The control fails if the metadata response hop limit is greater than   1   . The Instance Metadata Service (IMDS) provides metadata information about an Amazon EC2 instance and is useful for application configuration. Restricting the HTTP   PUT   response for the metadata service to only the EC2 instance protects the IMDS from unauthorized use. The Time To Live (TTL) field in the IP packet is reduced by one on every hop. This reduction can be used to ensure that the packet does not travel outside EC2. IMDSv2 protects EC2 instances that may have been misconfigured as open routers, layer 3 firewalls, VPNs, tunnels, or NAT devices, which prevents unauthorized users from retrieving metadata. With IMDSv2, the   PUT   response that contains the secret token cannot travel outside the instance because the default metadata response hop limit is set to   1   . However, if this value is greater than   1   , the token can leave the EC2 instance."
Autoscaling.5,Amazon EC2 instances launched using Auto Scaling group launch configurations should not have Public IP addresses,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,High,AWS::AutoScaling::LaunchConfiguration,autoscaling-launch-config-public-ip-disabled,Change triggered,None," This control checks whether an Auto Scaling group's associated launch configuration assigns a   public IP address   to the group's instances. The control fails if the associated launch configuration assigns a public IP address. Amazon EC2 instances in an Auto Scaling group launch configuration should not have an associated public IP address, except for in limited edge cases. Amazon EC2 instances should only be accessible from behind a load balancer instead of being directly exposed to the internet."
AutoScaling.6,Auto Scaling groups should use multiple instance types in multiple Availability Zones,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-2(2), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High Availability,Medium,AWS::AutoScaling::AutoScalingGroup,autoscaling-multiple-instance-types,Change triggered,None, This control checks whether an Amazon EC2 Auto Scaling group uses multiple instance types. The control fails if the Auto Scaling group has only one instance type defined. You can enhance availability by deploying your application across multiple instance types running in multiple Availability Zones. Security Hub recommends using multiple instance types so that the Auto Scaling group can launch another instance type if there is insufficient instance capacity in your chosen Availability Zones.
AutoScaling.9,Amazon EC2 Auto Scaling groups should use Amazon EC2 launch templates,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Identify > Resource Configuration,Medium,AWS::AutoScaling::AutoScalingGroup,autoscaling-launch-template,Change triggered,None," This control checks whether an Amazon EC2 Auto Scaling group is created from an EC2 launch template. This control fails if an Amazon EC2 Auto Scaling group is not created with a launch template or if a launch template is not specified in a mixed instances policy. An EC2 Auto Scaling group can be created from either an EC2 launch template or a launch configuration. However, using a launch template to create an Auto Scaling group ensures that you have access to the latest features and improvements."
Backup.1,AWS Backup recovery points should be encrypted at rest,"NIST.800-53.r5 CP-9(8), NIST.800-53.r5 SI-12",Protect > Data protection > Encryption of data-at-rest,Medium,AWS::Backup::RecoveryPoint,backup-recovery-point-encrypted,Change triggered,None," This control checks if an AWS Backup recovery point is encrypted at rest. The control fails if the recovery point isn't encrypted at rest. An AWS Backup recovery point refers to a specific copy or snapshot of data that is created as part of a backup process. It represents a particular moment in time when the data was backed up and serves as a restore point in case the original data becomes lost, corrupted, or inaccessible. Encrypting the backup recovery points adds an extra layer of protection against unauthorized access. Encryption is a best practice to protect the confidentiality, integrity, and security of backup data."
CloudFormation.1,CloudFormation stacks should be integrated with Simple Notification Service (SNS),"NIST.800-53.r5 SI-4(12), NIST.800-53.r5 SI-4(5)",Detect > Detection services > Application monitoring,Low,AWS::CloudFormation::Stack,cloudformation-stack-notification-check,Change triggered,None, This control checks whether an Amazon Simple Notification Service notification is integrated with an AWS CloudFormation stack. The control fails for a CloudFormation stack if no SNS notification is associated with it. Configuring an SNS notification with your CloudFormation stack helps immediately notify stakeholders of any events or changes occurring with the stack.
CloudFront.1,CloudFront distributions should have a default root object configured,"NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16)",Protect > Secure access management > Resources not publicly accessible,High,AWS::CloudFront::Distribution,cloudfront-default-root-object-configured,Change triggered,None," This control checks whether an Amazon CloudFront distribution is configured to return a specific object that is the default root object. The control fails if the CloudFront distribution does not have a default root object configured. A user might sometimes request the distribution's root URL instead of an object in the distribution. When this happens, specifying a default root object can help you to avoid exposing the contents of your web distribution."
CloudFront.3,CloudFront distributions should require encryption in transit,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data in transit,Medium,AWS::CloudFront::Distribution,cloudfront-viewer-policy-https,Change triggered,None, This control checks whether an Amazon CloudFront distribution requires viewers to use HTTPS directly or whether it uses redirection. The control fails if   ViewerProtocolPolicy   is set to   allow-all   for   defaultCacheBehavior   or for   cacheBehaviors   . HTTPS (TLS) can be used to help prevent potential attackers from using person-in-the-middle or similar attacks to eavesdrop on or manipulate network traffic. Only encrypted connections over HTTPS (TLS) should be allowed. Encrypting data in transit can affect performance. You should test your application with this feature to understand the performance profile and the impact of TLS.
CloudFront.4,CloudFront distributions should have origin failover configured,"NIST.800-53.r5 CP-10, NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Low,AWS::CloudFront::Distribution,cloudfront-origin-failover-enabled,Change triggered,None, This control checks whether an Amazon CloudFront distribution is configured with an origin group that has two or more origins. CloudFront origin failover can increase availability. Origin failover automatically redirects traffic to a secondary origin if the primary origin is unavailable or if it returns specific HTTP response status codes.
CloudFront.5,CloudFront distributions should have logging enabled,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::CloudFront::Distribution,cloudfront-accesslogs-enabled,Change triggered,None," This control checks whether server access logging is enabled on CloudFront distributions. The control fails if access logging is not enabled for a distribution. CloudFront access logs provide detailed information about every user request that CloudFront receives. Each log contains information such as the date and time the request was received, the IP address of the viewer that made the request, the source of the request, and the port number of the request from the viewer. These logs are useful for applications such as security and access audits and forensics investigation. For additional guidance on how to analyze access logs, see   Querying Amazon CloudFront logs   in the   Amazon Athena User Guide   ."
CloudFront.6,CloudFront distributions should have WAF enabled,NIST.800-53.r5 AC-4(21),Protect > Protective services,Medium,AWS::CloudFront::Distribution,cloudfront-associated-with-waf,Change triggered,None," This control checks whether CloudFront distributions are associated with either AWS WAF Classic or AWS WAF web ACLs. The control fails if the distribution is not associated with a web ACL. AWS WAF is a web application firewall that helps protect web applications and APIs from attacks. It allows you to configure a set of rules, called a web access control list (web ACL), that allow, block, or count web requests based on customizable web security rules and conditions that you define. Ensure your CloudFront distribution is associated with an AWS WAF web ACL to help protect it from malicious attacks."
CloudFront.7,CloudFront distributions should use custom SSL/TLS certificates,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data-in-transit,Medium,AWS::CloudFront::Distribution,cloudfront-custom-ssl-certificate,Change triggered,None," This control checks whether CloudFront distributions are using the default SSL/TLS certificate CloudFront provides. This control passes if the CloudFront distribution uses a custom SSL/TLS certificate. This control fails if the CloudFront distribution uses the default SSL/TLS certificate. Custom SSL/TLS allow your users to access content by using alternate domain names. You can store custom certificates in AWS Certificate Manager (recommended), or in IAM."
CloudFront.8,CloudFront distributions should use SNI to serve HTTPS requests,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure network configuration,Low,AWS::CloudFront::Distribution,cloudfront-sni-enabled,Change triggered,None," This control checks if Amazon CloudFront distributions are using a custom SSL/TLS certificate and are configured to use SNI to serve HTTPS requests. This control fails if a custom SSL/TLS certificate is associated but the SSL/TLS support method is a dedicated IP address. Server Name Indication (SNI) is an extension to the TLS protocol that is supported by browsers and clients released after 2010. If you configure CloudFront to serve HTTPS requests using SNI, CloudFront associates your alternate domain name with an IP address for each edge location. When a viewer submits an HTTPS request for your content, DNS routes the request to the IP address for the correct edge location. The IP address to your domain name is determined during the SSL/TLS handshake negotiation; the IP address isn't dedicated to your distribution."
CloudFront.9,CloudFront distributions should encrypt traffic to custom origins,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data-in-transit,Medium,AWS::CloudFront::Distribution,cloudfront-traffic-to-origin-encrypted,Change triggered,None, This control checks if Amazon CloudFront distributions are encrypting traffic to custom origins. This control fails for a CloudFront distribution whose origin protocol policy allows 'http-only'. This control also fails if the distribution's origin protocol policy is 'match-viewer' while the viewer protocol policy is 'allow-all'. HTTPS (TLS) can be used to help prevent eavesdropping or manipulation of network traffic. Only encrypted connections over HTTPS (TLS) should be allowed.
CloudFront.10,CloudFront distributions should not use deprecated SSL protocols between edge locations and custom origins,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data-in-transit,Medium,AWS::CloudFront::Distribution,cloudfront-no-deprecated-ssl-protocols,Change triggered,None," This control checks if Amazon CloudFront distributions are using deprecated SSL protocols for HTTPS communication between CloudFront edge locations and your custom origins. This control fails if a CloudFront distribution has a   CustomOriginConfig   where   OriginSslProtocols   includes   SSLv3   . In 2015, the Internet Engineering Task Force (IETF) officially announced that SSL 3.0 should be deprecated due to the protocol being insufficiently secure. It is recommended that you use TLSv1.2 or later for HTTPS communication to your custom origins."
CloudFront.12,CloudFront distributions should not point to non-existent S3 origins,"NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Identify > Resource configuration,High,AWS::CloudFront::Distribution,cloudfront-s3-origin-non-existent-bucket,Periodic,None," This control checks whether Amazon CloudFront distributions are pointing to non-existent Amazon S3 origins. The control fails for a CloudFront distribution if the origin is configured to point to a non-existent bucket. This control only applies to CloudFront distributions where an S3 bucket without static website hosting is the S3 origin. When a CloudFront distribution in your account is configured to point to a non-existent bucket, a malicious third party can create the referenced bucket and serve their own content through your distribution. We recommend checking all origins regardless of routing behavior to ensure that your distributions are pointing to appropriate origins."
CloudFront.13,CloudFront distributions should use origin access control,,Protect > Secure access management > Resource policy configuration,Medium,AWS::CloudFront::Distribution,cloudfront-s3-origin-access-control-enabled,Change triggered,None," This control checks whether an Amazon CloudFront distribution with an Amazon S3 origin has origin access control (OAC) configured. The control fails if OAC isn't configured for the CloudFront distribution. When using an S3 bucket as an origin for your CloudFront distribution, you can enable OAC. This permits access to the content in the bucket only through the specified CloudFront distribution, and prohibits access directly from the bucket or another distribution. Although CloudFront supports Origin Access Identity (OAI), OAC offers additional functionality, and distributions using OAI can migrate to OAC. While OAI provides a secure way to access S3 origins, it has limitations, such as lack of support for granular policy configurations and for HTTP/HTTPS requests that use the POST method in AWS Regions that require AWS Signature Version 4 (SigV4). OAI also doesn't support encryption with AWS Key Management Service. OAC is based on an AWS best practice of using IAM service principals to authenticate with S3 origins."
CloudTrail.1,CloudTrail should be enabled and configured with at least one multi-Region trail that includes read and write management events,"CIS AWS Foundations Benchmark v1.2.0/2.1, CIS AWS Foundations Benchmark v1.4.0/3.1, NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 AU-14(1), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8), NIST.800-53.r5 SA-8(22)",Identify > Logging,High,AWS::::Account,multi-region-cloudtrail-enabled,Periodic,," This control checks that there is at least one multi-Region CloudTrail trail. It also checks that the   ExcludeManagementEventSources   parameter is empty for at least one of those trails. AWS CloudTrail records AWS API calls for your account and delivers log files to you. The recorded information includes the following information. CloudTrail provides a history of AWS API calls for an account, including API calls made from the AWS Management Console, AWS SDKs, command line tools. The history also includes API calls from higher-level AWS services such as AWS CloudFormation. The AWS API call history produced by CloudTrail enables security analysis, resource change tracking, and compliance auditing. Multi-Region trails also provide the following benefits. By default, CloudTrail trails that are created using the AWS Management Console are multi-Region trails."
CloudTrail.2,CloudTrail should have encryption at-rest enabled,"PCI DSS v3.2.1/3.4, CIS AWS Foundations Benchmark v1.2.0/2.7, CIS AWS Foundations Benchmark v1.4.0/3.7, NIST.800-53.r5 AU-9, NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::CloudTrail::Trail,cloud-trail-encryption-enabled,Periodic,None," This control checks whether CloudTrail is configured to use the server-side encryption (SSE) AWS KMS key encryption. The control fails if the   KmsKeyId   isn't defined. For an added layer of security for your sensitive CloudTrail log files, you should use   server-side encryption with AWS KMS keys (SSE-KMS)   for your CloudTrail log files for encryption at rest. Note that by default, the log files delivered by CloudTrail to your buckets are encrypted by   Amazon server-side encryption with Amazon S3-managed encryption keys (SSE-S3)   ."
CloudTrail.3,CloudTrail should be enabled,"PCI DSS v3.2.1/10.1, PCI DSS v3.2.1/10.2.1, PCI DSS v3.2.1/10.2.2, PCI DSS v3.2.1/10.2.3, PCI DSS v3.2.1/10.2.4, PCI DSS v3.2.1/10.2.5, PCI DSS v3.2.1/10.2.6, PCI DSS v3.2.1/10.2.7, PCI DSS v3.2.1/10.3.1, PCI DSS v3.2.1/10.3.2, PCI DSS v3.2.1/10.3.3, PCI DSS v3.2.1/10.3.4, PCI DSS v3.2.1/10.3.5, PCI DSS v3.2.1/10.3.6",Identify > Logging,High,AWS::::Account,cloudtrail-enabled,Periodic,None," This control checks whether CloudTrail is enabled in your AWS account. The control fails if your account doesn't have at least one CloudTrail trail. However, some AWS services do not enable logging of all APIs and events. You should implement any additional audit trails other than CloudTrail and review the documentation for each service in   CloudTrail Supported Services and Integrations   ."
CloudTrail.4,CloudTrail log file validation should be enabled,"PCI DSS v3.2.1/10.5.2, PCI DSS v3.2.1/10.5.5, CIS AWS Foundations Benchmark v1.2.0/2.2, CIS AWS Foundations Benchmark v1.4.0/3.2, NIST.800-53.r5 AU-9, NIST.800-53.r5 SI-4, NIST.800-53.r5 SI-7(1), NIST.800-53.r5 SI-7(3), NIST.800-53.r5 SI-7(7)",Data protection > Data integrity,Low,AWS::CloudTrail::Trail,cloud-trail-log-file-validation-enabled,Periodic,None," This control checks whether log file integrity validation is enabled on a CloudTrail trail. CloudTrail log file validation creates a digitally signed digest file that contains a hash of each log that CloudTrail writes to Amazon S3. You can use these digest files to determine whether a log file was changed, deleted, or unchanged after CloudTrail delivered the log. Security Hub recommends that you enable file validation on all trails. Log file validation provides additional integrity checks of CloudTrail logs."
CloudTrail.5,CloudTrail trails should be integrated with Amazon CloudWatch Logs,"PCI DSS v3.2.1/10.5.3, CIS AWS Foundations Benchmark v1.2.0/2.4, CIS AWS Foundations Benchmark v1.4.0/3.4, NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(1), NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 AU-6(5), NIST.800-53.r5 AU-7(1), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-20, NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-4(5), NIST.800-53.r5 SI-7(8)",Identify > Logging,Low,AWS::CloudTrail::Trail,cloud-trail-cloud-watch-logs-enabled,Periodic,None," This control checks whether CloudTrail trails are configured to send logs to CloudWatch Logs. The control fails if the   CloudWatchLogsLogGroupArn   property of the trail is empty. CloudTrail uses Amazon S3 for log file storage and delivery. You can capture CloudTrail logs in a specified S3 bucket for long-term analysis. To perform real-time analysis, you can configure CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all Regions in an account, CloudTrail sends log files from all of those Regions to a CloudWatch Logs log group. Security Hub recommends that you send CloudTrail logs to CloudWatch Logs. Note that this recommendation is intended to ensure that account activity is captured, monitored, and appropriately alarmed on. You can use CloudWatch Logs to set this up with your AWS services. This recommendation does not preclude the use of a different solution. Sending CloudTrail logs to CloudWatch Logs facilitates real-time and historic activity logging based on user, API, resource, and IP address. You can use this approach to establish alarms and notifications for anomalous or sensitivity account activity."
CloudTrail.6,Ensure the S3 bucket used to store CloudTrail logs is not publicly accessible,"CIS AWS Foundations Benchmark v1.2.0/2.3, CIS AWS Foundations Benchmark v1.4.0/3.3",Identify > Logging,Critical,AWS::CloudTrail::Trail,None (custom Security Hub rule),Periodic and change triggered,None," CloudTrail logs a record of every API call made in your account. These log files are stored in an S3 bucket. CIS recommends that the S3 bucket policy, or access control list (ACL), applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs. Allowing public access to CloudTrail log content might aid an adversary in identifying weaknesses in the affected account's use or configuration. To run this check, Security Hub first uses custom logic to look for the S3 bucket where your CloudTrail logs are stored. It then uses the AWS Config managed rules to check that bucket is publicly accessible. If you aggregate your logs into a single centralized S3 bucket, then Security Hub only runs the check against the account and Region where the centralized S3 bucket is located. For other accounts and Regions, the control status is   No data   . If the bucket is publicly accessible, the check generates a failed finding."
CloudTrail.7,Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket,"CIS AWS Foundations Benchmark v1.2.0/2.6, CIS AWS Foundations Benchmark v1.4.0/3.6",Identify > Logging,Low,AWS::CloudTrail::Trail,None (custom Security Hub rule),Periodic,None," S3 bucket access logging generates a log that contains access records for each request made to your S3 bucket. An access log record contains details about the request, such as the request type, the resources specified in the request worked, and the time and date the request was processed. CIS recommends that you enable bucket access logging on the CloudTrail S3 bucket. By enabling S3 bucket logging on target S3 buckets, you can capture all events that might affect objects in a target bucket. Configuring logs to be placed in a separate bucket enables access to log information, which can be useful in security and incident response workflows. To run this check, Security Hub first uses custom logic to look for the bucket where your CloudTrail logs are stored and then uses the AWS Config managed rule to check if logging is enabled. If CloudTrail delivers log files from multiple AWS accounts into a single destination Amazon S3 bucket, Security Hub evaluates this control only against the destination bucket in the Region where it's located. This streamlines your findings. However, you should turn on CloudTrail in all accounts that deliver logs to the destination bucket. For all accounts except the one that holds the destination bucket, the control status is   No data   . If the bucket is publicly accessible, the check generates a failed finding."
CloudWatch.1,"A log metric filter and alarm should exist for usage of the ""root"" user","PCI DSS v3.2.1/7.2.1, CIS AWS Foundations Benchmark v1.2.0/1.1,CIS AWS Foundations Benchmark v1.2.0/3.3, CIS AWS Foundations Benchmark v1.4.0/1.7,CIS AWS Foundations Benchmark v1.4.0/4.3",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," The root user has unrestricted access to all services and resources in an AWS account. We highly recommend that you avoid using the root user for daily tasks. Minimizing the use of the root user and adopting the principle of least privilege for access management reduce the risk of accidental changes and unintended disclosure of highly privileged credentials. As a best practice, use your root user credentials only when required to   perform account and service management tasks   . Apply AWS Identity and Access Management (IAM) policies directly to groups and roles but not users. For a tutorial on how to set up an administrator for daily use, see   Creating your first IAM admin user and group   in the   IAM User Guide To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 1.7 in the   CIS AWS Foundations Benchmark v1.4.0   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.2,Ensure a log metric filter and alarm exist for unauthorized API calls,CIS AWS Foundations Benchmark v1.2.0/3.1,Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. CIS recommends that you create a metric filter and alarm unauthorized API calls. Monitoring unauthorized API calls helps reveal application errors and might reduce time to detect malicious activity. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.1 in the   CIS AWS Foundations Benchmark v1.2   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.3,Ensure a log metric filter and alarm exist for Management Console sign-in without MFA,CIS AWS Foundations Benchmark v1.2.0/3.2,Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. CIS recommends that you create a metric filter and alarm console logins that aren't protected by MFA. Monitoring for single-factor console logins increases visibility into accounts that aren't protected by MFA. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 3.2 in the   CIS AWS Foundations Benchmark v1.2   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.4,Ensure a log metric filter and alarm exist for IAM policy changes,"CIS AWS Foundations Benchmark v1.2.0/3.4, CIS AWS Foundations Benchmark v1.4.0/4.4",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None, This control checks whether you monitor API calls in real time by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. CIS recommends that you create a metric filter and alarm for changes made to IAM policies. Monitoring these changes helps ensure that authentication and authorization controls remain intact.
CloudWatch.5,Ensure a log metric filter and alarm exist for CloudTrail AWS Configuration changes,"CIS AWS Foundations Benchmark v1.2.0/3.5, CIS AWS Foundations Benchmark v1.4.0/4.5",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. CIS recommends that you create a metric filter and alarm for changes to CloudTrail configuration settings. Monitoring these changes helps ensure sustained visibility to activities in the account. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 4.5 in the   CIS AWS Foundations Benchmark v1.4.0   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.6,Ensure a log metric filter and alarm exist for AWS Management Console authentication failures,"CIS AWS Foundations Benchmark v1.2.0/3.6, CIS AWS Foundations Benchmark v1.4.0/4.6",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. CIS recommends that you create a metric filter and alarm for failed console authentication attempts. Monitoring failed console logins might decrease lead time to detect an attempt to brute-force a credential, which might provide an indicator, such as source IP, that you can use in other event correlations. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 4.6 in the   CIS AWS Foundations Benchmark v1.4.0   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.7,Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer managed keys,"CIS AWS Foundations Benchmark v1.2.0/3.7, CIS AWS Foundations Benchmark v1.4.0/4.7",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. CIS recommends that you create a metric filter and alarm for customer managed keys that have changed state to disabled or scheduled deletion. Data encrypted with disabled or deleted keys is no longer accessible. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 4.7 in the   CIS AWS Foundations Benchmark v1.4.0   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters. The control also fails if   ExcludeManagementEventSources   contains   kms.amazonaws.com   ."
CloudWatch.8,Ensure a log metric filter and alarm exist for S3 bucket policy changes,"CIS AWS Foundations Benchmark v1.2.0/3.8, CIS AWS Foundations Benchmark v1.4.0/4.8",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. CIS recommends that you create a metric filter and alarm for changes to S3 bucket policies. Monitoring these changes might reduce time to detect and correct permissive policies on sensitive S3 buckets. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 4.8 in the   CIS AWS Foundations Benchmark v1.4.0   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.9,Ensure a log metric filter and alarm exist for AWS Config configuration changes,"CIS AWS Foundations Benchmark v1.2.0/3.9, CIS AWS Foundations Benchmark v1.4.0/4.9",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. CIS recommends that you create a metric filter and alarm for changes to AWS Config configuration settings. Monitoring these changes helps ensure sustained visibility of configuration items in the account. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 4.9 in the   CIS AWS Foundations Benchmark v1.4.0   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.10,Ensure a log metric filter and alarm exist for security group changes,"CIS AWS Foundations Benchmark v1.2.0/3.10, CIS AWS Foundations Benchmark v1.4.0/4.10",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Security groups are a stateful packet filter that controls ingress and egress traffic in a VPC. CIS recommends that you create a metric filter and alarm for changes to security groups. Monitoring these changes helps ensure that resources and services aren't unintentionally exposed. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 4.10 in the   CIS AWS Foundations Benchmark v1.4.0   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.11,Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL),"CIS AWS Foundations Benchmark v1.2.0/3.11, CIS AWS Foundations Benchmark v1.4.0/4.11",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets in a VPC. CIS recommends that you create a metric filter and alarm for changes to NACLs. Monitoring these changes helps ensure that AWS resources and services aren't unintentionally exposed. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 4.11 in the   CIS AWS Foundations Benchmark v1.4.0   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.12,Ensure a log metric filter and alarm exist for changes to network gateways,"CIS AWS Foundations Benchmark v1.2.0/3.12, CIS AWS Foundations Benchmark v1.4.0/4.12",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send and receive traffic to a destination outside a VPC. CIS recommends that you create a metric filter and alarm for changes to network gateways. Monitoring these changes helps ensure that all ingress and egress traffic traverses the VPC border via a controlled path. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 4.12 in the   CIS AWS Foundations Benchmark v1.2   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.13,Ensure a log metric filter and alarm exist for route table changes,"CIS AWS Foundations Benchmark v1.2.0/3.13, CIS AWS Foundations Benchmark v1.4.0/4.13",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None, This control checks whether you monitor API calls in real time by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables route network traffic between subnets and to network gateways. CIS recommends that you create a metric filter and alarm for changes to route tables. Monitoring these changes helps ensure that all VPC traffic flows through an expected path.
CloudWatch.14,Ensure a log metric filter and alarm exist for VPC changes,"CIS AWS Foundations Benchmark v1.2.0/3.14, CIS AWS Foundations Benchmark v1.4.0/4.14",Detect > Detection services,Low,"AWS::Logs::MetricFilter   ,   AWS::CloudWatch::Alarm   ,   AWS::CloudTrail::Trail   ,   AWS::SNS::Topic",None (custom Security Hub rule),Periodic,None," You can do real-time monitoring of API calls by directing CloudTrail logs to CloudWatch Logs and establishing corresponding metric filters and alarms. You can have more than one VPC in an account, and you can create a peer connection between two VPCs, enabling network traffic to route between VPCs. CIS recommends that you create a metric filter and alarm for changes to VPCs. Monitoring these changes helps ensure that authentication and authorization controls remain intact. To run this check, Security Hub uses custom logic to perform the exact audit steps prescribed for control 4.14 in the   CIS AWS Foundations Benchmark v1.4.0   . This control fails if the exact metric filters prescribed by CIS are not used. Additional fields or terms cannot be added to the metric filters."
CloudWatch.15,CloudWatch alarms should have specified actions configured,"NIST.800-53.r5 AU-6(1), NIST.800-53.r5 AU-6(5), NIST.800-53.r5 CA-7, NIST.800-53.r5 IR-4(1), NIST.800-53.r5 IR-4(5), NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-20, NIST.800-53.r5 SI-4(12), NIST.800-53.r5 SI-4(5)",Detect > Detection services,High,AWS::CloudWatch::Alarm,cloudwatch-alarm-action-check,Change triggered,," This control checks whether an Amazon CloudWatch alarm has at least one action configured for the   ALARM   state. The control fails if the alarm doesn't have an action configured for the   ALARM   state. Optionally, you can include custom parameter values to also require alarm actions for the   INSUFFICIENT_DATA   or   OK   states. We recommend CloudWatch alarm actions to automatically alert you when a monitored metric is outside the defined threshold. Monitoring alarms help you identify unusual activities and quickly respond to security and operational issues when an alarm goes into a specific state. The most common type of alarm action is to notify one or more users by sending a message to an Amazon Simple Notification Service (Amazon SNS) topic."
CloudWatch.16,CloudWatch log groups should be retained for a specified time period,"NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-11, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-12",Identify > Logging,Medium,AWS::Logs::LogGroup,cw-loggroup-retention-period-check,Periodic,," This control checks whether an Amazon CloudWatch log group has a retention period of at least the specified number of days. The control fails if the retention period is less than the specified number. Unless you provide a custom parameter value for the retention period, Security Hub uses a default value of 365 days. CloudWatch Logs centralize logs from all of your systems, applications, and AWS services in a single, highly scalable service. You can use CloudWatch Logs to monitor, store, and access your log files from Amazon Elastic Compute Cloud (EC2) instances, AWS CloudTrail, Amazon RouteÂ 53, and other sources. Retaining your logs for at least 1 year can help you comply with log retention standards."
CloudWatch.17,CloudWatch alarm actions should be activated,"NIST.800-53.r5 AU-6(1), NIST.800-53.r5 AU-6(5), NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-4(12)",Detect > Detection services,High,AWS::CloudWatch::Alarm,cloudwatch-alarm-action-enabled-check,Change triggered,None," This control checks if CloudWatch alarm actions are activated (   ActionEnabled   should be set to true). The control fails if the alarm action for a CloudWatch alarm is deactivated. Whereas this control focuses on the activation status of a CloudWatch alarm action,   CloudWatch.15   focuses on whether any   ALARM   action is configured in a CloudWatch alarm. Alarm actions automatically alert you when a monitored metric is outside the defined threshold. If the alarm action is deactivated, no actions are run when the alarm changes state, and you won't be alerted to changes in monitored metrics. We recommend activating CloudWatch alarm actions to help you quickly respond to security and operational issues."
CodeBuild.1,CodeBuild GitHub or Bitbucket source repository URLs should use OAuth,"PCI DSS v3.2.1/8.2.1, NIST.800-53.r5 SA-3",Protect > Secure development,Critical,AWS::CodeBuild::Project,codebuild-project-source-repo-url-check,Change triggered,None," This control checks whether the GitHub or Bitbucket source repository URL contains either personal access tokens or a user name and password. Sign-in credentials should never be stored or transmitted in clear text or appear in the repository URL. Instead of personal access tokens or sign-in credentials, you should use OAuth to grant authorization for accessing GitHub or Bitbucket repositories. Using personal access tokens or sign-in credentials could expose your credentials to unintended data exposure and unauthorized access."
CodeBuild.2,CodeBuild project environment variables should not contain clear text credentials,"PCI DSS v3.2.1/8.2.1, NIST.800-53.r5 IA-5(7), NIST.800-53.r5 SA-3",Protect > Secure development,Critical,AWS::CodeBuild::Project,codebuild-project-envvar-awscred-check,Change triggered,None," This control checks whether the project contains the environment variables   AWS_ACCESS_KEY_ID   and   AWS_SECRET_ACCESS_KEY   . Authentication credentials   AWS_ACCESS_KEY_ID   and   AWS_SECRET_ACCESS_KEY   should never be stored in clear text, as this could lead to unintended data exposure and unauthorized access."
CodeBuild.3,CodeBuild S3 logs should be encrypted,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data-at-rest,Low,AWS::CodeBuild::Project,codebuild-project-s3-logs-encrypted,Change triggered,None, This control checks if Amazon S3 logs for an AWS CodeBuild project are encrypted. The control fails if encryption is deactivated for S3 logs for a CodeBuild project. Encryption of data at rest is a recommended best practice to add a layer of access management around your data. Encrypting the logs at rest reduces the risk that a user not authenticated by AWS will access the data stored on disk. It adds another set of access controls to limit the ability of unauthorized users to access the data.
CodeBuild.4,CodeBuild project environments should have a logging AWS Configuration,"NIST.800-53.r5 AC-2(12), NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 AU-9(7), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4, NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::CodeBuild::Project,codebuild-project-logging-enabled,Change triggered,None," This control checks whether a CodeBuild project environment has at least one log option, either to S3 or CloudWatch logs enabled. This control fails if a CodeBuild project environment does not have at least one log option enabled. From a security perspective, logging is an important feature to enable for future forensics efforts in the case of any security incidents. Correlating anomalies in CodeBuild projects with threat detections can increase confidence in the accuracy of those threat detections."
CodeBuild.5,CodeBuild project environments should not have privileged mode enabled,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-5, NIST.800-53.r5 AC-6, NIST.800-53.r5 AC-6(10), NIST.800-53.r5 AC-6(2)",Protect > Secure Access Management,High,AWS::CodeBuild::Project,codebuild-project-environment-privileged-check,Change triggered,None," This control checks whether an AWS CodeBuild project environment has privileged mode enabled or disabled. The control fails if an CodeBuild project environment has privileged mode enabled. By default, Docker containers do not allow access to any devices. Privileged mode grants a build project's Docker container access to all devices. Setting   privilegedMode   with value   true   permits the Docker daemon to run inside a Docker container. The Docker daemon listens for Docker API requests and manages Docker objects such as images, containers, networks, and volumes. This parameter should only be set to true if the build project is used to build Docker images. Otherwise, this setting should be disabled to prevent unintended access to Docker APIs as well as the container's underlying hardware. Setting   privilegedMode   to   false   helps protect critical resources from tampering and deletion."
Config.1,AWS Config should be enabled,"PCI DSS v3.2.1/10.5.2,PCI DSS v3.2.1/11.5, CIS AWS Foundations Benchmark v1.2.0/2.5, CIS AWS Foundations Benchmark v1.4.0/3.5, NIST.800-53.r5 CM-3, NIST.800-53.r5 CM-6(1), NIST.800-53.r5 CM-8, NIST.800-53.r5 CM-8(2)",Identify > Inventory,Medium,AWS::::Account,None (custom Security Hub rule),Periodic,None," This control checks whether AWS Config is enabled in your account in the current Region and is recording all resources. The control fails if AWS Config isn't enabled or isn't recording all resources. The AWS Config service performs configuration management of supported AWS resources in your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items, and any configuration changes between resources. Security Hub recommends that you enable AWS Config in all Regions. The AWS configuration item history that AWS Config captures enables security analysis, resource change tracking, and compliance auditing."
DMS.1,Database Migration Service replication instances should not be public,"PCI DSS v3.2.1/1.2.1,PCI DSS v3.2.1/1.3.1,PCI DSS v3.2.1/1.3.4,PCI DSS v3.2.1/1.3.2,PCI DSS v3.2.1/1.3.6, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,Critical,AWS::DMS::ReplicationInstance,dms-replication-not-public,Periodic,None," This control checks whether AWS DMS replication instances are public. To do this, it examines the value of the   PubliclyAccessible   field. A private replication instance has a private IP address that you cannot access outside of the replication network. A replication instance should have a private IP address when the source and target databases are in the same network. The network must also be connected to the replication instance's VPC using a VPN, AWS Direct Connect, or VPC peering. To learn more about public and private replication instances, see   Public and private replication instances   in the   AWS Database Migration Service User Guide   . You should also ensure that access to your AWS DMS instance configuration is limited to only authorized users. To do this, restrict users' IAM permissions to modify AWS DMS settings and resources."
DMS.6,DMS replication instances should have automatic minor version upgrade enabled,"NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-2(2), NIST.800-53.r5 SI-2(4), NIST.800-53.r5 SI-2(5)","Detect > Vulnerability, patch, and version management",Medium,AWS::DMS::ReplicationInstance,dms-auto-minor-version-upgrade-enabled,Change triggered,None," This control checks if automatic minor version upgrade is enabled for an AWS DMS replication instance. The control fails if automatic minor version upgrade isn't enabled for a DMS replication instance. DMS provides automatic minor version upgrade to each supported replication engine so that you can keep your replication instance up-to-date. Minor versions can introduce new software features, bug fixes, security patches, and performance improvements. By enabling automatic minor version upgrade on DMS replication instances, minor upgrades are applied automatically during the maintenance window or immediately if the   Apply changes immediately option is chosen   ."
DMS.7,DMS replication tasks for the target database should have logging enabled,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::DMS::ReplicationTask,dms-replication-task-targetdb-logging,Change triggered,None, This control checks whether logging is enabled with the minimum severity level of   LOGGER_SEVERITY_DEFAULT   for DMS replication tasks   TARGET_APPLY   and   TARGET_LOAD   . The control fails if logging isn't enabled for these tasks or if the minimum severity level is less than   LOGGER_SEVERITY_DEFAULT   .
DMS.8,DMS replication tasks for the source database should have logging enabled,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::DMS::ReplicationTask,dms-replication-task-sourcedb-logging,Change triggered,None, This control checks whether logging is enabled with the minimum severity level of   LOGGER_SEVERITY_DEFAULT   for DMS replication tasks   SOURCE_CAPTURE   and   SOURCE_UNLOAD   . The control fails if logging isn't enabled for these tasks or if the minimum severity level is less than   LOGGER_SEVERITY_DEFAULT   .
DMS.9,DMS endpoints should use SSL,"NIST.800-53.r5 AC-4, NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2)",Protect > Encryption of data-in-transit,Medium,AWS::DMS::Endpoint,dms-endpoint-ssl-configured,Change triggered,None," This control checks whether an AWS DMS endpoint uses an SSL connection. The control fails if the endpoint doesn't use SSL. SSL/TLS connections provide a layer of security by encrypting connections between DMS replication instances and your database. Using certificates provides an extra layer of security by validating that the connection is being made to the expected database. It does so by checking the server certificate that is automatically installed on all database instances that you provision. By enabling SSL connection on your DMS endpoints, you protect the confidentiality of the data during the migration."
DocumentDB.1,Amazon DocumentDB clusters should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::RDS::DBCluster,docdb-cluster-encrypted,Change triggered,None," This control checks whether an Amazon DocumentDB cluster is encrypted at rest. The control fails if an Amazon DocumentDB cluster isn't encrypted at rest. Data at rest refers to any data that's stored in persistent, non-volatile storage for any duration. Encryption helps you protect the confidentiality of such data, reducing the risk that an unauthorized user gets access to it. Data in Amazon DocumentDB clusters should be encrypted at rest for an added layer of security. Amazon DocumentDB uses the 256-bit Advanced Encryption Standard (AES-256) to encrypt your data using encryption keys stored in AWS Key Management Service (AWS KMS)."
DocumentDB.2,Amazon DocumentDB clusters should have an adequate backup retention period,NIST.800-53.r5 SI-12,Recover > Resilience > Backups enabled,Medium,AWS::RDS::DBCluster,docdb-cluster-backup-retention-check,Change triggered,," This control checks whether an Amazon DocumentDB cluster has a backup retention period greater than or equal to the specified time frame. The control fails if the backup retention period is less than the specified time frame. Unless you provide a custom parameter value for the backup retention period, Security Hub uses a default value of 7 days. Backups help you recover more quickly from a security incident and strengthen the resilience of your systems. By automating backups for your Amazon DocumentDB clusters, you'll be able to restore your systems to a point in time and minimize downtime and data loss. In Amazon DocumentDB, clusters have a default backup retention period of 1 day. This must be increased to a value between 7 and 35 days to pass this control."
DocumentDB.3,Amazon DocumentDB manual cluster snapshots should not be public,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,Critical,"AWS::RDS::DBClusterSnapshot   ,   AWS::RDS:DBSnapshot",docdb-cluster-snapshot-public-prohibited,Change triggered,None," This control checks whether an Amazon DocumentDB manual cluster snapshot is public. The control fails if the manual cluster snapshot is public. An Amazon DocumentDB manual cluster snapshot should not be public unless intended. If you share an unencrypted manual snapshot as public, the snapshot is available to all AWS accounts. Public snapshots may result in unintended data exposure."
DocumentDB.4,Amazon DocumentDB clusters should publish audit logs to CloudWatch Logs,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::RDS::DBCluster,docdb-cluster-audit-logging-enabled,Change triggered,None," This control checks whether an Amazon DocumentDB cluster publishes audit logs to Amazon CloudWatch Logs. The control fails if the cluster doesn't publish audit logs to CloudWatch Logs. Amazon DocumentDB (with MongoDB compatibility) allows you to audit events that were performed in your cluster. Examples of logged events include successful and failed authentication attempts, dropping a collection in a database, or creating an index. By default, auditing is disabled in Amazon DocumentDB and requires that you take action to enable it."
DocumentDB.5,Amazon DocumentDB clusters should have deletion protection enabled,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2), NIST.800-53.r5 CM-3, NIST.800-53.r5 SC-5(2)",Protect > Data protection > Data deletion protection,Medium,AWS::RDS::DBCluster,docdb-cluster-deletion-protection-enabled,Change triggered,None, This control checks whether an Amazon DocumentDB cluster has deletion protection enabled. The control fails if the cluster doesn't have deletion protection enabled. Enabling cluster deletion protection offers an additional layer of protection against accidental database deletion or deletion by an unauthorized user. An Amazon DocumentDB cluster can't be deleted while deletion protection is enabled. You must first disable deletion protection before a delete request can succeed. Deletion protection is enabled by default when you create a cluster in the Amazon DocumentDB console.
DynamoDB.1,DynamoDB tables should automatically scale capacity with demand,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-2(2), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Medium,AWS::DynamoDB::Table,dynamodb-autoscaling-enabled,Periodic,," This control checks whether an Amazon DynamoDB table can scale its read and write capacity as needed. The control fails if the table doesn't use on-demand capacity mode or provisioned mode with auto scaling configured. By default, this control only requires that one of these modes be configured, without regard to specific levels of read or write capacity. Optionally, you can provide custom parameter values to require specific levels of read and write capacity or target utilization. Scaling capacity with demand avoids throttling exceptions, which helps to maintain availability of your applications. DynamoDB tables in on-demand capacity mode are only limited by the DynamoDB throughput default table quotas. To raise these quotas, you can file a support ticket with AWS Support.DynamoDB tables in provisioned mode with auto scaling adjust the provisioned throughput capacity dynamically in response to traffic patterns. For more information about DynamoDB request throttling, see   Request throttling and burst capacity   in the   Amazon DynamoDB Developer Guide   ."
DynamoDB.2,DynamoDB tables should have point-in-time recovery enabled,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-12, NIST.800-53.r5 SI-13(5)",Recover > Resilience > Backups enabled,Medium,AWS::DynamoDB::Table,dynamodb-pitr-enabled,Change triggered,None, This control checks whether point-in-time recovery (PITR) is enabled for an Amazon DynamoDB table. Backups help you to recover more quickly from a security incident. They also strengthen the resilience of your systems. DynamoDB point-in-time recovery automates backups for DynamoDB tables. It reduces the time to recover from accidental delete or write operations. DynamoDB tables that have PITR enabled can be restored to any point in time in the last 35 days.
DynamoDB.3,DynamoDB Accelerator (DAX) clusters should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::DynamoDB::Cluster,dax-encryption-enabled,Periodic,None," This control checks whether a DAX cluster is encrypted at rest. Encrypting data at rest reduces the risk of data stored on disk being accessed by a user not authenticated to AWS. The encryption adds another set of access controls to limit the ability of unauthorized users to access to the data. For example, API permissions are required to decrypt the data before it can be read."
DynamoDB.4,DynamoDB tables should be present in a backup plan,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6, NIST.800-53.r5 CP-6(1), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-12, NIST.800-53.r5 SI-13(5)",Recover > Resilience > Backups enabled,Medium,AWS::DynamoDB::Table,dynamodb-resources-protected-by-backup-plan,Periodic,," This control evaluates whether an Amazon DynamoDB table in   ACTIVE   state is covered by a backup plan. The control fails if the DynamoDB table isn't covered by a backup plan. If you set the   backupVaultLockCheck   parameter equal to   true   , the control passes only if the DynamoDB table is backed up in an AWS Backup locked vault. AWS Backup is a fully managed backup service that helps you centralize and automate the backing up of data across AWS services. With AWS Backup, you can create backup plans that define your backup requirements, such as how frequently to back up your data and how long to retain those backups. Including DynamoDB tables in your backup plans helps you protect your data from unintended loss or deletion."
DynamoDB.6,DynamoDB tables should have deletion protection enabled,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2), NIST.800-53.r5 CM-3, NIST.800-53.r5 SC-5(2)",Protect > Data protection > Data deletion protection,Medium,AWS::DynamoDB::Table,dynamodb-table-deletion-protection-enabled,Change triggered,None, This control checks whether an Amazon DynamoDB table has deletion protection enabled. The control fails if a DynamoDB table doesn't have deletion protection enabled. You can protect a DynamoDB table from accidental deletion with the deletion protection property. Enabling this property for tables helps ensure that tables don't get accidentally deleted during regular table management operations by your administrators. This helps prevent disruption to your normal business operations.
EC2.1,Amazon EBS snapshots should not be publicly restorable,"PCI DSS v3.2.1/1.2.1,PCI DSS v3.2.1/1.3.1,PCI DSS v3.2.1/1.3.4,PCI DSS v3.2.1/7.2.1, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,Critical,AWS::::Account,ebs-snapshot-public-restorable-check,Periodic,None," This control checks whether Amazon Elastic Block Store snapshots are not public. The control fails if Amazon EBS snapshots are restorable by anyone. EBS snapshots are used to back up the data on your EBS volumes to Amazon S3 at a specific point in time. You can use the snapshots to restore previous states of EBS volumes. It is rarely acceptable to share a snapshot with the public. Typically the decision to share a snapshot publicly was made in error or without a complete understanding of the implications. This check helps ensure that all such sharing was fully planned and intentional. To make a public EBS snapshot private, see   Share a snapshot   in the   Amazon EC2 User Guide for Linux Instances   . For   Actions, Modify permissions   , choose   Private   ."
EC2.2,VPC default security groups should not allow inbound or outbound traffic,"PCI DSS v3.2.1/1.2.1,PCI DSS v3.2.1/1.3.4,PCI DSS v3.2.1/2.1, CIS AWS Foundations Benchmark v1.2.0/4.3, CIS AWS Foundations Benchmark v1.4.0/5.3, NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(5)",Protect > Secure network configuration,High,AWS::EC2::SecurityGroup,vpc-default-security-group-closed,Change triggered,None," This control checks whether the default security group of a VPC allows inbound or outbound traffic. The control fails if the security group allows inbound or outbound traffic. The rules for the   default security group   allow all outbound and inbound traffic from network interfaces (and their associated instances) that are assigned to the same security group. We recommend that you don't use the default security group. Because the default security group cannot be deleted, you should change the default security group rules setting to restrict inbound and outbound traffic. This prevents unintended traffic if the default security group is accidentally configured for resources such as EC2 instances."
EC2.3,Attached Amazon EBS volumes should be encrypted at-rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::EC2::Volume,encrypted-volumes,Change triggered,None," This control checks whether the EBS volumes that are in an attached state are encrypted. To pass this check, EBS volumes must be in use and encrypted. If the EBS volume is not attached, then it is not subject to this check. For an added layer of security of your sensitive data in EBS volumes, you should enable EBS encryption at rest. Amazon EBS encryption offers a straightforward encryption solution for your EBS resources that doesn't require you to build, maintain, and secure your own key management infrastructure. It uses KMS keys when creating encrypted volumes and snapshots. To learn more about Amazon EBS encryption, see   Amazon EBS encryption   in the   Amazon EC2 User Guide for Linux Instances   ."
EC2.4,Stopped EC2 instances should be removed after a specified time period,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Identify > Inventory,Medium,AWS::EC2::Instance,ec2-stopped-instance,Periodic,," This control checks whether an Amazon EC2 instance has been stopped for longer than the allowed number of days. The control fails if an EC2 instance is stopped for longer than the maximum allowed time period. Unless you provide a custom parameter value for the maximum allowed time period, Security Hub uses a default value of 30 days. When an EC2 instance has not run for a significant period of time, it creates a security risk because the instance is not being actively maintained (analyzed, patched, updated). If it is later launched, the lack of proper maintenance could result in unexpected issues in your AWS environment. To safely maintain an EC2 instance over time in an inactive state, start it periodically for maintenance and then stop it after maintenance. Ideally, this should be an automated process."
EC2.6,VPC flow logging should be enabled in all VPCs,"CIS AWS Foundations Benchmark v1.2.0/2.9, PCI DSS v3.2.1/10.3.3,PCI DSS v3.2.1/10.3.4,PCI DSS v3.2.1/10.3.5,PCI DSS v3.2.1/10.3.6, CIS AWS Foundations Benchmark v1.4.0/3.9, NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::EC2::VPC,vpc-flow-logs-enabled,Periodic,," This control checks whether Amazon VPC Flow Logs are found and enabled for VPCs. The traffic type is set to   Reject   . With the VPC Flow Logs feature, you can capture information about the IP address traffic going to and from network interfaces in your VPC. After you create a flow log, you can view and retrieve its data in CloudWatch Logs. To reduce cost, you can also send your flow logs to Amazon S3. Security Hub recommends that you enable flow logging for packet rejects for VPCs. Flow logs provide visibility into network traffic that traverses the VPC and can detect anomalous traffic or provide insight during security workflows. By default, the record includes values for the different components of the IP address flow, including the source, destination, and protocol. For more information and descriptions of the log fields, see   VPC Flow Logs   in the   Amazon VPC User Guide   ."
EC2.7,EBS default encryption should be enabled,"CIS AWS Foundations Benchmark v1.4.0/2.2.1, NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::::Account,ec2-ebs-encryption-by-default,Periodic,None," This control checks whether account-level encryption is enabled by default for Amazon Elastic Block Store(Amazon EBS). The control fails if the account level encryption is not enabled. When encryption is enabled for your account, Amazon EBS volumes and snapshot copies are encrypted at rest. This adds an additional layer of protection for your data. For more information, see   Encryption by default   in the   Amazon EC2 User Guide for Linux Instances   ."
EC2.8,EC2 instances should use Instance Metadata Service Version 2 (IMDSv2),"NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6",Protect > Network security,High,AWS::EC2::Instance,ec2-imdsv2-check,Change triggered,None," This control checks whether your EC2 instance metadata version is configured with Instance Metadata Service Version 2 (IMDSv2). The control passes if   HttpTokens   is set to required for IMDSv2. The control fails if   HttpTokens   is set to   optional   . You use instance metadata to configure or manage the running instance. The IMDS provides access to temporary, frequently rotated credentials. These credentials remove the need to hard code or distribute sensitive credentials to instances manually or programmatically. The IMDS is attached locally to every EC2 instance. It runs on a special ""link local"" IP address of 169.254.169.254. This IP address is only accessible by software that runs on the instance. Version 2 of the IMDS adds new protections for the following types of vulnerabilities. These vulnerabilities could be used to try to access the IMDS. Security Hub recommends that you configure your EC2 instances with IMDSv2."
EC2.9,Amazon EC2 instances should not have a public IPv4 address,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > Public IP addresses,High,AWS::EC2::Instance,ec2-instance-no-public-ip,Change triggered,None," This control checks whether EC2 instances have a public IP address. The control fails if the   publicIp   field is present in the EC2 instance configuration item. This control applies to IPv4 addresses only. A public IPv4 address is an IP address that is reachable from the internet. If you launch your instance with a public IP address, then your EC2 instance is reachable from the internet. A private IPv4 address is an IP address that is not reachable from the internet. You can use private IPv4 addresses for communication between EC2 instances in the same VPC or in your connected private network. IPv6 addresses are globally unique, and therefore are reachable from the internet. However, by default all subnets have the IPv6 addressing attribute set to false. For more information about IPv6, see   IP addressing in your VPC   in the   Amazon VPC User Guide   . If you have a legitimate use case to maintain EC2 instances with public IP addresses, then you can suppress the findings from this control. For more information about front-end architecture options, see the   AWS Architecture Blog   or the   This Is My Architecture series   ."
EC2.10,Amazon EC2 should be configured to use VPC endpoints that are created for the Amazon EC2 service,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4)",Protect > Secure network configuration > API private access,Medium,AWS::EC2::VPC,service-vpc-endpoint-enabled,Periodic,," This control checks whether a service endpoint for Amazon EC2 is created for each VPC. The control fails if a VPC does not have a VPC endpoint created for the Amazon EC2 service. This control evaluates resources in single account. It cannot describe resources that are outside of the account. Because AWS Config and Security Hub do not conduct cross-account checks, you will see   FAILED   findings for VPCs that are shared across accounts. Security Hub recommends that you suppress these   FAILED   findings. To improve the security posture of your VPC, you can configure Amazon EC2 to use an interface VPC endpoint. Interface endpoints are powered by AWS PrivateLink, a technology that enables you to access Amazon EC2 API operations privately. It restricts all network traffic between your VPC and Amazon EC2 to the Amazon network. Because endpoints are supported within the same Region only, you cannot create an endpoint between a VPC and a service in a different Region. This prevents unintended Amazon EC2 API calls to other Regions. To learn more about creating VPC endpoints for Amazon EC2, see   Amazon EC2 and interface VPC endpoints   in the   Amazon EC2 User Guide for Linux Instances   ."
EC2.12,Unused Amazon EC2 EIPs should be removed,"PCI DSS v3.2.1/2.4, NIST.800-53.r5 CM-8(1)",Protect > Secure network configuration,Low,AWS::EC2::EIP,eip-attached,Change triggered,None," This control checks whether Elastic IP (EIP) addresses that are allocated to a VPC are attached to EC2 instances or in-use elastic network interfaces (ENIs). A failed finding indicates you may have unused EC2 EIPs. This will help you maintain an accurate asset inventory of EIPs in your cardholder data environment (CDE). To release an unused EIP, see   Release an Elastic IP address   in the   Amazon EC2 User Guide for Linux Instances   ."
EC2.13,Security groups should not allow ingress from 0.0.0.0/0 or ::/0 to port 22,"CIS AWS Foundations Benchmark v1.2.0/4.1, PCI DSS v3.2.1/1.2.1,PCI DSS v3.2.1/1.3.1,PCI DSS v3.2.1/2.2.2, NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 CM-7, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(5)",Protect > Secure network configuration,High,AWS::EC2::SecurityGroup,restricted-ssh,Change triggered,None," Security groups provide stateful filtering of ingress and egress network traffic to AWS resources. We recommend that no security group allow unrestricted ingress access to port 22. Removing unfettered connectivity to remote console services, such as SSH, reduces a server's exposure to risk."
EC2.14,Security groups should not allow ingress from 0.0.0.0/0 or ::/0 to port 3389,CIS AWS Foundations Benchmark v1.2.0/4.2,Protect > Secure network configuration,High,AWS::EC2::SecurityGroup,restricted-common-ports   (created rule is   restricted-rdp   ),Change triggered,None," Security groups provide stateful filtering of ingress and egress network traffic to AWS resources. We recommend that no security group allow unrestricted ingress access to port 3389. Removing unfettered connectivity to remote console services, such as RDP, reduces a server's exposure to risk."
EC2.15,Amazon EC2 subnets should not automatically assign public IP addresses,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Network security,Medium,AWS::EC2::Subnet,subnet-auto-assign-public-ip-disabled,Change triggered,None, This control checks whether the assignment of public IPs in Amazon Virtual Private Cloud (Amazon VPC) subnets have   MapPublicIpOnLaunch   set to   FALSE   . The control passes if the flag is set to   FALSE   . All subnets have an attribute that determines whether a network interface created in the subnet automatically receives a public IPv4 address. Instances that are launched into subnets that have this attribute enabled have a public IP address assigned to their primary network interface.
EC2.16,Unused Network Access Control Lists should be removed,NIST.800-53.r5 CM-8(1),Prevent > Network security,Low,AWS::EC2::NetworkAcl,vpc-network-acl-unused-check,Change triggered,None," This control checks whether there are any unused network access control lists (ACLs). If the only relationship is the VPC of the network ACL, then the control fails. If other relationships are listed, then the control passes."
EC2.17,Amazon EC2 instances should not use multiple ENIs,NIST.800-53.r5 AC-4(21),Network security,Low,AWS::EC2::Instance,ec2-instance-multiple-eni-check,Change triggered,," This control checks whether an EC2 instance uses multiple Elastic Network Interfaces (ENIs) or Elastic Fabric Adapters (EFAs). This control passes if a single network adapter is used. The control includes an optional parameter list to identify the allowed ENIs. This control also fails if an EC2 instance that belongs to an Amazon EKS cluster uses more than one ENI. If your EC2 instances need to have multiple ENIs as part of an Amazon EKS cluster, you can suppress those control findings. Multiple ENIs can cause dual-homed instances, meaning instances that have multiple subnets. This can add network security complexity and introduce unintended network paths and access."
EC2.18,Security groups should only allow unrestricted incoming traffic for authorized ports,"NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(5)",Protect > Secure network configuration > Security group configuration,High,AWS::EC2::SecurityGroup,vpc-sg-open-only-to-authorized-ports,Change triggered,," Security groups provide stateful filtering of ingress and egress network traffic to AWS. Security group rules should follow the principal of least privileged access. Unrestricted access (IP address with a /0 suffix) increases the opportunity for malicious activity such as hacking, denial-of-service attacks, and loss of data. Unless a port is specifically allowed, the port should deny unrestricted access."
EC2.19,Security groups should not allow unrestricted access to ports with high risk,"NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2), NIST.800-53.r5 CM-7, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(5)",Protect > Restricted network access,Critical,AWS::EC2::SecurityGroup,vpc-sg-restricted-common-ports   (custom Security Hub rule),Change triggered,"""blockedPorts"": ""20,21,22,23,25,110,135,143,445,1433,1434,3000,3306,3389,4333,5000,5432,5500,5601,8080,8088,8888,9200,9300""   (not customizable)",
EC2.20,Both VPN tunnels for an AWS Site-to-Site VPN connection should be up,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Resilience > Recover > High availability,Medium,AWS::EC2::VPNConnection,vpc-vpn-2-tunnels-up,Change triggered,None, A VPN tunnel is an encrypted link where data can pass from the customer network to or from AWS within an AWS Site-to-Site VPN connection. Each VPN connection includes two VPN tunnels which you can simultaneously use for high availability. Ensuring that both VPN tunnels are up for a VPN connection is important for confirming a secure and highly available connection between an AWS VPC and your remote network. This control checks that both VPN tunnels provided by AWS Site-to-Site VPN are in UP status. The control fails if one or both tunnels are in DOWN status.
EC2.21,Network ACLs should not allow ingress from 0.0.0.0/0 to port 22 or port 3389,"CIS AWS Foundations Benchmark v1.4.0/5.1, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2), NIST.800-53.r5 CM-7, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(5)",Protect > Secure Network Configuration,Medium,AWS::EC2::NetworkAcl,nacl-no-unrestricted-ssh-rdp,Change triggered,None," Access to remote server administration ports, such as port 22 (SSH) and port 3389 (RDP), should not be publicly accessible, as this may allow unintended access to resources within your VPC."
EC2.22,Unused Amazon EC2 security groups should be removed,,Identify > Inventory,Medium,"AWS::EC2::NetworkInterface   ,   AWS::EC2::SecurityGroup",ec2-security-group-attached-to-eni-periodic,Periodic,None, This AWS control checks that security groups are attached to Amazon Elastic Compute Cloud (Amazon EC2) instances or to an elastic network interface. The control will fail if the security group is not associated with an Amazon EC2 instance or an elastic network interface.
EC2.23,Amazon EC2 Transit Gateways should not automatically accept VPC attachment requests,"NIST.800-53.r5 AC-4(21), NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure network configuration,High,AWS::EC2::TransitGateway,ec2-transit-gateway-auto-vpc-attach-disabled,Change triggered,None," This control checks if EC2 transit gateways are automatically accepting shared VPC attachments. This control fails for a transit gateway that automatically accepts shared VPC attachment requests. Turning on   AutoAcceptSharedAttachments   configures a transit gateway to automatically accept any cross-account VPC attachment requests without verifying the request or the account the attachment is originating from. To follow the best practices of authorization and authentication, we recommended turning off this feature to ensure that only authorized VPC attachment requests are accepted."
EC2.24,Amazon EC2 paravirtual instance types should not be used,"NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)","Identify > Vulnerability, patch, and version management",Medium,AWS::EC2::Instance,ec2-paravirtual-instance-check,Change triggered,None," This control checks whether the virtualization type of an EC2 instance is paravirtual. The control fails if the   virtualizationType   of the EC2 instance is set to   paravirtual   . Historically, PV guests had better performance than HVM guests in many cases, but because of enhancements in HVM virtualization and the availability of PV drivers for HVM AMIs, this is no longer true. For more information, see   Linux AMI virtualization types   in the Amazon EC2 User Guide for Linux Instances."
EC2.25,Amazon EC2 launch templates should not assign public IPs to network interfaces,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > Resources not publicly accessible,High,AWS::EC2::LaunchTemplate,ec2-launch-template-public-ip-disabled,Change triggered,None," This control checks if Amazon EC2 launch templates are configured to assign public IP addresses to network interfaces upon launch. The control fails if an EC2 launch template is configured to assign a public IP address to network interfaces or if there is at least one network interface that has a public IP address. A public IP address is one that is reachable from the internet. If you configure your network interfaces with a public IP address, then the resources associated with those network interfaces may be reachable from the internet. EC2 resources shouldn't be publicly accessible because this may permit unintended access to your workloads."
EC2.28,EBS volumes should be covered by a backup plan,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6, NIST.800-53.r5 CP-6(1), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-12, NIST.800-53.r5 SI-13(5)",Recover > Resilience > Backups enabled,Low,AWS::EC2::Volume,ebs-resources-protected-by-backup-plan,Periodic,," This control evaluates if an Amazon EBS volume in   in-use   state is covered by a backup plan. The control fails if an EBS volume isn't covered by a backup plan. If you set the   backupVaultLockCheck   parameter equal to   true   , the control passes only if the EBS volume is backed up in an AWS Backup locked vault. Backups help you recover more quickly from a security incident. They also strengthen the resilience of your systems. Including Amazon EBS volumes in a backup plan helps you protect your data from unintended loss or deletion."
EC2.51,EC2 Client VPN endpoints should have client connection logging enabled,"NIST.800-53.r5 AC-2(12), NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 AU-9(7), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4, NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Low,AWS::EC2::ClientVpnEndpoint,ec2-client-vpn-connection-log-enabled,Change triggered,None," This control checks whether an AWS Client VPN endpoint has client connection logging enabled. The control fails if the endpoint doesn't have client connection logging enabled. Client VPN endpoints allow remote clients to securely connect to resources in a Virtual Private Cloud (VPC) in AWS. Connection logs allow you to track user activity on the VPN endpoint and provides visibility. When you enable connection logging, you can specify the name of a log stream in the log group. If you don't specify a log stream, the Client VPN service creates one for you."
ECR.1,ECR private repositories should have image scanning configured,NIST.800-53.r5 RA-5,"Identify > Vulnerability, patch, and version management",High,AWS::ECR::Repository,ecr-private-image-scanning-enabled,Periodic,None, This control checks whether a private Amazon ECR repository has image scanning configured. The control fails if the private ECR repository isn't configured for scan on push or continuous scanning. ECR image scanning helps in identifying software vulnerabilities in your container images. ECR uses the Common Vulnerabilities and Exposures (CVEs) database from the   open-source Clair project   and provides a list of scan findings. Configuring image scanning on ECR repositories adds a layer of verification for the integrity and safety of the images being stored.
ECR.2,ECR private repositories should have tag immutability configured,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-8(1)",Identify > Inventory > Tagging,Medium,AWS::ECR::Repository,ecr-private-tag-immutability-enabled,Change triggered,None," This control checks whether a private ECR repository has tag immutability enabled. This control fails if a private ECR repository has tag immutability disabled. This rule passes if tag immutability is enabled and has the value   IMMUTABLE   . Amazon ECR Tag Immutability enables customers to rely on the descriptive tags of an image as a reliable mechanism to track and uniquely identify images. An immutable tag is static, which means each tag refers to a unique image. This improves reliability and scalability as the use of a static tag will always result in the same image being deployed. When configured, tag immutability prevents the tags from being overridden, which reduces the attack surface."
ECR.3,ECR repositories should have at least one lifecycle policy configured,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Identify > Resource configuration,Medium,AWS::ECR::Repository,ecr-private-lifecycle-policy-configured,Change triggered,None," This control checks whether an Amazon ECR repository has at least one lifecycle policy configured. This control fails if an ECR repository does not have any lifecycle policies configured. Amazon ECR lifecycle policies enable you to specify the lifecycle management of images in a repository. By configuring lifecycle policies, you can automate the cleanup of unused images and the expiration of images based on age or count. Automating these tasks can help you avoid unintentionally using outdated images in your repository."
ECS.1,Amazon ECS task definitions should have secure networking modes and user definitions.,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-5, NIST.800-53.r5 AC-6",Protect > Secure access management,High,AWS::ECS::TaskDefinition,ecs-task-definition-user-for-host-mode-check,Change triggered,," This control checks whether an active Amazon ECS task definition with host networking mode has   privileged   or   user   container definitions. The control fails for task definitions that have host network mode and container definitions of   privileged=false   , empty and   user=root   , or empty. This control only evaluates the latest active revision of an Amazon ECS task definition. The purpose of this control is to ensure that access is defined intentionally when you run tasks that use the host network mode. If a task definition has elevated privileges, it is because you have chosen that configuration. This control checks for unexpected privilege escalation when a task definition has host networking enabled, and you don't choose elevated privileges."
ECS.2,ECS services should not have public IP addresses assigned to them automatically,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > Resources not publicly accessible,High,AWS::ECS::Service,ecs-service-assign-public-ip-disabled   (custom Security Hub rule),Change triggered,," This control checks whether Amazon ECS services are configured to automatically assign public IP addresses. This control fails if   AssignPublicIP   is   ENABLED   . This control passes if   AssignPublicIP   is   DISABLED   . A public IP address is an IP address that is reachable from the internet. If you launch your Amazon ECS instances with a public IP address, then your Amazon ECS instances are reachable from the internet. Amazon ECS services should not be publicly accessible, as this may allow unintended access to your container application servers."
ECS.3,ECS task definitions should not share the host's process namespace,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Identify > Resource configuration,High,AWS::ECS::TaskDefinition,ecs-task-definition-pid-mode-check,Change triggered,None," This control checks if Amazon ECS task definitions are configured to share a host's process namespace with its containers. The control fails if the task definition shares the host's process namespace with the containers running on it. This control only evaluates the latest active revision of an Amazon ECS task definition. A process ID (PID) namespace provides separation between processes. It prevents system processes from being visible, and allows PIDs to be reused, including PID 1. If the host's PID namespace is shared with containers, it would allow containers to see all of the processes on the host system. This reduces the benefit of process level isolation between the host and the containers. These circumstances could lead to unauthorized access to processes on the host itself, including the ability to manipulate and terminate them. Customers shouldn't share the host's process namespace with containers running on it."
ECS.4,ECS containers should run as non-privileged,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-5, NIST.800-53.r5 AC-6",Protect > Secure access management > Root user access restrictions,High,AWS::ECS::TaskDefinition,ecs-containers-nonprivileged,Change triggered,None," This control checks if the   privileged   parameter in the container definition of Amazon ECS Task Definitions is set to   true   . The control fails if this parameter is equal to   true   . This control only evaluates the latest active revision of an Amazon ECS task definition. We recommend that you remove elevated privileges from your ECS task definitions. When the privilege parameter is   true   , the container is given elevated privileges on the host container instance (similar to the root user)."
ECS.5,ECS containers should be limited to read-only access to root filesystems,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-5, NIST.800-53.r5 AC-6",Protect > Secure access management,High,AWS::ECS::TaskDefinition,ecs-containers-readonly-access,Change triggered,None, This control checks if Amazon ECS containers are limited to read-only access to mounted root filesystems. The control fails if the   readonlyRootFilesystem   parameter is set to   false   or if the parameter doesn't exist in the container definition within the task definition. This control only evaluates the latest active revision of an Amazon ECS task definition. Enabling this option reduces security attack vectors since the container instance's filesystem cannot be tampered with or written to unless it has explicit read-write permissions on its filesystem folder and directories. This control also adheres to the principle of least privilege.
ECS.8,Secrets should not be passed as container environment variables,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure development > Credentials not hard-coded,High,AWS::ECS::TaskDefinition,ecs-no-environment-secrets,Change triggered,," This control checks if the key value of any variables in the   environment   parameter of container definitions includes   AWS_ACCESS_KEY_ID   ,   AWS_SECRET_ACCESS_KEY   , or   ECS_ENGINE_AUTH_DATA   . This control fails if a single environment variable in any container definition equals   AWS_ACCESS_KEY_ID   ,   AWS_SECRET_ACCESS_KEY   , or   ECS_ENGINE_AUTH_DATA   . This control does not cover environmental variables passed in from other locations such as Amazon S3. This control only evaluates the latest active revision of an Amazon ECS task definition. AWS Systems Manager Parameter Store can help you improve the security posture of your organization. We recommend using the Parameter Store to store secrets and credentials instead of directly passing them into your container instances or hard coding them into your code."
ECS.9,ECS task definitions should have a logging configuration,"NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-7(8)",Identify > Logging,High,AWS::ECS::TaskDefinition,ecs-task-definition-log-configuration,Change triggered,None," This control checks if the latest active Amazon ECS task definition has a logging configuration specified. The control fails if the task definition doesn't have the   logConfiguration   property defined or if the value for   logDriver   is null in at least one container definition. Logging helps you maintain the reliability, availability, and performance of Amazon ECS. Collecting data from task definitions provides visibility, which can help you debug processes and find the root cause of errors. If you are using a logging solution that does not have to be defined in the ECS task definition (such as a third party logging solution), you can disable this control after ensuring that your logs are properly captured and delivered."
ECS.10,ECS Fargate services should run on the latest Fargate platform version,"NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-2(2), NIST.800-53.r5 SI-2(4), NIST.800-53.r5 SI-2(5)","Identify > Vulnerability, patch, and version management",Medium,AWS::ECS::Service,ecs-fargate-latest-platform-version,Change triggered,," This control checks if Amazon ECS Fargate services are running the latest Fargate platform version. This control fails if the platform version is not the latest. AWS Fargate platform versions refer to a specific runtime environment for Fargate task infrastructure, which is a combination of kernel and container runtime versions. New platform versions are released as the runtime environment evolves. For example, a new version may be released for kernel or operating system updates, new features, bug fixes, or security updates. Security updates and patches are deployed automatically for your Fargate tasks. If a security issue is found that affects a platform version, AWS patches the platform version."
ECS.12,ECS clusters should use Container Insights,"NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-2",Identify > Logging,Medium,AWS::ECS::Cluster,ecs-container-insights-enabled,Change triggered,None," This control checks if ECS clusters use Container Insights. This control fails if Container Insights are not set up for a cluster. Monitoring is an important part of maintaining the reliability, availability, and performance of Amazon ECS clusters. Use CloudWatch Container Insights to collect, aggregate, and summarize metrics and logs from your containerized applications and microservices. CloudWatch automatically collects metrics for many resources, such as CPU, memory, disk, and network. Container Insights also provides diagnostic information, such as container restart failures, to help you isolate issues and resolve them quickly. You can also set CloudWatch alarms on metrics that Container Insights collects."
EFS.1,Elastic File System should be configured to encrypt file data at-rest using AWS KMS,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::EFS::FileSystem,efs-encrypted-check,Periodic,None," This control checks whether Amazon Elastic File System is configured to encrypt the file data using AWS KMS. The check fails in the following cases. Note that this control does not use the   KmsKeyId   parameter for   efs-encrypted-check   . It only checks the value of   Encrypted   . For an added layer of security for your sensitive data in Amazon EFS, you should create encrypted file systems. Amazon EFS supports encryption for file systems at-rest. You can enable encryption of data at rest when you create an Amazon EFS file system. To learn more about Amazon EFS encryption, see   Data encryption in Amazon EFS   in the   Amazon Elastic File System User Guide   ."
EFS.2,Amazon EFS volumes should be in backup plans,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6, NIST.800-53.r5 CP-6(1), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-12, NIST.800-53.r5 SI-13(5)",Recover > Resilience > Backup,Medium,AWS::EFS::FileSystem,efs-in-backup-plan,Periodic,None, This control checks whether Amazon Elastic File System (Amazon EFS) file systems are added to the backup plans in AWS Backup. The control fails if Amazon EFS file systems are not included in the backup plans. Including EFS file systems in the backup plans helps you to protect your data from deletion and data loss.
EFS.3,EFS access points should enforce a root directory,NIST.800-53.r5 AC-6(10),Protect > Secure access management,Medium,AWS::EFS::AccessPoint,efs-access-point-enforce-root-directory,Change triggered,None," This control checks if Amazon EFS access points are configured to enforce a root directory. The control fails if the value of   Path   is set to   /   (the default root directory of the file system). When you enforce a root directory, the NFS client using the access point uses the root directory configured on the access point instead of the file system's root directory. Enforcing a root directory for an access point helps restrict data access by ensuring that users of the access point can only reach files of the specified subdirectory."
EFS.4,EFS access points should enforce a user identity,NIST.800-53.r5 AC-6(2),Protect > Secure access management,Medium,AWS::EFS::AccessPoint,efs-access-point-enforce-user-identity,Change triggered,None," This control checks whether Amazon EFS access points are configured to enforce a user identity. This control fails if a POSIX user identity is not defined while creating the EFS access point. Amazon EFS access points are application-specific entry points into an EFS file system that make it easier to manage application access to shared datasets. Access points can enforce a user identity, including the user's POSIX groups, for all file system requests that are made through the access point. Access points can also enforce a different root directory for the file system so that clients can only access data in the specified directory or its subdirectories."
EKS.1,EKS cluster endpoints should not be publicly accessible,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure access management > Resource not publicly accessible,High,AWS::EKS::Cluster,eks-endpoint-no-public-access,Periodic,None," This control checks whether an Amazon EKS cluster endpoint is publicly accessible. The control fails if an EKS cluster has an endpoint that is publicly accessible. When your create a new cluster, Amazon EKS creates an endpoint for the managed Kubernetes API server that you use to communicate with your cluster. By default, this API server endpoint is publicly available to the internet. Access to the API server is secured using a combination of AWS Identity and Access Management (IAM) and native Kubernetes Role Based Access Control (RBAC). By removing public access to the endpoint, you can avoid unintentional exposure and access to your cluster."
EKS.2,EKS clusters should run on a supported Kubernetes version,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-2(2), NIST.800-53.r5 SI-2(4), NIST.800-53.r5 SI-2(5)","Identify > Vulnerability, patch, and version management",High,AWS::EKS::Cluster,eks-cluster-supported-version,Change triggered,," This control checks whether an Amazon Elastic Kubernetes Service (Amazon EKS cluster is running on a supported Kubernetes version. The control fails if the EKS cluster is running on an unsupported version. The current oldest supported version is   1.24   . If your application doesn't require a specific version of Kubernetes, we recommend that you use the latest available Kubernetes version that's supported by EKS for your clusters. For more information, see   Amazon EKS Kubernetes release calendar   and   Amazon EKS version support and FAQ   in the   Amazon EKS User Guide   ."
EKS.8,EKS clusters should have audit logging enabled,"NIST.800-53.r5 AC-2(12), NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 AU-9(7), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4, NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::EKS::Cluster,eks-cluster-logging-enabled,Periodic,None," This control checks whether an Amazon EKS cluster has audit logging enabled. The control fails if audit logging isn't enabled for the cluster. EKS control plane logging provides audit and diagnostic logs directly from the EKS control plane to Amazon CloudWatch Logs in your account. You can select the log types you need, and logs are sent as log streams to a group for each EKS cluster in CloudWatch. Logging provides visibility into the access and performance of EKS clusters. By sending EKS control plane logs for your EKS clusters to CloudWatch Logs, you can record operations for audit and diagnostic purposes in a central location."
ElastiCache.1,ElastiCache Redis clusters should have automatic backup enabled,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6, NIST.800-53.r5 CP-6(1), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-12, NIST.800-53.r5 SI-13(5)",Recover > Resilience > Backups enabled,High,AWS::ElastiCache::CacheCluster,elasticache-redis-cluster-automatic-backup-check,Periodic,," This control evaluates if an Amazon ElastiCache for Redis cluster has automatic backups scheduled. The control fails if the   SnapshotRetentionLimit   for the Redis cluster is less than the specified time period. Unless you provide a custom parameter value for the snapshot retention period, Security Hub uses a default value of 1 day. Amazon ElastiCache for Redis clusters can back up their data. You can use the backup to restore a cluster or seed a new cluster. The backup consists of the cluster's metadata, along with all of the data in the cluster. All backups are written to Amazon Simple Storage Service (Amazon S3), which provides durable storage. You can restore your data by creating a new Redis cluster and populating it with data from a backup. You can manage backups using the AWS Management Console, the AWS Command Line Interface (AWS CLI), and the ElastiCache API."
ElastiCache.2,ElastiCache for Redis cache clusters should have auto minor version upgrade enabled,"NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-2(2), NIST.800-53.r5 SI-2(4), NIST.800-53.r5 SI-2(5)","Identify > Vulnerability, patch, and version management",High,AWS::ElastiCache::CacheCluster,elasticache-auto-minor-version-upgrade-check,Periodic,None, This control evaluates whether ElastiCache for Redis automatically applies minor version upgrades to cache clusters. This control fails if ElastiCache for Redis cache clusters do not have minor version upgrades automatically applied. AutoMinorVersionUpgrade   is a feature that you can turn on in ElastiCache for Redis to have your cache clusters automatically upgraded when a new minor cache engine version is available. These upgrades might include security patches and bug fixes. Staying up-to-date with patch installation is an important step in securing systems.
ElastiCache.3,ElastiCache for Redis replication groups should have automatic failover enabled,"NIST.800-53.r5 CP-10, NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Medium,AWS::ElastiCache::ReplicationGroup,elasticache-repl-grp-auto-failover-enabled,Periodic,None," This control checks if ElastiCache for Redis replication groups have automatic failover enabled. This control fails if automatic failover isn't enabled for a Redis replication group. When automatic failover is enabled for a replication group, the role of primary node will automatically fail over to one of the read replicas. This failover and replica promotion ensure that you can resume writing to the new primary after promotion is complete, which reduces overall downtime in case of failure."
ElastiCache.4,ElastiCache for Redis replication groups should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data Protection > Encryption of data-at-rest,Medium,AWS::ElastiCache::ReplicationGroup,elasticache-repl-grp-encrypted-at-rest,Periodic,None, This control checks if ElastiCache for Redis replication groups are encrypted at rest. This control fails if an ElastiCache for Redis replication group isn't encrypted at rest. Encrypting data at rest reduces the risk that an unauthenticated user gets access to data that is stored on disk. ElastiCache for Redis replication groups should be encrypted at rest for an added layer of security.
ElastiCache.5,ElastiCache for Redis replication groups should be encrypted in transit,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Data Protection > Encryption of data-in-transit,Medium,AWS::ElastiCache::ReplicationGroup,elasticache-repl-grp-encrypted-in-transit,Periodic,None," This control checks if ElastiCache for Redis replication groups are encrypted in transit. This control fails if an ElastiCache for Redis replication group isn't encrypted in transit. Encrypting data in transit reduces the risk that an unauthorized user can eavesdrop on network traffic. Enabling encryption in transit on an ElastiCache for Redis replication group encrypts your data whenever it's moving from one place to another, such as between nodes in your cluster or between your cluster and your application."
ElastiCache.6,ElastiCache for Redis replication groups before version 6.0 should use Redis AUTH,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6",Protect > Secure access management,Medium,AWS::ElastiCache::ReplicationGroup,elasticache-repl-grp-redis-auth-enabled,Periodic,None," This control checks if ElastiCache for Redis replication groups have Redis AUTH enabled. The control fails for an ElastiCache for Redis replication group if the Redis version of its nodes is below 6.0 and   AuthToken   isn't in use. When you use Redis authentication tokens, or passwords, Redis requires a password before allowing clients to run commands, which improves data security. For Redis 6.0 and later versions, we recommend using Role-Based Access Control (RBAC). Since RBAC is not supported for Redis versions earlier than 6.0, this control only evaluates versions which can't use the RBAC feature."
ElastiCache.7,ElastiCache clusters should not use the default subnet group,"NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(5)",Protect > Secure network configuration,High,AWS::ElastiCache::CacheCluster,elasticache-subnet-group-check,Periodic,None," This control checks if ElastiCache clusters are configured with a custom subnet group. The control fails for an ElastiCache cluster if   CacheSubnetGroupName   has the value   default   . When launching an ElastiCache cluster, a default subnet group is created if one doesn't exist already. The default group uses subnets from the default Virtual Private Cloud (VPC). We recommend using custom subnet groups that are more restrictive of the subnets that the cluster resides in, and the networking that the cluster inherits from the subnets."
ElasticBeanstalk.1,Elastic Beanstalk environments should have enhanced health reporting enabled,"NIST.800-53.r5 CA-7,NIST.800-53.r5 SI-2",Detect > Detection services > Application monitoring,Low,AWS::ElasticBeanstalk::Environment,beanstalk-enhanced-health-reporting-enabled,Change triggered,None," This control checks whether enhanced health reporting is enabled for your AWS Elastic Beanstalk environments. Elastic Beanstalk enhanced health reporting enables a more rapid response to changes in the health of the underlying infrastructure. These changes could result in a lack of availability of the application. Elastic Beanstalk enhanced health reporting provides a status descriptor to gauge the severity of the identified issues and identify possible causes to investigate. The Elastic Beanstalk health agent, included in supported Amazon Machine Images (AMIs), evaluates logs and metrics of environment EC2 instances. For additional information, see   Enhanced health reporting and monitoring   in the   AWS Elastic Beanstalk Developer Guide   ."
ElasticBeanstalk.2,Elastic Beanstalk managed platform updates should be enabled,"NIST.800-53.r5 SI-2,NIST.800-53.r5 SI-2(2),NIST.800-53.r5 SI-2(4),NIST.800-53.r5 SI-2(5)","Detect > Vulnerability, patch, and version management",High,AWS::ElasticBeanstalk::Environment,elastic-beanstalk-managed-updates-enabled,Change triggered,," This control checks whether managed platform updates are enabled for an Elastic Beanstalk environment. The control fails if no managed platform updates are enabled. By default, the control passes if any type of platform update is enabled. Optionally, you can provide a custom parameter value to require a specific update level. Enabling managed platform updates ensures that the latest available platform fixes, updates, and features for the environment are installed. Keeping up to date with patch installation is an important step in securing systems."
ElasticBeanstalk.3,Elastic Beanstalk should stream logs to CloudWatch,,Identify > Logging,High,AWS::ElasticBeanstalk::Environment,elastic-beanstalk-logs-to-cloudwatch,Change triggered,," This control checks whether an Elastic Beanstalk environment is configured to send logs to CloudWatch Logs. The control fails if an Elastic Beanstalk environment isn't configured to send logs to CloudWatch Logs. Optionally, you can provide a custom value for the   RetentionInDays   parameter if you want the control to pass only if logs are retained for the specified number of days before expiration. CloudWatch helps you collect and monitor various metrics for your applications and infrastructure resources. You can also use CloudWatch to configure alarm actions based on specific metrics. We recommend integrating Elastic Beanstalk with CloudWatch to get increased visibility into your Elastic Beanstalk environment. Elastic Beanstalk logs include the eb-activity.log, access logs from the environment nginx or Apache proxy server, and logs that are specific to an environment."
ELB.1,Application Load Balancer should be configured to redirect all HTTP requests to HTTPS,"PCI DSS v3.2.1/2.3,PCI DSS v3.2.1/4.1, NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",,Medium,AWS::ElasticLoadBalancingV2::LoadBalancer,alb-http-to-https-redirection-check,Periodic,None," This control checks whether HTTP to HTTPS redirection is configured on all HTTP listeners of Application Load Balancers. The control fails if any of the HTTP listeners of Application Load Balancers do not have HTTP to HTTPS redirection configured. Before you start to use your Application Load Balancer, you must add one or more listeners. A listener is a process that uses the configured protocol and port to check for connection requests. Listeners support both the HTTP and HTTPS protocols. You can use an HTTPS listener to offload the work of encryption and decryption to your load balancer. To enforce encryption in transit, you should use redirect actions with Application Load Balancers to redirect client HTTP requests to an HTTPS request on port 443. To learn more, see   Listeners for your Application Load Balancers   in   User Guide for Application Load Balancers   ."
ELB.2,Classic Load Balancers with SSL/HTTPS listeners should use a certificate provided by AWS Certificate Manager,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(5), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Encryption of data in transit,Medium,AWS::ElasticLoadBalancing::LoadBalancer,elb-acm-certificate-required,Change triggered,None," This control checks whether the Classic Load Balancer uses HTTPS/SSL certificates provided by AWS Certificate Manager (ACM). The control fails if the Classic Load Balancer configured with HTTPS/SSL listener does not use a certificate provided by ACM. To create a certificate, you can use either ACM or a tool that supports the SSL and TLS protocols, such as OpenSSL. Security Hub recommends that you use ACM to create or import certificates for your load balancer. ACM integrates with Classic Load Balancers so that you can deploy the certificate on your load balancer. You also should automatically renew these certificates."
ELB.3,Classic Load Balancer listeners should be configured with HTTPS or TLS termination,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data in transit,Medium,AWS::ElasticLoadBalancing::LoadBalancer,elb-tls-https-listeners-only,Change triggered,None," This control checks whether your Classic Load Balancer listeners are configured with HTTPS or TLS protocol for front-end (client to load balancer) connections. The control is applicable if a Classic Load Balancer has listeners. If your Classic Load Balancer does not have a listener configured, then the control does not report any findings. The control passes if the Classic Load Balancer listeners are configured with TLS or HTTPS for front-end connections. The control fails if the listener is not configured with TLS or HTTPS for front-end connections. Before you start to use a load balancer, you must add one or more listeners. A listener is a process that uses the configured protocol and port to check for connection requests. Listeners can support both HTTP and HTTPS/TLS protocols. You should always use an HTTPS or TLS listener, so that the load balancer does the work of encryption and decryption in transit."
ELB.4,Application Load Balancer should be configured to drop http headers,"NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8(2)",Protect > Network security,Medium,AWS::ElasticLoadBalancingV2::LoadBalancer,alb-http-drop-invalid-header-enabled,Change triggered,None," This control evaluates AWS Application Load Balancers to ensure they are configured to drop invalid HTTP headers. The control fails if the value of   routing.http.drop_invalid_header_fields.enabled   is set to   false   . By default, Application Load Balancers are not configured to drop invalid HTTP header values. Removing these header values prevents HTTP desync attacks. Note that you can disable this control if   ELB.12   is enabled."
ELB.5,Application and Classic Load Balancers logging should be enabled,"NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-7(8)",Logging,Medium,"AWS::ElasticLoadBalancing::LoadBalancer   ,   AWS::ElasticLoadBalancingV2::LoadBalancer",elb-logging-enabled,Change triggered,None," This control checks whether the Application Load Balancer and the Classic Load Balancerhave logging enabled. The control fails if   access_logs.s3.enabled   is   false   . Elastic Load Balancing provides access logs that capture detailed information about requests sent to your load balancer. Each log contains information such as the time the request was received, the client's IP address, latencies, request paths, and server responses. You can use these access logs to analyze traffic patterns and to troubleshoot issues. To learn more, see   Access logs for your Classic Load Balancer   in   User Guide for Classic Load Balancers   ."
ELB.6,Application Load Balancer deletion protection should be enabled,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2), NIST.800-53.r5 CM-3, NIST.800-53.r5 SC-5(2)",Recover > Resilience > High availability,Medium,AWS::ElasticLoadBalancingV2::LoadBalancer,elb-deletion-protection-enabled,Change triggered,None, This control checks whether an Application Load Balancer has deletion protection enabled. The control fails if deletion protection is not configured. Enable deletion protection to protect your Application Load Balancer from deletion.
ELB.7,Classic Load Balancers should have connection draining enabled,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Recover > Resilience,Medium,AWS::ElasticLoadBalancing::LoadBalancer,elb-connection-draining-enabled   (custom Security Hub rule),Change triggered,None," This control checks whether Classic Load Balancers have connection draining enabled. Enabling connection draining on Classic Load Balancers ensures that the load balancer stops sending requests to instances that are de-registering or unhealthy. It keeps the existing connections open. This is particularly useful for instances in Auto Scaling groups, to ensure that connections aren't severed abruptly."
ELB.8,Classic Load Balancers with SSL listeners should use a predefined security policy that has strong AWS Configuration,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Encryption of data in transit,Medium,AWS::ElasticLoadBalancing::LoadBalancer,elb-predefined-security-policy-ssl-check,Change triggered,," This control checks whether your Classic Load Balancer HTTPS/SSL listeners use the predefined policy   ELBSecurityPolicy-TLS-1-2-2017-01   . The control fails if the Classic Load Balancer HTTPS/SSL listeners do not use   ELBSecurityPolicy-TLS-1-2-2017-01   . A security policy is a combination of SSL protocols, ciphers, and the Server Order Preference option. Predefined policies control the ciphers, protocols, and preference orders to support during SSL negotiations between a client and load balancer. Using   ELBSecurityPolicy-TLS-1-2-2017-01   can help you to meet compliance and security standards that require you to disable specific versions of SSL and TLS. For more information, see   Predefined SSL security policies for Classic Load Balancers   in   User Guide for Classic Load Balancers   ."
ELB.9,Classic Load Balancers should have cross-zone load balancing enabled,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High Availability,Medium,AWS::ElasticLoadBalancing::LoadBalancer,elb-cross-zone-load-balancing-enabled,Change triggered,None," This control checks if cross-zone load balancing is enabled for the Classic Load Balancers (CLBs). The control fails if cross-zone load balancing is not enabled for a CLB. A load balancer node distributes traffic only across the registered targets in its Availability Zone. When cross-zone load balancing is disabled, each load balancer node distributes traffic only across the registered targets in its Availability Zone. If the number of registered targets is not same across the Availability Zones, traffic wont be distributed evenly and the instances in one zone may end up over utilized compared to the instances in another zone. With cross-zone load balancing enabled, each load balancer node for your Classic Load Balancer distributes requests evenly across the registered instances in all enabled Availability Zones. For details see   Cross-zone load balancing   in the Elastic Load Balancing User Guide."
ELB.10,Classic Load Balancer should span multiple Availability Zones,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High Availability,Medium,AWS::ElasticLoadBalancing::LoadBalancer,clb-multiple-az,Change triggered,," This control checks whether a Classic Load Balancer has been configured to span at least the specified number of Availability Zones (AZs). The control fails if the Classic Load Balancer does not span at least the specified number of AZs. Unless you provide a custom parameter value for the minimum number of AZs, Security Hub uses a default value of two AZs. A Classic Load Balancer can be set up to distribute incoming requests across Amazon EC2 instances in a single Availability Zone or multiple Availability Zones. A Classic Load Balancer that does not span multiple Availability Zones is unable to redirect traffic to targets in another Availability Zone if the sole configured Availability Zone becomes unavailable."
ELB.12,Application Load Balancer should be configured with defensive or strictest desync mitigation mode,"NIST.800-53.r5 AC-4(21), NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Data protect > Data integrity,Medium,AWS::ElasticLoadBalancingV2::LoadBalancer,alb-desync-mode-check,Change triggered,," This control checks whether an Application Load Balancer is configured with defensive or strictest desync mitigation mode. The control fails if an Application Load Balancer is not configured with defensive or strictest desync mitigation mode. HTTP Desync issues can lead to request smuggling and make applications vulnerable to request queue or cache poisoning. In turn, these vulnerabilities can lead to credential stuffing or execution of unauthorized commands. Application Load Balancers configured with defensive or strictest desync mitigation mode protect your application from security issues that may be caused by HTTP Desync."
ELB.13,"Application, Network and Gateway Load Balancers should span multiple Availability Zones","NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Medium,AWS::ElasticLoadBalancingV2::LoadBalancer,elbv2-multiple-az,Change triggered,," This control checks whether an Elastic Load Balancer V2 (Application, Network, or Gateway Load Balancer) has registered instances from at least the specified number of Availability Zones (AZs). The control fails if an Elastic Load Balancer V2 doesn't have instances registered in at least the specified number of AZs. Unless you provide a custom parameter value for the minimum number of AZs, Security Hub uses a default value of two AZs. Elastic Load Balancing automatically distributes your incoming traffic across multiple targets, such as EC2 instances, containers, and IP addresses, in one or more Availability Zones. Elastic Load Balancing scales your load balancer as your incoming traffic changes over time. It is recommended to configure at least two availability zones to ensure availability of services, as the Elastic Load Balancer will be able to direct traffic to another availability zone if one becomes unavailable. Having multiple availability zones configured will help eliminate having a single point of failure for the application."
ELB.14,Classic Load Balancer should be configured with defensive or strictest desync mitigation mode,"NIST.800-53.r5 AC-4(21), NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Data Protect > Data Integrity,Medium,AWS::ElasticLoadBalancing::LoadBalancer,clb-desync-mode-check,Change triggered,," This control checks whether a Classic Load Balancer is configured with defensive or strictest desync mitigation mode. The control fails if the Classic Load Balancer isn't configured with defensive or strictest desync mitigation mode. HTTP Desync issues can lead to request smuggling and make applications vulnerable to request queue or cache poisoning. In turn, these vulnerabilities can lead to credential hijacking or execution of unauthorized commands. Classic Load Balancers configured with defensive or strictest desync mitigation mode protect your application from security issues that may be caused by HTTP Desync."
ELB.16,Application Load Balancers should be associated with an AWS WAF web ACL,NIST.800-53.r5 AC-4(21),Protect > Protective services,Medium,AWS::ElasticLoadBalancingV2::LoadBalancer,alb-waf-enabled,Change triggered,None," This control checks whether an Application Load Balancer is associated with an AWS WAF Classic or AWS WAF web access control list (web ACL). The control fails if the   Enabled   field for the AWS WAF configuration is set to   false   . AWS WAF is a web application firewall that helps protect web applications and APIs from attacks. With AWS WAF, you can configure a web ACL, which is a set of rules that allow, block, or count web requests based on customizable web security rules and conditions that you define. We recommend associating your Application Load Balancer with an AWS WAF web ACL to help protect it from malicious attacks."
EMR.1,Amazon EMR cluster primary nodes should not have public IP addresses,"PCI DSS v3.2.1/1.2.1,PCI DSS v3.2.1/1.3.1,PCI DSS v3.2.1/1.3.2,PCI DSS v3.2.1/1.3.4,PCI DSS v3.2.1/1.3.6, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,High,AWS::EMR::Cluster,emr-master-no-public-ip,Periodic,None, This control checks whether master nodes on Amazon EMR clusters have public IP addresses. The control fails if public IP addresses are associated with any of the master node instances. Public IP addresses are designated in the   PublicIp   field of the   NetworkInterfaces   configuration for the instance. This control only checks Amazon EMR clusters that are in a   RUNNING   or   WAITING   state.
EMR.2,Amazon EMR block public access setting should be enabled,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure access management > Resource not publicly accessible,Critical,AWS::::Account,emr-block-public-access,Periodic,None, This control checks whether your account is configured with Amazon EMR block public access. The control fails if the block public access setting isn't enabled or if any port other than port 22 is allowed.
ES.1,Elasticsearch domains should have encryption at-rest enabled,"PCI DSS v3.2.1/3.4, NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::Elasticsearch::Domain,elasticsearch-encrypted-at-rest,Periodic,None," This control checks whether Elasticsearch domains have encryption at rest configuration enabled. The check fails if encryption at rest is not enabled. For an added layer of security for your sensitive data in OpenSearch, you should configure your OpenSearch to be encrypted at rest. Elasticsearch domains offer encryption of data at rest. The feature uses AWS KMS to store and manage your encryption keys. To perform the encryption, it uses the Advanced Encryption Standard algorithm with 256-bit keys (AES-256). To learn more about OpenSearch encryption at rest, see   Encryption of data at rest for Amazon OpenSearch Service   in the   Amazon OpenSearch Service Developer Guide   . Certain instance types, such as   t.small   and   t.medium   , don't support encryption of data at rest. For details, see   Supported instance types   in the   Amazon OpenSearch Service Developer Guide   ."
ES.2,Elasticsearch domains should not be publicly accessible,"PCI DSS v3.2.1/1.2.1,PCI DSS v3.2.1/1.3.1,PCI DSS v3.2.1/1.3.2,PCI DSS v3.2.1/1.3.4,PCI DSS v3.2.1/1.3.6, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > Resources within VPC,Critical,AWS::Elasticsearch::Domain,elasticsearch-in-vpc-only,Periodic,None," This control checks whether Elasticsearch domains are in a VPC. It does not evaluate the VPC subnet routing configuration to determine public access. You should ensure that Elasticsearch domains are not attached to public subnets. See   Resource-based policies   in the   Amazon OpenSearch Service Developer Guide   . You should also ensure that your VPC is configured according to the recommended best practices. See   Security best practices for your VPC   in the   Amazon VPC User Guide   . Elasticsearch domains deployed within a VPC can communicate with VPC resources over the private AWS network, without the need to traverse the public internet. This configuration increases the security posture by limiting access to the data in transit. VPCs provide a number of network controls to secure access to Elasticsearch domains, including network ACL and security groups. Security Hub recommends that you migrate public Elasticsearch domains to VPCs to take advantage of these controls."
ES.3,Elasticsearch domains should encrypt data sent between nodes,"NIST.800-53.r5 AC-4, NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2)",Protect > Data protection > Encryption of data in transit,Medium,AWS::Elasticsearch::Domain,elasticsearch-node-to-node-encryption-check,Change triggered,None, This control checks whether Elasticsearch domains have node-to-node encryption enabled. HTTPS (TLS) can be used to help prevent potential attackers from eavesdropping on or manipulating network traffic using person-in-the-middle or similar attacks. Only encrypted connections over HTTPS (TLS) should be allowed. Enabling node-to-node encryption for Elasticsearch domains ensures that intra-cluster communications are encrypted in transit. There can be a performance penalty associated with this configuration. You should be aware of and test the performance trade-off before enabling this option.
ES.4,Elasticsearch domain error logging to CloudWatch Logs should be enabled,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify - Logging,Medium,AWS::Elasticsearch::Domain,elasticsearch-logs-to-cloudwatch,Change triggered,," This control checks whether Elasticsearch domains are configured to send error logs to CloudWatch Logs. You should enable error logs for Elasticsearch domains and send those logs to CloudWatch Logs for retention and response. Domain error logs can assist with security and access audits, and can help to diagnose availability issues."
ES.5,Elasticsearch domains should have audit logging enabled,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::Elasticsearch::Domain,elasticsearch-audit-logging-enabled   (custom Security Hub rule),Change triggered,," This control checks whether Elasticsearch domains have audit logging enabled. This control fails if an Elasticsearch domain does not have audit logging enabled. Audit logs are highly customizable. They allow you to track user activity on your Elasticsearch clusters, including authentication successes and failures, requests to OpenSearch, index changes, and incoming search queries."
ES.6,Elasticsearch domains should have at least three data nodes,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Medium,AWS::Elasticsearch::Domain,elasticsearch-data-node-fault-tolerance   (custom Security Hub rule),Change triggered,None, This control checks whether Elasticsearch domains are configured with at least three data nodes and   zoneAwarenessEnabled   is   true   . An Elasticsearch domain requires at least three data nodes for high availability and fault-tolerance. Deploying an Elasticsearch domain with at least three data nodes ensures cluster operations if a node fails.
ES.7,Elasticsearch domains should be configured with at least three dedicated master nodes,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Medium,AWS::Elasticsearch::Domain,elasticsearch-primary-node-fault-tolerance   (custom Security Hub rule),Change triggered,None," This control checks whether Elasticsearch domains are configured with at least three dedicated master nodes. This control fails if the domain does not use dedicated master nodes. This control passes if Elasticsearch domains have five dedicated master nodes. However, using more than three master nodes might be unnecessary to mitigate the availability risk, and will result in additional cost. An Elasticsearch domain requires at least three dedicated master nodes for high availability and fault-tolerance. Dedicated master node resources can be strained during data node blue/green deployments because there are additional nodes to manage. Deploying an Elasticsearch domain with at least three dedicated master nodes ensures sufficient master node resource capacity and cluster operations if a node fails."
ES.8,Connections to Elasticsearch domains should be encrypted using TLS 1.2,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data in transit,Medium,AWS::Elasticsearch::Domain,elasticsearch-https-required   (custom Security Hub rule),Change triggered,None, This control checks whether connections to Elasticsearch domains are required to use TLS 1.2. The check fails if the Elasticsearch domain   TLSSecurityPolicy   is not Policy-Min-TLS-1-2-2019-07 or if HTTPS isn't enabled. HTTPS (TLS) can be used to help prevent potential attackers from using person-in-the-middle or similar attacks to eavesdrop on or manipulate network traffic. Only encrypted connections over HTTPS (TLS) should be allowed. Encrypting data in transit can affect performance. You should test your application with this feature to understand the performance profile and the impact of TLS. TLS 1.2 provides several security enhancements over previous versions of TLS.
EventBridge.3,EventBridge custom event buses should have a resource-based policy attached,,Protect > Secure access management > Resource policy configuration,Low,AWS::Events::EventBus,custom-schema-registry-policy-attached,Change triggered,None," This control checks if an Amazon EventBridge custom event bus has a resource-based policy attached. This control fails if the custom event bus doesn't have a resource-based policy. By default, an EventBridge custom event bus doesn't have a resource-based policy attached. This allows principals in the account to access the event bus. By attaching a resource-based policy to the event bus, you can limit access to the event bus to specified accounts, as well as intentionally grant access to entities in another account."
EventBridge.4,EventBridge global endpoints should have event replication enabled,,Recover > Resilience > High availability,Medium,AWS::Events::Endpoint,global-endpoint-event-replication-enabled,Change triggered,None," This control checks if event replication is enabled for an Amazon EventBridge global endpoint. The control fails if event replication isn't enabled for a global endpoint. Global endpoints help make your application Regional-fault tolerant. To start, you assign an Amazon RouteÂ 53 health check to the endpoint. When failover is initiated, the health check reports an ""unhealthy"" state. Within minutes of failover initiation, all custom events are routed to an event bus in the secondary Region and are processed by that event bus. When you use global endpoints, you can enable event replication. Event replication sends all custom events to the event buses in the primary and secondary Regions using managed rules. We recommend enabling event replication when setting up global endpoints. Event replication helps you verify that your global endpoints are configured correctly. Event replication is required to automatically recover from a failover event. If you donât have event replication enabled, youâll have to manually reset the RouteÂ 53 health check to ""healthy"" before events are rerouted back to the primary Region."
FSx.1,FSx for OpenZFS file systems should be configured to copy tags to backups and volumes,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Identify > Inventory > Tagging,Low,AWS::FSx::FileSystem,fsx-openzfs-copy-tags-enabled,Change triggered,None," This control checks if an Amazon FSx for OpenZFS file system is configured to copy tags to backups and volumes. The control fails if the OpenZFS file system isn't configured to copy tags to backups and volumes. Identification and inventory of your IT assets is an important aspect of governance and security. Tags help you categorize your AWS resources in different ways, for example, by purpose, owner, or environment. This is useful when you have many resources of the same type because you can quickly identify a specific resource based on the tags that you assigned to it."
GuardDuty.1,GuardDuty should be enabled,"PCI DSS v3.2.1/11.4, NIST.800-53.r5 AC-2(12), NIST.800-53.r5 AU-6(1), NIST.800-53.r5 AU-6(5), NIST.800-53.r5 CA-7, NIST.800-53.r5 CM-8(3), NIST.800-53.r5 RA-3(4), NIST.800-53.r5 SA-11(1), NIST.800-53.r5 SA-11(6), NIST.800-53.r5 SA-15(2), NIST.800-53.r5 SA-15(8), NIST.800-53.r5 SA-8(19), NIST.800-53.r5 SA-8(21), NIST.800-53.r5 SA-8(25), NIST.800-53.r5 SC-5, NIST.800-53.r5 SC-5(1), NIST.800-53.r5 SC-5(3), NIST.800-53.r5 SI-20, NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4, NIST.800-53.r5 SI-4(1), NIST.800-53.r5 SI-4(13), NIST.800-53.r5 SI-4(2), NIST.800-53.r5 SI-4(22), NIST.800-53.r5 SI-4(25), NIST.800-53.r5 SI-4(4), NIST.800-53.r5 SI-4(5)",Detect > Detection services,High,AWS::::Account,guardduty-enabled-centralized,Periodic,None," This control checks whether Amazon GuardDuty is enabled in your GuardDuty account and Region. It is highly recommended that you enable GuardDuty in all supported AWS Regions. Doing so allows GuardDuty to generate findings about unauthorized or unusual activity, even in Regions that you do not actively use. This also allows GuardDuty to monitor CloudTrail events for global AWS services such as IAM."
IAM.1,"IAM policies should not allow full ""*"" administrative privileges","PCI DSS v3.2.1/7.2.1, CIS AWS Foundations Benchmark v1.2.0/1.22, CIS AWS Foundations Benchmark v1.4.0/1.16, NIST.800-53.r5 AC-2, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-5, NIST.800-53.r5 AC-6, NIST.800-53.r5 AC-6(10), NIST.800-53.r5 AC-6(2), NIST.800-53.r5 AC-6(3)",Protect > Secure access management,High,AWS::IAM::Policy,iam-policy-no-statements-with-admin-access,Change triggered,," The control only checks the customer managed policies that you create. It does not check inline and AWS managed policies. IAM policies define a set of privileges that are granted to users, groups, or roles. Following standard security advice, AWS recommends that you grant least privilege, which means to grant only the permissions that are required to perform a task. When you provide full administrative privileges instead of the minimum set of permissions that the user needs, you expose the resources to potentially unwanted actions. Instead of allowing full administrative privileges, determine what users need to do and then craft policies that let the users perform only those tasks. It is more secure to start with a minimum set of permissions and grant additional permissions as necessary. Do not start with permissions that are too lenient and then try to tighten them later."
IAM.2,IAM users should not have IAM policies attached,"PCI DSS v3.2.1/7.2.1, CIS AWS Foundations Benchmark v1.2.0/1.16, NIST.800-53.r5 AC-2, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6, NIST.800-53.r5 AC-6(3)",Protect > Secure access management,Low,AWS::IAM::User,iam-user-no-policies-check,Change triggered,None," This control checks whether your IAM users have policies attached. The control fails if your IAM users have policies attached. Instead, IAM users must inherit permissions from IAM groups or assume a role. By default, IAM users, groups, and roles have no access to AWS resources. IAM policies grant privileges to users, groups, or roles. We recommend that you apply IAM policies directly to groups and roles but not to users. Assigning privileges at the group or role level reduces the complexity of access management as the number of users grows. Reducing access management complexity might in turn reduce the opportunity for a principal to inadvertently receive or retain excessive privileges."
IAM.3,IAM users' access keys should be rotated every 90 days or less,"CIS AWS Foundations Benchmark v1.2.0/1.4, CIS AWS Foundations Benchmark v1.4.0/1.14, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-2(3), NIST.800-53.r5 AC-3(15)",Protect > Secure access management,Medium,AWS::IAM::User,access-keys-rotated,Periodic,," This control checks whether the active access keys are rotated within 90 days. We highly recommend that you do not generate and remove all access keys in your account. Instead, the recommended best practice is to either create one or more IAM roles or to use   federation   through AWS IAM Identity Center. You can use these methods to allow your users to access the AWS Management Console and AWS CLI. Each approach has its use cases. Federation is generally better for enterprises that have an existing central directory or plan to need more than the current limit on IAM users. Applications that run outside of an AWS environment need access keys for programmatic access to AWS resources. However, if the resources that need programmatic access run inside AWS, the best practice is to use IAM roles. Roles allow you to grant a resource access without hardcoding an access key ID and secret access key into the configuration. To learn more about protecting your access keys and account, see   Best practices for managing AWS access keys   in the   AWS General Reference   . Also see the blog post   Guidelines for protecting your AWS account while using programmatic access   . If you already have an access key, Security Hub recommends that you rotate the access keys every 90 days. Rotating access keys reduces the chance that an access key that is associated with a compromised or terminated account is used. It also ensures that data cannot be accessed with an old key that might have been lost, cracked, or stolen. Always update your applications after you rotate access keys. Access keys consist of an access key ID and a secret access key. They are used to sign programmatic requests that you make to AWS. Users need their own access keys to make programmatic calls to AWS from the AWS CLI, Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the API operations for individual AWS services. If your organization uses AWS IAM Identity Center (IAM Identity Center), your users can sign in to Active Directory, a built-in IAM Identity Center directory, or   another identity provider (IdP) connected to IAM Identity Center   . They can then be mapped to an IAM role that enables them to run AWS CLI commands or call AWS API operations without the need for access keys. To learn more, see   Configuring the AWS CLI to use AWS IAM Identity Center   in the   AWS Command Line Interface User Guide   ."
IAM.4,IAM root user access key should not exist,"PCI DSS v3.2.1/2.1, PCI DSS v3.2.1/2.2, PCI DSS v3.2.1/7.2.1, CIS AWS Foundations Benchmark v1.2.0/1.12, CIS AWS Foundations Benchmark v1.4.0/1.4, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6, NIST.800-53.r5 AC-6(10), NIST.800-53.r5 AC-6(2)",Protect > Secure access management,Critical,AWS::::Account,iam-root-access-key-check,Periodic,None, This control checks whether the root user access key is present. The root user is the most privileged user in an AWS account. AWS access keys provide programmatic access to a given account. Security Hub recommends that you remove all access keys that are associated with the root user. This limits that vectors that can be used to compromise your account. It also encourages the creation and use of role-based accounts that are least privileged.
IAM.5,MFA should be enabled for all IAM users that have a console password,"CIS AWS Foundations Benchmark v1.2.0/1.2, CIS AWS Foundations Benchmark v1.4.0/1.10, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3(15), NIST.800-53.r5 IA-2(1), NIST.800-53.r5 IA-2(2), NIST.800-53.r5 IA-2(6), NIST.800-53.r5 IA-2(8)",Protect > Secure access management,Medium,AWS::IAM::User,mfa-enabled-for-iam-console-access,Periodic,None," This control checks whether AWS multi-factor authentication (MFA) is enabled for all IAM users that use a console password. Multi-factor authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they are prompted for their user name and password. In addition, they are prompted for an authentication code from their AWS MFA device. We recommend that you enable MFA for all accounts that have a console password. MFA is designed to provide increased security for console access. The authenticating principal must possess a device that emits a time-sensitive key and must have knowledge of a credential."
IAM.6,Hardware MFA should be enabled for the root user,"PCI DSS v3.2.1/8.3.1, CIS AWS Foundations Benchmark v1.2.0/1.14, CIS AWS Foundations Benchmark v1.4.0/1.6, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3(15), NIST.800-53.r5 IA-2(1), NIST.800-53.r5 IA-2(2), NIST.800-53.r5 IA-2(6), NIST.800-53.r5 IA-2(8)",Protect > Secure access management,Critical,AWS::::Account,root-account-hardware-mfa-enabled,Periodic,None," This control checks whether your AWS account is enabled to use a hardware multi-factor authentication (MFA) device to sign in with root user credentials. The control fails if MFA isn't enabled or if any virtual MFA devices are permitted for signing in with root user credentials. Virtual MFA might not provide the same level of security as hardware MFA devices. We recommend that you use only a virtual MFA device while you wait for hardware purchase approval or for your hardware to arrive. To learn more, see   Enabling a virtual multi-factor authentication (MFA) device (console)   in the   IAM User Guide   . Both time-based one-time password (TOTP) and Universal 2nd Factor (U2F) tokens are viable as hardware MFA options."
IAM.7,Password policies for IAM users should have strong configurations,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-2(3), NIST.800-53.r5 AC-3(15), NIST.800-53.r5 IA-5(1)",Protect > Secure access management,Medium,AWS::::Account,iam-password-policy,Periodic,," This control checks whether the account password policy for IAM users uses strong configurations. The control fails if the password policy doesn't use strong configurations. Unless you provide custom parameter values, Security Hub uses the default values mentioned in the preceding table. The   PasswordReusePrevention   and   MaxPasswordAge   parameters have no default value, so if you exclude these parameters, Security Hub ignores number of password rotations and password age when evaluating this control. To access the AWS Management Console, IAM users need passwords. As a best practice, Security Hub highly recommends that instead of creating IAM users, you use federation. Federation allows users to use their existing corporate credentials to log into the AWS Management Console. Use AWS IAM Identity Center (IAM Identity Center) to create or federate the user, and then assume an IAM role into an account. To learn more about identity providers and federation, see   Identity providers and federation   in the   IAM User Guide   . To learn more about IAM Identity Center, see the   AWS IAM Identity Center User Guide   . If you need to use IAM users, Security Hub recommends that you enforce the creation of strong user passwords. You can set a password policy on your AWS account to specify complexity requirements and mandatory rotation periods for passwords. When you create or change a password policy, most of the password policy settings are enforced the next time users change their passwords. Some of the settings are enforced immediately."
IAM.8,Unused IAM user credentials should be removed,"PCI DSS v3.2.1/8.1.4, CIS AWS Foundations Benchmark v1.2.0/1.3, NIST.800-53.r5 AC-2, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-2(3), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6",Protect > Secure access management,Medium,AWS::IAM::User,iam-user-unused-credentials-check,Periodic,," This control checks whether your IAM users have passwords or active access keys that have not been used for 90 days. IAM users can access AWS resources using different types of credentials, such as passwords or access keys. Security Hub recommends that you remove or deactivate all credentials that were unused for 90 days or more. Disabling or removing unnecessary credentials reduces the window of opportunity for credentials associated with a compromised or abandoned account to be used."
IAM.9,MFA should be enabled for the root user,"PCI DSS v3.2.1/8.3.1, CIS AWS Foundations Benchmark v1.2.0/1.13, CIS AWS Foundations Benchmark v1.4.0/1.5, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3(15), NIST.800-53.r5 IA-2(1), NIST.800-53.r5 IA-2(2), NIST.800-53.r5 IA-2(6), NIST.800-53.r5 IA-2(8)",Protect > Secure access management,Critical,AWS::::Account,root-account-mfa-enabled,Periodic,None," The root user has complete access to all the services and resources in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to the AWS Management Console, they're prompted for their user name and password and for an authentication code from their AWS MFA device. When you use virtual MFA for the root user, CIS recommends that the device used is   not   a personal device. Instead, use a dedicated mobile device (tablet or phone) that you manage to keep charged and secured independent of any individual personal devices. This lessens the risks of losing access to the MFA due to device loss, device trade-in, or if the individual owning the device is no longer employed at the company."
IAM.10,Password policies for IAM users should have strong AWS Configurations,"PCI DSS v3.2.1/8.1.4, PCI DSS v3.2.1/8.2.3, PCI DSS v3.2.1/8.2.4, PCI DSS v3.2.1/8.2.5",Protect > Secure access management,Medium,AWS::::Account,iam-password-policy,Periodic,None, This control checks whether the account password policy for IAM users uses the following minimum PCI DSS configurations.
IAM.11,Ensure IAM password policy requires at least one uppercase letter,CIS AWS Foundations Benchmark v1.2.0/1.5,Protect > Secure access management,Medium,AWS::::Account,iam-password-policy,Periodic,None," Password policies, in part, enforce password complexity requirements. Use IAM password policies to ensure that passwords use different character sets. CIS recommends that the password policy require at least one uppercase letter. Setting a password complexity policy increases account resiliency against brute force login attempts."
IAM.12,Ensure IAM password policy requires at least one lowercase letter,CIS AWS Foundations Benchmark v1.2.0/1.6,Protect > Secure access management,Medium,AWS::::Account,iam-password-policy,Periodic,None," Password policies, in part, enforce password complexity requirements. Use IAM password policies to ensure that passwords use different character sets. CIS recommends that the password policy require at least one lowercase letter. Setting a password complexity policy increases account resiliency against brute force login attempts."
IAM.13,Ensure IAM password policy requires at least one symbol,CIS AWS Foundations Benchmark v1.2.0/1.7,Protect > Secure access management,Medium,AWS::::Account,iam-password-policy,Periodic,None," Password policies, in part, enforce password complexity requirements. Use IAM password policies to ensure that passwords use different character sets. CIS recommends that the password policy require at least one symbol. Setting a password complexity policy increases account resiliency against brute force login attempts."
IAM.14,Ensure IAM password policy requires at least one number,CIS AWS Foundations Benchmark v1.2.0/1.8,Protect > Secure access management,Medium,AWS::::Account,iam-password-policy,Periodic,None," Password policies, in part, enforce password complexity requirements. Use IAM password policies to ensure that passwords use different character sets. CIS recommends that the password policy require at least one number. Setting a password complexity policy increases account resiliency against brute force login attempts."
IAM.15,Ensure IAM password policy requires minimum password length of 14 or greater,"CIS AWS Foundations Benchmark v1.2.0/1.9, CIS AWS Foundations Benchmark v1.4.0/1.8",Protect > Secure access management,Medium,AWS::::Account,iam-password-policy,Periodic,None," Password policies, in part, enforce password complexity requirements. Use IAM password policies to ensure that passwords are at least a given length. CIS recommends that the password policy require a minimum password length of 14 characters. Setting a password complexity policy increases account resiliency against brute force login attempts."
IAM.16,Ensure IAM password policy prevents password reuse,"CIS AWS Foundations Benchmark v1.2.0/1.10, CIS AWS Foundations Benchmark v1.4.0/1.9",Protect > Secure access management,Low,AWS::::Account,iam-password-policy,Periodic,None, This control checks whether the number of passwords to remember is set to 24. The control fails if the value is not 24. IAM password policies can prevent the reuse of a given password by the same user. CIS recommends that the password policy prevent the reuse of passwords. Preventing password reuse increases account resiliency against brute force login attempts.
IAM.17,Ensure IAM password policy expires passwords within 90 days or less,CIS AWS Foundations Benchmark v1.2.0/1.11,Protect > Secure access management,Low,AWS::::Account,iam-password-policy,Periodic,None, IAM password policies can require passwords to be rotated or expired after a given number of days.
IAM.18,Ensure a support role has been created to manage incidents with AWS Support,"CIS AWS Foundations Benchmark v1.2.0/1.20, CIS AWS Foundations Benchmark v1.4.0/1.17",Protect > Secure access management,Low,AWS::::Account,iam-policy-in-use,Periodic,," AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM role to allow authorized users to manage incidents with AWS Support. By implementing least privilege for access control, an IAM role will require an appropriate IAM policy to allow support center access in order to manage incidents with AWS Support."
IAM.19,MFA should be enabled for all IAM users,"PCI DSS v3.2.1/8.3.1, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3(15), NIST.800-53.r5 IA-2(1), NIST.800-53.r5 IA-2(2), NIST.800-53.r5 IA-2(6), NIST.800-53.r5 IA-2(8)",Protect > Secure access management,Medium,AWS::IAM::User,iam-user-mfa-enabled,Periodic,None, This control checks whether the IAM users have multi-factor authentication (MFA) enabled.
IAM.20,Avoid the use of the root user,CIS AWS Foundations Benchmark v1.2.0/1.1,Protect > Secure access management,Low,AWS::IAM::User,use-of-root-account-test   (custom Security Hub rule),Periodic,None," As a best practice, use your root user credentials only when required to   perform account and service management tasks   . Apply IAM policies directly to groups and roles but not to users. For instructions on setting up an administrator for daily use, see   Creating your first IAM admin user and group   in the   IAM User Guide   ."
IAM.21,IAM customer managed policies that you create should not allow wildcard actions for services,"NIST.800-53.r5 AC-2, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-5, NIST.800-53.r5 AC-6, NIST.800-53.r5 AC-6(10), NIST.800-53.r5 AC-6(2), NIST.800-53.r5 AC-6(3)",Detect > Secure access management,Low,AWS::IAM::Policy,iam-policy-no-statements-with-full-access,Change triggered,," For example, the following statement in a policy results in a failed finding. This control only applies to customer managed IAM policies. It does not apply to IAM policies that are managed by AWS. When you assign permissions to AWS services, it is important to scope the allowed IAM actions in your IAM policies. You should restrict IAM actions to only those actions that are needed. This helps you to provision least privilege permissions. Overly permissive policies might lead to privilege escalation if the policies are attached to an IAM principal that might not require the permission. This control passes if you use a prefixed IAM action with a suffixed wildcard. For example, the following statement in a policy results in a passed finding. When you group related IAM actions in this way, you can also avoid exceeding the IAM policy size limits."
IAM.22,IAM user credentials unused for 45 days should be removed,CIS AWS Foundations Benchmark v1.4.0/1.12,Protect > Secure access management,Medium,AWS::IAM::User,iam-user-unused-credentials-check,Periodic,None," This control checks whether your IAM users have passwords or active access keys that have not been used for 45 days or more. To do so, it checks whether the   maxCredentialUsageAge   parameter of the AWS Config rule is equal to 45 or more. Users can access AWS resources using different types of credentials, such as passwords or access keys. CIS recommends that you remove or deactivate all credentials that have been unused for 45 days or more. Disabling or removing unnecessary credentials reduces the window of opportunity for credentials associated with a compromised or abandoned account to be used. The AWS Config rule for this control uses the   GetCredentialReport   and   GenerateCredentialReport   API operations, which are only updated every four hours. Changes to IAM users can take up to four hours to be visible to this control."
Kinesis.1,Kinesis streams should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::Kinesis::Stream,kinesis-stream-encrypted,Change triggered,None," This control checks if Kinesis Data Streams are encrypted at rest with server-side encryption. This control fails if a Kinesis stream is not encrypted at rest with server-side encryption. Server-side encryption is a feature in Amazon Kinesis Data Streams that automatically encrypts data before it's at rest by using an AWS KMS key. Data is encrypted before it's written to the Kinesis stream storage layer, and decrypted after it's retrieved from storage. As a result, your data is encrypted at rest within the Amazon Kinesis Data Streams service."
KMS.1,IAM customer managed policies should not allow decryption actions on all KMS keys,"NIST.800-53.r5 AC-2, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-5, NIST.800-53.r5 AC-6, NIST.800-53.r5 AC-6(3)",Protect > Secure access management,Medium,AWS::IAM::Policy,iam-customer-policy-blocked-kms-actions,Change triggered,," The control only checks KMS keys in the Resource element and doesn't take into account any conditionals in the Condition element of a policy. In addition, the control evaluates both attached and unattached customer managed policies. It doesn't check inline policies or AWS managed policies."
KMS.2,IAM principals should not have IAM inline policies that allow decryption actions on all KMS keys,"NIST.800-53.r5 AC-2, NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-5, NIST.800-53.r5 AC-6, NIST.800-53.r5 AC-6(3)",Protect > Secure access management,Medium,,iam-inline-policy-blocked-kms-actions,Change triggered,," The control only checks KMS keys in the Resource element and doesn't take into account any conditionals in the Condition element of a policy. With AWS KMS, you control who can use your KMS keys and gain access to your encrypted data. IAM policies define which actions an identity (user, group, or role) can perform on which resources. Following security best practices, AWS recommends that you allow least privilege. In other words, you should grant to identities only the permissions they need and only for keys that are required to perform a task. Otherwise, the user might use keys that are not appropriate for your data."
KMS.3,AWS KMS keys should not be deleted unintentionally,"NIST.800-53.r5 SC-12, NIST.800-53.r5 SC-12(2)",Protect > Data protection > Data deletion protection,Critical,AWS::KMS::Key,kms-cmk-not-scheduled-for-deletion-2   (custom Security Hub rule),Change triggered,None," This control checks whether KMS keys are scheduled for deletion. The control fails if a KMS key is scheduled for deletion. KMS keys cannot be recovered once deleted. Data encrypted under a KMS key is also permanently unrecoverable if the KMS key is deleted. If meaningful data has been encrypted under a KMS key scheduled for deletion, consider decrypting the data or re-encrypting the data under a new KMS key unless you are intentionally performing a   cryptographic erasure   . When a KMS key is scheduled for deletion, a mandatory waiting period is enforced to allow time to reverse the deletion, if it was scheduled in error. The default waiting period is 30 days, but it can be reduced to as short as 7 days when the KMS key is scheduled for deletion. During the waiting period, the scheduled deletion can be canceled and the KMS key will not be deleted. For additional information regarding deleting KMS keys, see   Deleting KMS keys   in the   AWS Key Management Service Developer Guide   ."
KMS.4,AWS KMS key rotation should be enabled,"PCI DSS v3.2.1/3.6.4, CIS AWS Foundations Benchmark v1.2.0/2.8, CIS AWS Foundations Benchmark v1.4.0/3.8, NIST.800-53.r5 SC-12, NIST.800-53.r5 SC-12(2), NIST.800-53.r5 SC-28(3)",,Medium,AWS::KMS::Key,cmk-backing-key-rotation-enabled,Periodic,None," AWS KMS enables customers to rotate the backing key, which is key material stored in AWS KMS and is tied to the key ID of the KMS key. It's the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all previous backing keys so that decryption of encrypted data can take place transparently. CIS recommends that you enable KMS key rotation. Rotating encryption keys helps reduce the potential impact of a compromised key because data encrypted with a new key can't be accessed with a previous key that might have been exposed."
Lambda.1,Lambda function policies should prohibit public access,"PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.2, PCI DSS v3.2.1/1.3.4, PCI DSS v3.2.1/7.2.1, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,Critical,AWS::Lambda::Function,lambda-function-public-access-prohibited,Change triggered,None," The Lambda function should not be publicly accessible, as this may allow unintended access to your function code."
Lambda.2,Lambda functions should use supported runtimes,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-2(2), NIST.800-53.r5 SI-2(4), NIST.800-53.r5 SI-2(5)",Protect > Secure development,Medium,AWS::Lambda::Function,lambda-function-settings-check,Change triggered,," This control checks that the AWS Lambda function settings for runtimes match the expected values set for the supported runtimes for each language. The control checks function settings for the runtimes noted previously under parameters. The control fails if a Lambda function doesn't use a supported runtime. The AWS Config rule ignores functions that have a package type of   Image   . Lambda runtimes   are built around a combination of operating system, programming language, and software libraries that are subject to maintenance and security updates. When a runtime component is no longer supported for security updates, Lambda deprecates the runtime. Even though you cannot create functions that use the deprecated runtime, the function is still available to process invocation events. Make sure that your Lambda functions are current and do not use out-of-date runtime environments. To learn more about the supported runtimes that this control checks for the supported languages, see   AWS Lambda runtimes   in the   AWS Lambda Developer Guide   ."
Lambda.3,Lambda functions should be in a VPC,"PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.2, PCI DSS v3.2.1/1.3.4, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",,Low,AWS::Lambda::Function,lambda-inside-vpc,Change triggered,None, This control checks whether a Lambda function is in a VPC. You might see failed findings for Lambda@Edge resources. It does not evaluate the VPC subnet routing configuration to determine public reachability.
Lambda.5,VPC Lambda functions should operate in multiple Availability Zones,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High Availability,Medium,AWS::Lambda::Function,lambda-vpc-multi-az-check,Change triggered,," This control checks if an AWS Lambda function that connects to a virtual private cloud (VPC) operates in at least the specified number of Availability Zone (AZs). The control fails if the function doesn't operate in at least the specified number of AZs. Unless you provide a custom parameter value for the minimum number of AZs, Security Hub uses a default value of two AZs. Deploying resources across multiple AZs is an AWS best practice to ensure high availability within your architecture. Availability is a core pillar in the confidentiality, integrity, and availability triad security model. All Lambda functions that connect to a VPC should have a multi-AZ deployment to ensure that a single zone of failure doesn't cause a total disruption of operations."
Macie.1,Macie should be enabled,"NIST.800-53.r5 CA-7, NIST.800-53.r5 CA-9(1), NIST.800-53.r5 RA-5, NIST.800-53.r5 SA-8(19), NIST.800-53.r5 SI-4",Detect > Detection services,Medium,AWS::::Account,macie-status-check,Periodic,," This control checks whether Amazon Macie is enabled for an account. The control fails if Macie isn't enabled for the account. Amazon Macie discovers sensitive data using machine learning and pattern matching, provides visibility into data security risks, and enables automated protection against those risks. Macie automatically and continually evaluates your Amazon Simple Storage Service (Amazon S3) buckets for security and access control, and generates findings to notify you of potential issues with the security or privacy of your Amazon S3 data. Macie also automates discovery and reporting of sensitive data, such as personally identifiable information (PII), to provide you with a better understanding of the data that you store in Amazon S3. To learn more, see the   Amazon Macie User Guide   ."
MSK.1,MSK clusters should be encrypted in transit among broker nodes,"NIST.800-53.r5 AC-4, NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2)",Protect > Data protection > Encryption of data-in-transit,Medium,AWS::MSK::Cluster,msk-in-cluster-node-require-tls,Change triggered,None," This controls checks if an Amazon MSK cluster is encrypted in transit with HTTPS (TLS) among the broker nodes of the cluster. The control fails if plain text communication is enabled for a cluster broker node connection. HTTPS offers an extra layer of security as it uses TLS to move data and can be used to help prevent potential attackers from using person-in-the-middle or similar attacks to eavesdrop on or manipulate network traffic. By default, Amazon MSK encrypts data in transit with TLS. However, you can override this default at the time that you create the cluster. We recommend using encrypted connections over HTTPS (TLS) for-broker node connections."
MSK.2,MSK clusters should have enhanced monitoring configured,"NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-2",Detect > Detection services,Low,AWS::MSK::Cluster,msk-enhanced-monitoring-enabled,Change triggered,None," This control checks whether an Amazon MSK cluster has enhanced monitoring configured, specified by a monitoring level of at least   PER_TOPIC_PER_BROKER   . The control fails if the monitoring level for the cluster is set to   DEFAULT   or   PER_BROKER   . The   PER_TOPIC_PER_BROKER   monitoring level provides more granular insights into the performance of your MSK cluster, and also provides metrics related to resource utilization, such as CPU and memory usage. This helps you identify performance bottlenecks and resource utilization patterns for individual topics and brokers. This visibility, in turn, can optimize the performance of your Kafka brokers."
MQ.5,ActiveMQ brokers should use active/standby deployment mode,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5",Recover > Resilience > High availability,Low,AWS::AmazonMQ::Broker,mq-active-deployment-mode,Change triggered,None," This control checks whether the deployment mode for an Amazon MQ ActiveMQ broker is set to active/standby. The control fails if a single-instance broker (enabled by default) is set as the deployment mode. Active/standby deployment provides high availability for your Amazon MQ ActiveMQ brokers in an AWS Region. The active/standby deployment mode includes two broker instances in two different Availability Zones, configured in a redundant pair. These brokers communicate synchronously with your application, which can reduce downtime and loss of data in the event of a failure."
MQ.6,RabbitMQ brokers should use cluster deployment mode,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5",Recover > Resilience > High availability,Low,AWS::AmazonMQ::Broker,mq-rabbit-deployment-mode,Change triggered,None," This control checks whether the deployment mode for an Amazon MQ RabbitMQ broker is set to cluster deployment. The control fails if a single-instance broker (enabled by default) is set as the deployment mode. Cluster deployment provides high availability for your Amazon MQ RabbitMQ brokers in an AWS Region. The cluster deployment is a logical grouping of three RabbitMQ broker nodes, each with its own Amazon Elastic Block Store (Amazon EBS) volume and a shared state. The cluster deployment ensures that data is replicated to all nodes in the cluster, which can reduce downtime and loss of data in the event of a failure."
Neptune.1,Neptune DB clusters should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::RDS::DBCluster,neptune-cluster-encrypted,Periodic,None," This control checks whether a Neptune DB cluster is encrypted at rest. The control fails if a Neptune DB cluster isn't encrypted at rest. Data at rest refers to any data that's stored in persistent, non-volatile storage for any duration. Encryption helps you protect the confidentiality of such data, reducing the risk that an unauthorized user can access it. Encrypting your Neptune DB clusters protects your data and metadata against unauthorized access. It also fulfills compliance requirements for data-at-rest encryption of production file systems."
Neptune.2,Neptune DB clusters should publish audit logs to CloudWatch Logs,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(1), NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 AU-6(5), NIST.800-53.r5 AU-7(1), NIST.800-53.r5 AU-9(7), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-20, NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-4(5), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::RDS::DBCluster,neptune-cluster-cloudwatch-log-export-enabled,Periodic,None," This control checks whether a Neptune DB cluster publishes audit logs to Amazon CloudWatch Logs. The control fails if a Neptune DB cluster doesn't publish audit logs to CloudWatch Logs.   EnableCloudWatchLogsExport   should be set to   Audit   . Amazon Neptune and Amazon CloudWatch are integrated so that you can gather and analyze performance metrics. Neptune automatically sends metrics to CloudWatch and also supports CloudWatch Alarms. Audit logs are highly customizable. When you audit a database, each operation on the data can be monitored and logged to an audit trail, including information about which database cluster is accessed and how. We recommend sending these logs to CloudWatch to help you monitor your Neptune DB clusters."
Neptune.3,Neptune DB cluster snapshots should not be public,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > Resources not publicly accessible,Critical,AWS::RDS::DBClusterSnapshot,neptune-cluster-snapshot-public-prohibited,Change triggered,None," This control checks whether a Neptune manual DB cluster snapshot is public. The control fails if a Neptune manual DB cluster snapshot is public. A Neptune DB cluster manual snapshot should not be public unless intended. If you share an unencrypted manual snapshot as public, the snapshot is available to all AWS accounts. Public snapshots may result in unintended data exposure."
Neptune.4,Neptune DB clusters should have deletion protection enabled,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2), NIST.800-53.r5 CM-3, NIST.800-53.r5 SC-5(2)",Protect > Data protection > Data deletion protection,Low,AWS::RDS::DBCluster,neptune-cluster-deletion-protection-enabled,Change triggered,None, This control checks if a Neptune DB cluster has deletion protection enabled. The control fails if a Neptune DB cluster doesn't have deletion protection enabled. Enabling cluster deletion protection offers an additional layer of protection against accidental database deletion or deletion by an unauthorized user. A Neptune DB cluster can't be deleted while deletion protection is enabled. You must first disable deletion protection before a delete request can succeed.
Neptune.5,Neptune DB clusters should have automated backups enabled,NIST.800-53.r5 SI-12,Recover > Resilience > Backups enabled,Medium,AWS::RDS::DBCluster,neptune-cluster-backup-retention-check,Change triggered,," This control checks whether a Neptune DB cluster has automated backups enabled, and a backup retention period greater than or equal to the specified time frame. The control fails if backups aren't enabled for the Neptune DB cluster, or if the retention period is less than the specified time frame. Unless you provide a custom parameter value for the backup retention period, Security Hub uses a default value of 7 days. Backups help you recover more quickly from a security incident and strengthen the resilience of your systems. By automating backups for your Neptune DB clusters, you'll be able to restore your systems to a point in time and minimize downtime and data loss."
Neptune.6,Neptune DB cluster snapshots should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SC-7(18)",Protect > Data protection > Encryption of data at rest,Medium,AWS::RDS::DBClusterSnapshot,neptune-cluster-snapshot-encrypted,Change triggered,None," This control checks whether a Neptune DB cluster snapshot is encrypted at rest. The control fails if a Neptune DB cluster isn't encrypted at rest. Data at rest refers to any data that's stored in persistent, non-volatile storage for any duration. Encryption helps you protect the confidentiality of such data, reducing the risk that an unauthorized user gets access to it. Data in Neptune DB clusters snapshots should be encrypted at rest for an added layer of security."
Neptune.7,Neptune DB clusters should have IAM database authentication enabled,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6",Protect > Secure access management > Passwordless authentication,Medium,AWS::RDS::DBCluster,neptune-cluster-iam-database-authentication,Change triggered,None," This control checks if a Neptune DB cluster has IAM database authentication enabled. The control fails if IAM database authentication isn't enabled for a Neptune DB cluster. IAM database authentication for Amazon Neptune database clusters removes the need to store user credentials within the database configuration because authentication is managed externally using IAM. When IAM database authentication is enabled, each request needs to be signed using AWS Signature Version 4."
Neptune.8,Neptune DB clusters should be configured to copy tags to snapshots,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Identify > Inventory > Tagging,Low,AWS::RDS::DBCluster,neptune-cluster-copy-tags-to-snapshot-enabled,Change triggered,None," This control checks if a Neptune DB cluster is configured to copy all tags to snapshots when the snapshots are created. The control fails if a Neptune DB cluster isn't configured to copy tags to snapshots. Identification and inventory of your IT assets is a crucial aspect of governance and security. You should tag snapshots in the same way as their parent Amazon RDS database clusters. Copying tags ensures that the metadata for the DB snapshots matches that of the parent database clusters, and that access policies for the DB snapshot also match those of the parent DB instance."
Neptune.9,Neptune DB clusters should be deployed across multiple Availability Zones,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Medium,AWS::RDS::DBCluster,neptune-cluster-multi-az-enabled,Change triggered,None," This control checks if an Amazon Neptune DB cluster has read-replica instances in multiple Availability Zones (AZs). The control fails if the cluster is deployed in only one AZ. If an AZ is unavailable and during regular maintenance events, read-replicas serve as failover targets for the primary instance. That is, if the primary instance fails, Neptune promotes a read-replica instance to become the primary instance. By contrast, if your DB cluster doesn't include any read-replica instances, your DB cluster remains unavailable when the primary instance fails until it has been re-created. Re-creating the primary instance takes considerably longer than promoting a read-replica. To ensure high availability, we recommend that you create one or more read-replica instances that have the same DB instance class as the primary instance and are located in different AZs than the primary instance."
NetworkFirewall.1,Network Firewall firewalls should be deployed across multiple Availability Zones,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Medium,AWS::NetworkFirewall::Firewall,netfw-multi-az-enabled,Change triggered,None," This control evaluates whether a firewall managed through AWS Network Firewall is deployed across multiple Availability Zones (AZs). The control fails if a firewall is deployed in only one AZ. AWS global infrastructure includes multiple AWS Regions. AZs are physically separated, isolated locations within each Region that are connected by low-latency, high-throughput, and highly redundant networking. By deploying a Network Firewall firewall across multiple AZs, you can balance and shift traffic among AZs, which helps you design highly available solutions."
NetworkFirewall.2,Network Firewall logging should be enabled,"NIST.800-53.r5 AC-2(12), NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 AU-9(7), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4, NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::NetworkFirewall::LoggingConfiguration,netfw-logging-enabled,Periodic,None," This control checks whether logging is enabled for an AWS Network Firewall firewall. The control fails if logging isn't enabled for at least one log type or if the logging destination doesn't exist. Logging helps you maintain the reliability, availability, and performance of your firewalls. In Network Firewall, logging gives you detailed information about network traffic, including the time that the stateful engine received a packet flow, detailed information about the packet flow, and any stateful rule action taken against the packet flow."
NetworkFirewall.3,Network Firewall policies should have at least one rule group associated,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure Network Configuration,Medium,AWS::NetworkFirewall::FirewallPolicy,netfw-policy-rule-group-associated,Change triggered,None," This control checks whether a Network Firewall policy has any stateful or stateless rule groups associated. The control fails if stateless or stateful rule groups are not assigned. A firewall policy defines how your firewall monitors and handles traffic in Amazon Virtual Private Cloud (Amazon VPC). Configuration of stateless and stateful rule groups helps to filter packets and traffic flows, and defines default traffic handling."
NetworkFirewall.4,The default stateless action for Network Firewall policies should be drop or forward for full packets,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure Network Configuration,Medium,AWS::NetworkFirewall::FirewallPolicy,netfw-policy-default-action-full-packets,Change triggered,," This control checks whether the default stateless action for full packets for a Network Firewall policy is drop or forward. The control passes if   Drop   or   Forward   is selected, and fails if   Pass   is selected. A firewall policy defines how your firewall monitors and handles traffic in Amazon VPC. You configure stateless and stateful rule groups to filter packets and traffic flows. Defaulting to   Pass   can allow unintended traffic."
NetworkFirewall.5,The default stateless action for Network Firewall policies should be drop or forward for fragmented packets,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure Network Configuration,Medium,AWS::NetworkFirewall::FirewallPolicy,netfw-policy-default-action-fragment-packets,Change triggered,," This control checks whether the default stateless action for fragmented packets for a Network Firewall policy is drop or forward. The control passes if   Drop   or   Forward   is selected, and fails if   Pass   is selected. A firewall policy defines how your firewall monitors and handles traffic in Amazon VPC. You configure stateless and stateful rule groups to filter packets and traffic flows. Defaulting to   Pass   can allow unintended traffic."
NetworkFirewall.6,Stateless Network Firewall rule group should not be empty,"NIST.800-53.r5 AC-4(21), NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(5)",Protect > Secure Network Configuration,Medium,AWS::NetworkFirewall::RuleGroup,netfw-stateless-rule-group-not-empty,Change triggered,None," This control checks if a stateless rule group in AWS Network Firewall contains rules. The control fails if there are no rules in the rule group. A rule group contains rules that define how your firewall processes traffic in your VPC. An empty stateless rule group, when present in a firewall policy, might give the impression that the rule group will process traffic. However, when the stateless rule group is empty, it does not process traffic."
NetworkFirewall.9,Network Firewall firewalls should have deletion protection enabled,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2), NIST.800-53.r5 CM-3, NIST.800-53.r5 SC-5(2)",Protect > Network security > High availability,Medium,AWS::NetworkFirewall::Firewall,netfw-deletion-protection-enabled,Change triggered,None," This control checks whether an AWS Network Firewall firewall has deletion protection enabled. The control fails if deletion protection isn't enabled for a firewall. AWS Network Firewall is a stateful, managed network firewall and intrusion detection service that enables you to inspect and filter traffic to, from, or between your Virtual Private Clouds (VPCs). The deletion protection setting protects against accidental deletion of the firewall."
Opensearch.1,OpenSearch domains should have encryption at rest enabled,"PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.4, PCI DSS v3.2.1/7.2.1, NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::OpenSearch::Domain,opensearch-encrypted-at-rest,Change triggered,None," This control checks whether OpenSearch domains have encryption-at-rest configuration enabled. The check fails if encryption at rest is not enabled. For an added layer of security for sensitive data, you should configure your OpenSearch Service domain to be encrypted at rest. When you configure encryption of data at rest, AWS KMS stores and manages your encryption keys. To perform the encryption, AWS KMS uses the Advanced Encryption Standard algorithm with 256-bit keys (AES-256). To learn more about OpenSearch Service encryption at rest, see   Encryption of data at rest for Amazon OpenSearch Service   in the   Amazon OpenSearch Service      Developer Guide   ."
Opensearch.2,OpenSearch domains should not be publicly accessible,"PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.2, PCI DSS v3.2.1/1.3.4, PCI DSS v3.2.1/1.3.6, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > Resources within VPC,Critical,AWS::OpenSearch::Domain,opensearch-in-vpc-only,Change triggered,None," This control checks whether OpenSearch domains are in a VPC. It does not evaluate the VPC subnet routing configuration to determine public access. You should ensure that OpenSearch domains are not attached to public subnets. See   Resource-based policies   in the Amazon OpenSearch Service Developer Guide. You should also ensure that your VPC is configured according to the recommended best practices. See   Security best practices for your VPC   in the Amazon VPC User Guide. OpenSearch domains deployed within a VPC can communicate with VPC resources over the private AWS network, without the need to traverse the public internet. This configuration increases the security posture by limiting access to the data in transit. VPCs provide a number of network controls to secure access to OpenSearch domains, including network ACL and security groups. Security Hub recommends that you migrate public OpenSearch domains to VPCs to take advantage of these controls."
Opensearch.3,OpenSearch domains should encrypt data sent between nodes,"NIST.800-53.r5 AC-4, NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2)",Protect > Data protection > Encryption of data in transit,Medium,AWS::OpenSearch::Domain,opensearch-node-to-node-encryption-check,Change triggered,None, This control checks whether OpenSearch domains have node-to-node encryption enabled. This control fails if node-to-node encryption is disabled on the domain. HTTPS (TLS) can be used to help prevent potential attackers from eavesdropping on or manipulating network traffic using person-in-the-middle or similar attacks. Only encrypted connections over HTTPS (TLS) should be allowed. Enabling node-to-node encryption for OpenSearch domains ensures that intra-cluster communications are encrypted in transit. There can be a performance penalty associated with this configuration. You should be aware of and test the performance trade-off before enabling this option.
Opensearch.4,OpenSearch domain error logging to CloudWatch Logs should be enabled,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::OpenSearch::Domain,opensearch-logs-to-cloudwatch,Change triggered,," This control checks whether OpenSearch domains are configured to send error logs to CloudWatch Logs. This control fails if error logging to CloudWatch is not enabled for a domain. You should enable error logs for OpenSearch domains and send those logs to CloudWatch Logs for retention and response. Domain error logs can assist with security and access audits, and can help to diagnose availability issues."
Opensearch.5,OpenSearch domains should have audit logging enabled,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::OpenSearch::Domain,opensearch-audit-logging-enabled,Change triggered,," This rule is   NON_COMPLIANT   if the CloudWatch Logs log group of the OpenSearch domain is not specified in this parameter list. This control checks whether OpenSearch domains have audit logging enabled. This control fails if an OpenSearch domain does not have audit logging enabled. Audit logs are highly customizable. They allow you to track user activity on your OpenSearch clusters, including authentication successes and failures, requests to OpenSearch, index changes, and incoming search queries."
Opensearch.6,OpenSearch domains should have at least three data nodes,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Medium,AWS::OpenSearch::Domain,opensearch-data-node-fault-tolerance,Change triggered,None, This control checks whether OpenSearch domains are configured with at least three data nodes and   zoneAwarenessEnabled   is   true   . This control fails for an OpenSearch domain if   instanceCount   is less than 3 or   zoneAwarenessEnabled   is   false   . An OpenSearch domain requires at least three data nodes for high availability and fault-tolerance. Deploying an OpenSearch domain with at least three data nodes ensures cluster operations if a node fails.
Opensearch.7,OpenSearch domains should have fine-grained access control enabled,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-5, NIST.800-53.r5 AC-6",Protect > Secure Access Management > Sensitive API actions restricted,High,AWS::OpenSearch::Domain,opensearch-access-control-enabled,Change triggered,None, This control checks whether OpenSearch domains have fine-grained access control enabled. The control fails if the fine-grained access control is not enabled. Fine-grained access control requires   advanced-security-options   in the OpenSearch parameter   update-domain-config   to be enabled. Fine-grained access control offers additional ways of controlling access to your data on Amazon OpenSearch Service.
Opensearch.8,Connections to OpenSearch domains should be encrypted using TLS 1.2,"NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data-in-transit,Medium,AWS::OpenSearch::Domain,opensearch-https-required,Change triggered,, This control checks whether connections to OpenSearch domains are required to use TLS 1.2. The check fails if the OpenSearch domain   TLSSecurityPolicy   is not   Policy-Min-TLS-1-2-2019-07   . HTTPS (TLS) can be used to help prevent potential attackers from using person-in-the-middle or similar attacks to eavesdrop on or manipulate network traffic. Only encrypted connections over HTTPS (TLS) should be allowed. Encrypting data in transit can affect performance. You should test your application with this feature to understand the performance profile and the impact of TLS. TLS 1.2 provides several security enhancements over previous versions of TLS.
Opensearch.10,OpenSearch domains should have the latest software update installed,"NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-2(2), NIST.800-53.r5 SI-2(4), NIST.800-53.r5 SI-2(5)","Detect > Vulnerability, patch, and version management",Low,AWS::OpenSearch::Domain,opensearch-update-check,Change triggered,None," This control checks whether an Amazon OpenSearch Service domain has the latest software update installed. The control fails if a software update is available but not installed for the domain. OpenSearch Service software updates provide the latest platform fixes, updates, and features available for the environment. Keeping up-to-date with patch installation helps maintain domain security and availability. If no action is taken on required updates, the service software is updated automatically (typically after 2 weeks). We recommend scheduling updates during a time of low traffic to the domain to minimize service disruption."
PCA.1,AWS Private CA root certificate authority should be disabled,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure network configuration,Low,AWS::ACMPCA::CertificateAuthority,acm-pca-root-ca-disabled,Periodic,None," This control checks if AWS Private CA has a root certificate authority (CA) that is disabled. The control fails if the root CA is enabled. With AWS Private CA, you can create a CA hierarchy that includes a root CA and subordinate CAs. You should minimize the use of the root CA for daily tasks, especially in production environments. The root CA should only be used to issue certificates for intermediate CAs. This allows the root CA to be stored out of harm's way while the intermediate CAs perform the daily task of issuing end-entity certificates."
RDS.1,RDS snapshot should be private,"PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.4, PCI DSS v3.2.1/1.3.6, PCI DSS v3.2.1/7.2.1, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,Critical,"AWS::RDS::DBClusterSnapshot   ,   AWS::RDS::DBSnapshot",rds-snapshots-public-prohibited,Change triggered,None," This control checks whether Amazon RDS snapshots are public. The control fails if RDS snapshots are public. This control evaluates RDS instances, Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters. RDS snapshots are used to back up the data on your RDS instances at a specific point in time. They can be used to restore previous states of RDS instances. An RDS snapshot must not be public unless intended. If you share an unencrypted manual snapshot as public, this makes the snapshot available to all AWS accounts. This may result in unintended data exposure of your RDS instance. Note that if the configuration is changed to allow public access, the AWS Config rule may not be able to detect the change for up to 12 hours. Until the AWS Config rule detects the change, the check passes even though the configuration violates the rule. To learn more about sharing a DB snapshot, see   Sharing a DB snapshot   in the   Amazon RDS User Guide   ."
RDS.2,"RDS DB Instances should prohibit public access, as determined by the PubliclyAccessible AWS Configuration","PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.2, PCI DSS v3.2.1/1.3.4, PCI DSS v3.2.1/1.3.6, PCI DSS v3.2.1/7.2.1, NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(5)",Protect > Secure network configuration,Critical,AWS::RDS::DBInstance,rds-instance-public-access-check,Change triggered,None," This control checks whether Amazon RDS instances are publicly accessible by evaluating the   PubliclyAccessible   field in the instance configuration item. Neptune DB instances and Amazon DocumentDB clusters do not have the   PubliclyAccessible   flag and cannot be evaluated. However, this control can still generate findings for these resources. You can suppress these findings. The   PubliclyAccessible   value in the RDS instance configuration indicates whether the DB instance is publicly accessible. When the DB instance is configured with   PubliclyAccessible   , it is an Internet-facing instance with a publicly resolvable DNS name, which resolves to a public IP address. When the DB instance isn't publicly accessible, it is an internal instance with a DNS name that resolves to a private IP address. Unless you intend for your RDS instance to be publicly accessible, the RDS instance should not be configured with   PubliclyAccessible   value. Doing so might allow unnecessary traffic to your database instance."
RDS.3,RDS DB instances should have encryption at-rest enabled,"CIS AWS Foundations Benchmark v1.4.0/2.3.1, NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::RDS::DBInstance,rds-storage-encrypted,Change triggered,None," This control checks whether storage encryption is enabled for your Amazon RDS DB instances. This control is intended for RDS DB instances. However, it can also generate findings for Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters. If these findings are not useful, then you can suppress them. For an added layer of security for your sensitive data in RDS DB instances, you should configure your RDS DB instances to be encrypted at rest. To encrypt your RDS DB instances and snapshots at rest, enable the encryption option for your RDS DB instances. Data that is encrypted at rest includes the underlying storage for DB instances, its automated backups, read replicas, and snapshots. RDS encrypted DB instances use the open standard AES-256 encryption algorithm to encrypt your data on the server that hosts your RDS DB instances. After your data is encrypted, Amazon RDS handles authentication of access and decryption of your data transparently with a minimal impact on performance. You do not need to modify your database client applications to use encryption. Amazon RDS encryption is currently available for all database engines and storage types. Amazon RDS encryption is available for most DB instance classes. To learn about DB instance classes that do not support Amazon RDS encryption, see   Encrypting Amazon RDS resources   in the   Amazon RDS User Guide   ."
RDS.4,RDS cluster snapshots and database snapshots should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,"AWS::RDS::DBClusterSnapshot   ,    AWS::RDS::DBSnapshot",rds-snapshot-encrypted,Change triggered,None," This control checks whether an RDS DB snapshot is encrypted. The control fails if an RDS DB snapshot isn't encrypted. This control is intended for RDS DB instances. However, it can also generate findings for snapshots of Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters. If these findings are not useful, then you can suppress them. Encrypting data at rest reduces the risk that an unauthenticated user gets access to data that is stored on disk. Data in RDS snapshots should be encrypted at rest for an added layer of security."
RDS.5,RDS DB instances should be configured with multiple Availability Zones,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Medium,AWS::RDS::DBInstance,rds-multi-az-support,Change triggered,None, This control checks whether high availability is enabled for your RDS DB instances. RDS DB instances should be configured for multiple Availability Zones (AZs). This ensures the availability of the data stored. Multi-AZ deployments allow for automated failover if there is an issue with AZ availability and during regular RDS maintenance.
RDS.6,Enhanced monitoring should be configured for RDS DB instances,"NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-2",Detect > Detection services,Low,AWS::RDS::DBInstance,rds-enhanced-monitoring-enabled,Change triggered,," This control checks whether enhanced monitoring is enabled for an Amazon Relational Database Service (Amazon RDS) DB instance. The control fails if enhanced monitoring isn't enabled for the instance. If you provide a custom value for the   monitoringInterval   parameter, the control passes only if enhanced monitoring metrics are collected for the instance at the specified interval. In Amazon RDS, Enhanced Monitoring enables a more rapid response to performance changes in underlying infrastructure. These performance changes could result in a lack of availability of the data. Enhanced Monitoring provides real-time metrics of the operating system that your RDS DB instance runs on. An agent is installed on the instance. The agent can obtain metrics more accurately than is possible from the hypervisor layer. Enhanced Monitoring metrics are useful when you want to see how different processes or threads on a DB instance use the CPU. For more information, see   Enhanced Monitoring   in the   Amazon RDS User Guide   ."
RDS.7,RDS clusters should have deletion protection enabled,"NIST.800-53.r5 CM-3, NIST.800-53.r5 SC-5(2)",Protect > Data protection > Data deletion protection,Low,AWS::RDS::DBCluster,rds-cluster-deletion-protection-enabled,Change triggered,None," This control checks whether an RDS DB cluster has deletion protection enabled. The control fails if an RDS DB cluster doesn't have deletion protection enabled. This control is intended for RDS DB instances. However, it can also generate findings for Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters. If these findings are not useful, then you can suppress them. Enabling cluster deletion protection is an additional layer of protection against accidental database deletion or deletion by an unauthorized entity. When deletion protection is enabled, an RDS cluster cannot be deleted. Before a deletion request can succeed, deletion protection must be disabled."
RDS.8,RDS DB instances should have deletion protection enabled,"NIST.800-53.r5 CM-3, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Protect > Data protection > Data deletion protection,Low,AWS::RDS::DBInstance,rds-instance-deletion-protection-enabled,Change triggered,," This control checks whether your RDS DB instances that use one of the listed database engines have deletion protection enabled. The control fails if an RDS DB instance doesn't have deletion protection enabled. Enabling instance deletion protection is an additional layer of protection against accidental database deletion or deletion by an unauthorized entity. While deletion protection is enabled, an RDS DB instance cannot be deleted. Before a deletion request can succeed, deletion protection must be disabled."
RDS.9,RDS DB instances should publish logs to CloudWatch Logs,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::RDS::DBInstance,rds-logging-enabled,Change triggered,None, RDS databases should have relevant logs enabled. Database logging provides detailed records of requests made to RDS. Database logs can assist with security and access audits and can help to diagnose availability issues.
RDS.10,IAM authentication should be configured for RDS instances,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6",Protect > Secure access management > Passwordless authentication,Medium,AWS::RDS::DBInstance,rds-instance-iam-authentication-enabled,Change triggered,None," IAM database authentication allows authentication to database instances with an authentication token instead of a password. Network traffic to and from the database is encrypted using SSL. For more information, see   IAM database authentication   in the   Amazon Aurora User Guide   ."
RDS.11,RDS instances should have automatic backups enabled,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6, NIST.800-53.r5 CP-6(1), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-12, NIST.800-53.r5 SI-13(5)",Recover > Resilience > Backups enabled,Medium,AWS::RDS::DBInstance,db-instance-backup-enabled,Change triggered,," This control checks whether an Amazon Relational Database Service instance has automated backups enabled, and a backup retention period greater than or equal to the specified time frame. Read replicas are excluded from evaluation. The control fails if backups aren't enabled for the instance, or if the retention period is less than the specified time frame. Unless you provide a custom parameter value for the backup retention period, Security Hub uses a default value of 7 days. Backups help you more quickly recover from a security incident and strengthens the resilience of your systems. Amazon RDS lets you configure daily full instance volume snapshots. For more information about Amazon RDS automated backups, see   Working with Backups   in the   Amazon RDS User Guide   ."
RDS.12,IAM authentication should be configured for RDS clusters,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6",Protect > Secure access management > Passwordless authentication,Medium,AWS::RDS::DBCluster,rds-cluster-iam-authentication-enabled,Change triggered,None," This control checks whether an Amazon RDS DB cluster has IAM database authentication enabled. IAM database authentication allows for password-free authentication to database instances. The authentication uses an authentication token. Network traffic to and from the database is encrypted using SSL. For more information, see   IAM database authentication   in the   Amazon Aurora User Guide   ."
RDS.13,RDS automatic minor version upgrades should be enabled,"NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-2(2), NIST.800-53.r5 SI-2(4), NIST.800-53.r5 SI-2(5)",Detect > Vulnerability and patch management,High,AWS::RDS::DBInstance,rds-automatic-minor-version-upgrade-enabled,Change triggered,None, This control checks whether automatic minor version upgrades are enabled for the RDS database instance. Enabling automatic minor version upgrades ensures that the latest minor version updates to the relational database management system (RDBMS) are installed. These upgrades might include security patches and bug fixes. Keeping up to date with patch installation is an important step in securing systems.
RDS.14,Amazon Aurora clusters should have backtracking enabled,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6, NIST.800-53.r5 CP-6(1), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SI-13(5)",Recover > Resilience > Backups enabled,Medium,AWS::RDS::DBCluster,aurora-mysql-backtracking-enabled,Change triggered,," This control checks whether an Amazon Aurora cluster has backtracking enabled. The control fails if the cluster doesn't have backtracking enabled. If you provide a custom value for the   BacktrackWindowInHours   parameter, the control passes only if the cluster is backtracked for the specified length of time. Backups help you to recover more quickly from a security incident. They also strengthens the resilience of your systems. Aurora backtracking reduces the time to recover a database to a point in time. It does not require a database restore to do so."
RDS.15,RDS DB clusters should be configured for multiple Availability Zones,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 SC-36, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Recover > Resilience > High availability,Medium,AWS::RDS::DBCluster,rds-cluster-multi-az-enabled,Change triggered,None, This control checks whether high availability is enabled for your RDS DB clusters. The control fails if an RDS DB cluster isn't deployed in multiple Availability Zones (AZs). RDS DB clusters should be configured for multiple AZs to ensure availability of stored data. Deployment to multiple AZs allows for automated failover in the event of an AZ availability issue and during regular RDS maintenance events.
RDS.16,RDS DB clusters should be configured to copy tags to snapshots,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Identify > Inventory,Low,AWS::RDS::DBCluster,rds-cluster-copy-tags-to-snapshots-enabled   (custom Security Hub rule),Change triggered,None, This control checks whether RDS DB clusters are configured to copy all tags to snapshots when the snapshots are created. Identification and inventory of your IT assets is a crucial aspect of governance and security. You need to have visibility of all your RDS DB clusters so that you can assess their security posture and take action on potential areas of weakness. Snapshots should be tagged in the same way as their parent RDS database clusters. Enabling this setting ensures that snapshots inherit the tags of their parent database clusters.
RDS.17,RDS DB instances should be configured to copy tags to snapshots,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2)",Identify > Inventory,Low,AWS::RDS::DBInstance,rds-instance-copy-tags-to-snapshots-enabled   (custom Security Hub rule),Change triggered,None, This control checks whether RDS DB instances are configured to copy all tags to snapshots when the snapshots are created. Identification and inventory of your IT assets is a crucial aspect of governance and security. You need to have visibility of all your RDS DB instances so that you can assess their security posture and take action on potential areas of weakness. Snapshots should be tagged in the same way as their parent RDS database instances. Enabling this setting ensures that snapshots inherit the tags of their parent database instances.
RDS.18,RDS instances should be deployed in a VPC,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > Resources within VPC,High,AWS::RDS::DBInstance,rds-deployed-in-vpc   (custom Security Hub rule),Change triggered,None," This control checks whether an Amazon RDS instance is deployed on an EC2-VPC. VPCs provide a number of network controls to secure access to RDS resources. These controls include VPC Endpoints, network ACLs, and security groups. To take advantage of these controls, we recommend that you create your RDS instances on an EC2-VPC."
RDS.19,Existing RDS event notification subscriptions should be configured for critical cluster events,"NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-2",Detect > Detection services > Application monitoring,Low,AWS::RDS::EventSubscription,rds-cluster-event-notifications-configured   (custom Security Hub rule),Change triggered,None," The control passes if there are no existing event subscriptions in your account. RDS event notifications uses Amazon SNS to make you aware of changes in the availability or configuration of your RDS resources. These notifications allow for rapid response. For additional information about RDS event notifications, see   Using Amazon RDS event notification   in the   Amazon RDS User Guide   ."
RDS.20,Existing RDS event notification subscriptions should be configured for critical database instance events,"NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-2",Detect > Detection services > Application monitoring,Low,AWS::RDS::EventSubscription,rds-instance-event-notifications-configured   (custom Security Hub rule),Change triggered,None," The control passes if there are no existing event subscriptions in your account. RDS event notifications use Amazon SNS to make you aware of changes in the availability or configuration of your RDS resources. These notifications allow for rapid response. For additional information about RDS event notifications, see   Using Amazon RDS event notification   in the   Amazon RDS User Guide   ."
RDS.21,An RDS event notifications subscription should be configured for critical database parameter group events,"NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-2",Detect > Detection services > Application monitoring,Low,AWS::RDS::EventSubscription,rds-pg-event-notifications-configured   (custom Security Hub rule),Change triggered,None," This control checks whether an Amazon RDS event subscription exists with notifications enabled for the following source type, event category key-value pairs. RDS event notifications use Amazon SNS to make you aware of changes in the availability or configuration of your RDS resources. These notifications allow for rapid response. For additional information about RDS event notifications, see   Using Amazon RDS event notification   in the   Amazon RDS User Guide   ."
RDS.22,An RDS event notifications subscription should be configured for critical database security group events,"NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-2",Detect > Detection Services > Application monitoring,Low,AWS::RDS::EventSubscription,rds-sg-event-notifications-configured   (custom Security Hub rule),Change triggered,None," This control checks whether an Amazon RDS event subscription exists with notifications enabled for the following source type, event category key-value pairs. RDS event notifications use Amazon SNS to make you aware of changes in the availability or configuration of your RDS resources. These notifications allow for a rapid response. For additional information about RDS event notifications, see   Using Amazon RDS event notification   in the   Amazon RDS User Guide   ."
RDS.23,RDS instances should not use a database engine default port,"NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(5)",Protect > Secure network configuration,Low,AWS::RDS::DBInstance,rds-no-default-ports   (custom Security Hub rule),Change triggered,None," This control checks whether an RDS cluster or instance uses a port other than the default port of the database engine. The control fails if the RDS cluster or instance uses the default port. If you use a known port to deploy an RDS cluster or instance, an attacker can guess information about the cluster or instance. The attacker can use this information in conjunction with other information to connect to an RDS cluster or instance or gain additional information about your application. When you change the port, you must also update the existing connection strings that were used to connect to the old port. You should also check the security group of the DB instance to ensure that it includes an ingress rule that allows connectivity on the new port."
RDS.24,RDS Database clusters should use a custom administrator username,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Identify > Resource Configuration,Medium,AWS::RDS::DBCluster,rds-cluster-default-admin-check,Change triggered,None," This control checks whether an Amazon RDS database cluster has changed the admin username from its default value. The control does not apply to engines of the type neptune (Neptune DB) or docdb (DocumentDB). This rule will fail if the admin username is set to the default value. When creating an Amazon RDS database, you should change the default admin username to a unique value. Default usernames are public knowledge and should be changed during RDS database creation. Changing the default usernames reduces the risk of unintended access."
RDS.25,RDS database instances should use a custom administrator username,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Identify > Resource Configuration,Medium,AWS::RDS::DBInstance,rds-instance-default-admin-check,Change triggered,None," This control checks whether you've changed the administrative username for Amazon Relational Database Service (Amazon RDS) database instances from the default value. The control does not apply to engines of the type neptune (Neptune DB) or docdb (DocumentDB). The control fails if the administrative username is set to the default value. Default administrative usernames on Amazon RDS databases are public knowledge. When creating an Amazon RDS database, you should change the default administrative username to a unique value to reduce the risk of unintended access."
RDS.26,RDS DB instances should be protected by a backup plan,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6, NIST.800-53.r5 CP-6(1), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-12, NIST.800-53.r5 SI-13(5)",Recover > Resilience > Backups enabled,Medium,AWS::RDS::DBInstance,rds-resources-protected-by-backup-plan,Periodic,," This control evaluates if Amazon RDS DB instances are covered by a backup plan. This control fails if the RDS DB instance isn't covered by a backup plan. If you set the   backupVaultLockCheck   parameter equal to   true   , the control passes only if the instance is backed up in an AWS Backup locked vault. AWS Backup is a fully managed backup service that centralizes and automates the backing up of data across AWS services. With AWS Backup, you can create backup policies called backup plans. You can use these plans to define your backup requirements, such as how frequently to back up your data and how long to retain those backups. Including RDS DB instances in a backup plan helps you protect your data from unintended loss or deletion."
RDS.27,RDS DB clusters should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::RDS::DBCluster,rds-cluster-encrypted-at-rest,Change triggered,None," This control checks if an RDS DB cluster is encrypted at rest. The control fails if an RDS DB cluster isn't encrypted at rest. Data at rest refers to any data that's stored in persistent, non-volatile storage for any duration. Encryption helps you protect the confidentiality of such data, reducing the risk that an unauthorized user can access it. Encrypting your RDS DB clusters protects your data and metadata against unauthorized access. It also fulfills compliance requirements for data-at-rest encryption of production file systems."
RDS.34,Aurora MySQL DB clusters should publish audit logs to CloudWatch Logs,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::RDS::DBCluster,rds-aurora-mysql-audit-logging-enabled,Change triggered,None," This control checks whether an Amazon Aurora MySQL DB cluster is configured to publish audit logs to Amazon CloudWatch Logs. The control fails if the cluster isn't configured to publish audit logs to CloudWatch Logs. Audit logs capture a record of database activity, including login attempts, data modifications, schema changes, and other events that can be audited for security and compliance purposes. When you configure an Aurora MySQL DB cluster to publish audit logs to a log group in Amazon CloudWatch Logs, you can perform real-time analysis of the log data. CloudWatch Logs retains logs in highly durable storage. You can also create alarms and view metrics in CloudWatch."
RDS.35,RDS DB clusters should have automatic minor version upgrade enabled,"NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-2(2), NIST.800-53.r5 SI-2(4), NIST.800-53.r5 SI-2(5)","Detect > Vulnerability, patch, and version management",Medium,AWS::RDS::DBCluster,rds-cluster-auto-minor-version-upgrade-enable,Change triggered,None," This control checks if automatic minor version upgrade is enabled for an Amazon RDS database cluster. The control fails if automatic minor version upgrade isn't enabled for an RDS cluster. RDS provides automatic minor version upgrade so that you can keep your RDS database cluster up to date. Minor versions can introduce new software features, bug fixes, security patches, and performance improvements. By enabling automatic minor version upgrade on RDS database clusters, the cluster, along with the instances in the cluster, will receive automatic updates to the minor version when new versions are available. The updates are applied automatically during the maintenance window."
Redshift.1,Amazon Redshift clusters should prohibit public access,"PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.2, PCI DSS v3.2.1/1.3.4, PCI DSS v3.2.1/1.3.6, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > Resources not publicly accessible,Critical,AWS::Redshift::Cluster,redshift-cluster-public-access-check,Change triggered,None," This control checks whether Amazon Redshift clusters are publicly accessible. It evaluates the   PubliclyAccessible   field in the cluster configuration item. The   PubliclyAccessible   attribute of the Amazon Redshift cluster configuration indicates whether the cluster is publicly accessible. When the cluster is configured with   PubliclyAccessible   set to   true   , it is an Internet-facing instance that has a publicly resolvable DNS name, which resolves to a public IP address. When the cluster is not publicly accessible, it is an internal instance with a DNS name that resolves to a private IP address. Unless you intend for your cluster to be publicly accessible, the cluster should not be configured with   PubliclyAccessible   set to   true   ."
Redshift.2,Connections to Amazon Redshift clusters should be encrypted in transit,"NIST.800-53.r5 AC-4, NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2)",Protect > Data protection > Encryption of data in transit,Medium,AWS::Redshift::Cluster,redshift-require-tls-ssl,Change triggered,None, This control checks whether connections to Amazon Redshift clusters are required to use encryption in transit. The check fails if the Amazon Redshift cluster parameter   require_SSL   isn't set to   True   . TLS can be used to help prevent potential attackers from using person-in-the-middle or similar attacks to eavesdrop on or manipulate network traffic. Only encrypted connections over TLS should be allowed. Encrypting data in transit can affect performance. You should test your application with this feature to understand the performance profile and the impact of TLS.
Redshift.3,Amazon Redshift clusters should have automatic snapshots enabled,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6, NIST.800-53.r5 CP-6(1), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-13(5)",Recover > Resilience > Backups enabled,Medium,AWS::Redshift::Cluster,redshift-backup-enabled,Change triggered,," This control checks whether an Amazon Redshift cluster has automated snapshots enabled, and a retention period greater than or equal to the specified time frame. The control fails if automated snapshots aren't enabled for the cluster, or if the retention period is less than the specified time frame. Unless you provide a custom parameter value for the snapshot retention period, Security Hub uses a default value of 7 days. Backups help you to recover more quickly from a security incident. They strengthen the resilience of your systems. Amazon Redshift takes periodic snapshots by default. This control checks whether automatic snapshots are enabled and retained for at least seven days. For more details on Amazon Redshift automated snapshots, see   Automated snapshots   in the   Amazon Redshift Management Guide   ."
Redshift.4,Amazon Redshift clusters should have audit logging enabled,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::Redshift::Cluster,redshift-cluster-audit-logging-enabled   (custom Security Hub rule),Change triggered,," This control checks whether an Amazon Redshift cluster has audit logging enabled. Amazon Redshift audit logging provides additional information about connections and user activities in your cluster. This data can be stored and secured in Amazon S3 and can be helpful in security audits and investigations. For more information, see   Database audit logging   in the   Amazon Redshift Management Guide   ."
Redshift.6,Amazon Redshift should have automatic upgrades to major versions enabled,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-2(2), NIST.800-53.r5 SI-2(4), NIST.800-53.r5 SI-2(5)",Detect > Vulnerability and patch management,Medium,AWS::Redshift::Cluster,redshift-cluster-maintenancesettings-check,Change triggered,, This control checks whether automatic major version upgrades are enabled for the Amazon Redshift cluster. Enabling automatic major version upgrades ensures that the latest major version updates to Amazon Redshift clusters are installed during the maintenance window. These updates might include security patches and bug fixes. Keeping up to date with patch installation is an important step in securing systems.
Redshift.7,Redshift clusters should use enhanced VPC routing,"NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > API private access,Medium,AWS::Redshift::Cluster,redshift-enhanced-vpc-routing-enabled,Change triggered,None, This control checks whether an Amazon Redshift cluster has   EnhancedVpcRouting   enabled. Enhanced VPC routing forces all   COPY   and   UNLOAD   traffic between the cluster and data repositories to go through your VPC. You can then use VPC features such as security groups and network access control lists to secure network traffic. You can also use VPC Flow Logs to monitor network traffic.
Redshift.8,Amazon Redshift clusters should not use the default Admin username,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Identify > Resource Configuration,Medium,AWS::Redshift::Cluster,redshift-default-admin-check,Change triggered,None," This control checks whether an Amazon Redshift cluster has changed the admin username from its default value. This control will fail if the admin username for a Redshift cluster is set to   awsuser   . When creating a Redshift cluster, you should change the default admin username to a unique value. Default usernames are public knowledge and should be changed upon configuration. Changing the default usernames reduces the risk of unintended access."
Redshift.9,Redshift clusters should not use the default database name,,Identify > Resource Configuration,Medium,AWS::Redshift::Cluster,redshift-default-db-name-check,Change triggered,None," This control checks whether an Amazon Redshift cluster has changed the database name from its default value. The control will fail if the database name for a Redshift cluster is set to   dev   . When creating a Redshift cluster, you should change the default database name to a unique value. Default names are public knowledge and should be changed upon configuration. As an example, a well-known name could lead to inadvertent access if it was used in IAM policy conditions."
Redshift.10,Redshift clusters should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::Redshift::Cluster,redshift-cluster-kms-enabled,Change triggered,None," This control checks if Amazon Redshift clusters are encrypted at rest. The control fails if a Redshift cluster isn't encrypted at rest or if the encryption key is different from the provided key in the rule parameter. In Amazon Redshift, you can turn on database encryption for your clusters to help protect data at rest. When you turn on encryption for a cluster, the data blocks and system metadata are encrypted for the cluster and its snapshots. Encryption of data at rest is a recommended best practice because it adds a layer of access management to your data. Encrypting Redshift clusters at rest reduces the risk that an unauthorized user can access the data stored on disk."
Route53.2,RouteÂ 53 public hosted zones should log DNS queries,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::Route53::HostedZone,route53-query-logging-enabled,Change triggered,None," This control checks if DNS query logging is enabled for an Amazon RouteÂ 53 public hosted zone. The control fails if DNS query logging isn't enabled for a RouteÂ 53 public hosted zone. Logging DNS queries for a RouteÂ 53 hosted zone addresses DNS security and compliance requirements and grants visibility. The logs include information such as the domain or subdomain that was queried, the date and time of the query, the DNS record type (for example, A or AAAA), and the DNS response code (for example,   NoError   or   ServFail   ). When DNS query logging is enabled, RouteÂ 53 publishes the log files to Amazon CloudWatch Logs."
S3.1,S3 Block Public Access setting should be enabled,"PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.2, PCI DSS v3.2.1/1.3.4, PCI DSS v3.2.1/1.3.6, CIS AWS Foundations Benchmark v1.4.0/2.1.5, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,Medium,AWS::::Account,s3-account-level-public-access-blocks-periodic,Periodic,," This control checks whether the preceding Amazon S3 public access block settings are configured at the account level. The control fails if one or more of the public access block settings are set to   false   . The control fails if any of the settings are set to   false   , or if any of the settings are not configured. Amazon S3 public access block is designed to provide controls across an entire AWS account or at the individual S3 bucket level to ensure that objects never have public access. Public access is granted to buckets and objects through access control lists (ACLs), bucket policies, or both. Unless you intend to have your S3 buckets be publicly accessible, you should configure the account level Amazon S3 Block Public Access feature. To learn more, see   Using Amazon S3 Block Public Access   in the   Amazon Simple Storage Service User Guide   ."
S3.2,S3 buckets should prohibit public read access,"PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.2, PCI DSS v3.2.1/1.3.6, PCI DSS v3.2.1/7.2.1, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,Critical,AWS::S3::Bucket,s3-bucket-public-read-prohibited,Periodic and change triggered,None," This control checks whether your S3 buckets allow public read access. It evaluates the block public access settings, the bucket policy, and the bucket access control list (ACL). The control fails if an Amazon S3 bucket permits public read access. Some use cases may require that everyone on the internet be able to read from your S3 bucket. However, those situations are rare. To ensure the integrity and security of your data, your S3 bucket should not be publicly readable."
S3.3,S3 buckets should prohibit public write access,"PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.2, PCI DSS v3.2.1/1.3.4, PCI DSS v3.2.1/1.3.6, PCI DSS v3.2.1/7.2.1, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,Critical,AWS::S3::Bucket,s3-bucket-public-write-prohibited,Periodic and change triggered,None," This control checks whether your S3 buckets allow public write access. It evaluates the block public access settings, the bucket policy, and the bucket access control list (ACL). The control fails if an Amazon S3 bucket permits public write access. Some use cases require that everyone on the internet be able to write to your S3 bucket. However, those situations are rare. To ensure the integrity and security of your data, your S3 bucket should not be publicly writable."
S3.5,S3 buckets should require requests to use Secure Socket Layer,"PCI DSS v3.2.1/4.1, CIS AWS Foundations Benchmark v1.4.0/2.1.2, NIST.800-53.r5 AC-17(2), NIST.800-53.r5 AC-4, NIST.800-53.r5 IA-5(1), NIST.800-53.r5 SC-12(3), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-23, NIST.800-53.r5 SC-23(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-8, NIST.800-53.r5 SC-8(1), NIST.800-53.r5 SC-8(2), NIST.800-53.r5 SI-7(6)",Protect > Secure access management,Medium,AWS::S3::Bucket,s3-bucket-ssl-requests-only,Change triggered,None, This control checks whether S3 buckets have policies that require requests to use Secure Socket Layer (SSL).
S3.6,S3 permissions granted to other AWS accounts in bucket policies should be restricted,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure access management > Sensitive API operations actions restricted,High,AWS::S3::Bucket,,Change triggered,," This control checks whether the S3 bucket policy prevents principals from other AWS accounts from performing denied actions on resources in the S3 bucket. The control fails if the S3 bucket policy allows one or more of the preceding actions for a principal in another AWS account. Implementing least privilege access is fundamental to reducing security risk and the impact of errors or malicious intent. If an S3 bucket policy allows access from external accounts, it could result in data exfiltration by an insider threat or an attacker. The   blacklistedactionpatterns   parameter allows for successful evaluation of the rule for S3 buckets. The parameter grants access to external accounts for action patterns that are not included in the   blacklistedactionpatterns   list."
S3.7,S3 buckets should have cross-Region replication enabled,"PCI DSS v3.2.1/2.2, NIST.800-53.r5 AU-9(2), NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6, NIST.800-53.r5 CP-6(1), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-36(2), NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Protect > Secure access management,Low,AWS::S3::Bucket,s3-bucket-replication-enabled,Change triggered,," This control checks whether an Amazon S3 bucket has Cross-Region Replication enabled. The control fails if the bucket doesn't have Cross-Region Replication enabled or if Same-Region Replication is also enabled. Replication is the automatic, asynchronous copying of objects across buckets in the same or different AWS Regions. Replication copies newly created objects and object updates from a source bucket to a destination bucket or buckets. AWS best practices recommend replication for source and destination buckets that are owned by the same AWS account. In addition to availability, you should consider other systems hardening settings."
S3.8,S3 Block Public Access setting should be enabled at the bucket-level,"CIS AWS Foundations Benchmark v1.4.0/2.1.5, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure access management > Access control,High,AWS::S3::Bucket,s3-bucket-level-public-access-prohibited,Change triggered,," Block Public Access at the S3 bucket level provides controls to ensure that objects never have public access. Public access is granted to buckets and objects through access control lists (ACLs), bucket policies, or both. Unless you intend to have your S3 buckets publicly accessible, you should configure the bucket level Amazon S3 Block Public Access feature."
S3.9,S3 bucket server access logging should be enabled,"NIST.800-53.r5 AC-2(4), NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AC-6(9), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4(20), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::S3::Bucket,s3-bucket-logging-enabled,Change triggered,None," This control checks whether server access logging is enabled for S3 buckets. When logging is enabled, Amazon S3 delivers access logs for a source bucket to a chosen target bucket. The target bucket must be in the same AWS Region as the source bucket and must not have a default retention period configuration. This control passes if server access logging is enabled. The target logging bucket does not need to have server access logging enabled, and you should suppress findings for this bucket."
S3.10,S3 buckets with versioning enabled should have lifecycle policies configured,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Identify > Logging,Medium,AWS::S3::Bucket,s3-version-lifecycle-policy-check,Change triggered,None, This control checks if Amazon Simple Storage Service (Amazon S3) version enabled buckets have lifecycle policy configured. This rule fails if Amazon S3 lifecycle policy is not enabled. It is recommended to configure lifecycle rules on your Amazon S3 bucket as these rules help you define actions that you want Amazon S3 to take during an object's lifetime.
S3.11,S3 buckets should have event notifications enabled,"NIST.800-53.r5 CA-7, NIST.800-53.r5 SI-3(8), NIST.800-53.r5 SI-4, NIST.800-53.r5 SI-4(4)",Identify > Logging,Medium,AWS::S3::Bucket,s3-event-notifications-enabled,Change triggered,," This control checks whether S3 Event Notifications are enabled on an Amazon Simple Storage Service (Amazon S3) bucket. The control fails if S3 Event Notifications are not enabled on a bucket. If you provide custom values for the   eventTypes   parameter, the control passes only if Event Notifications are enabled for the specified types of events. By enabling Event Notifications, you receive alerts on your Amazon S3 buckets when specific events occur. For example, you can be notified of object creation, object removal, and object restoration. These notifications can alert relevant teams to accidental or intentional modifications that may lead to unauthorized data access."
S3.12,S3 access control lists (ACLs) should not be used to manage user access to buckets,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6",Protect > Secure access management > Access control,Medium,AWS::S3::Bucket,s3-bucket-acl-prohibited,Change triggered,None," This control checks whether Amazon S3 buckets provide user permissions via ACLs. The control fails if ACLs are configured for managing user access on S3 buckets. ACLs are legacy access control mechanisms that predate IAM. Instead of ACLs, we recommend using IAM policies or S3 bucket policies to more easily manage access to your S3 buckets."
S3.13,S3 buckets should have lifecycle policies configured,"NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-13(5)",Protect > Data protection,Low,AWS::S3::Bucket,s3-lifecycle-policy-check,Change triggered,," This control checks whether a lifecycle policy is configured for an Amazon Simple Storage Service (Amazon S3) bucket. The control fails if a lifecycle policy isn't configured for an S3 bucket. If you provide custom values for one or more of the preceding parameters, the control passes only if the policy includes the specified storage class, deletion time, or transition time. Configuring lifecycle rules on your S3 bucket defines actions that you want S3 to take during an object's lifetime. For example, you can transition objects to another storage class, archive them, or delete them after a specified period of time."
S3.14,S3 buckets should use versioning,"NIST.800-53.r5 AU-9(2), NIST.800-53.r5 CP-10, NIST.800-53.r5 CP-6, NIST.800-53.r5 CP-6(1), NIST.800-53.r5 CP-6(2), NIST.800-53.r5 CP-9, NIST.800-53.r5 SC-5(2), NIST.800-53.r5 SI-12, NIST.800-53.r5 SI-13(5)",Protect > Data protection > Data deletion protection,Low,AWS::S3::Bucket,s3-bucket-versioning-enabled,Change triggered,None," This control checks if your Amazon S3 buckets use versioning. The control fails if versioning is suspended for an S3 bucket. Versioning keeps multiple variants of an object in the same S3 bucket. You can use versioning to preserve, retrieve, and restore earlier versions of an object stored in your S3 bucket. Versioning helps you recover from both unintended user actions and application failures."
S3.15,S3 buckets should be configured to use Object Lock,NIST.800-53.r5 CP-6(2),Protect > Data protection > Data deletion protection,Medium,AWS::S3::Bucket,s3-bucket-default-lock-enabled,Change triggered,," This control checks if an Amazon S3 bucket has been configured to use Object Lock. The control fails if the S3 bucket isn't configured to use Object Lock. If you provide a custom value for the   mode   parameter, the control passes only if S3 Object Lock uses the specified retention mode. You can use S3 Object Lock to store objects using a write-once-read-many (WORM) model. Object Lock can help prevent objects in S3 buckets from being deleted or overwritten for a fixed amount of time or indefinitely. You can use S3 Object Lock to meet regulatory requirements that require WORM storage, or add an extra layer of protection against object changes and deletion."
S3.17,S3 buckets should be encrypted at rest with AWS KMS keys,"NIST.800-53.r5 SC-12(2), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 CA-9(1), NIST.800-53.r5 SI-7(6), NIST.800-53.r5 AU-9",Protect > Data protection > Encryption of data at rest,Medium,AWS::S3::Bucket,s3-default-encryption-kms,Change triggered,None," This control checks if an Amazon S3 bucket is encrypted with an AWS KMS key (SSE-KMS or DSSE-KMS). The control fails if an S3 bucket is encrypted with default encryption (SSE-S3). Server-side encryption (SSE) is the encryption of data at its destination by the application or service that receives it. Unless you specify otherwise, S3 buckets use Amazon S3 managed keys (SSE-S3) by default for server-side encryption. However, for added control, you can choose to configure buckets to use server-side encryption with AWS KMS keys (SSE-KMS or DSSE-KMS) instead. Amazon S3 encrypts your data at the object level as it writes it to disks in AWS data centers and decrypts it for you when you access it."
S3.19,S3 access points should have block public access settings enabled,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure access management > Resource not publicly accessible,Critical,AWS::S3::AccessPoint,s3-access-point-public-access-blocks,Change triggered,None, This control checks whether an Amazon S3 access point has block public access settings enabled. The control fails if block public access settings aren't enabled for the access point.
S3.20,S3 general purpose buckets should have MFA delete enabled,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2), NIST.800-53.r5 CM-3, NIST.800-53.r5 SC-5(2)",Protect > Data protection > Data deletion protection,Low,AWS::S3::Bucket,s3-bucket-mfa-delete-enabled,Change triggered,None," This control checks if multi-factor authentication (MFA) delete is enabled on an Amazon S3 general purpose bucket. The control fails if MFA delete is not enabled on the bucket. When working with S3 Versioning in Amazon S3 buckets, you can optionally add another layer of security by configuring a bucket to enable MFA delete. When you do this, the bucket owner must include two forms of authentication in any request to delete a version or change the versioning state of the bucket. MFA delete provides added security if your security credentials are compromised. MFA delete can also help prevent accidental bucket deletions by requiring the user who initiates the delete action to prove physical possession of an MFA device with an MFA code and adding an extra layer of friction and security to the delete action."
SageMaker.1,Amazon SageMaker notebook instances should not have direct internet access,"PCI DSS v3.2.1/1.2.1, PCI DSS v3.2.1/1.3.1, PCI DSS v3.2.1/1.3.2, PCI DSS v3.2.1/1.3.4, PCI DSS v3.2.1/1.3.6, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration,High,AWS::SageMaker::NotebookInstance,sagemaker-notebook-no-direct-internet-access,Periodic,None," This control checks whether direct internet access is disabled for an SageMaker notebook instance. To do this, it checks whether the   DirectInternetAccess   field is disabled for the notebook instance. If you configure your SageMaker instance without a VPC, then by default direct internet access is enabled on your instance. You should configure your instance with a VPC and change the default setting to   DisableâAccess the internet through a VPC   . To train or host models from a notebook, you need internet access. To enable internet access, make sure that your VPC has a NAT gateway and your security group allows outbound connections. To learn more about how to connect a notebook instance to resources in a VPC, see   Connect a notebook instance to resources in a VPC   in the   Amazon SageMaker Developer Guide   . You should also ensure that access to your SageMaker configuration is limited to only authorized users. Restrict IAM permissions that permit users to change SageMaker settings and resources."
SageMaker.2,SageMaker notebook instances should be launched in a custom VPC,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > Resources within VPC,High,AWS::SageMaker::NotebookInstance,sagemaker-notebook-instance-inside-vpc,Change triggered,None," This control checks if an Amazon SageMaker notebook instance is launched within a custom virtual private cloud (VPC). This control fails if a SageMaker notebook instance is not launched within a custom VPC or if it is launched in the SageMaker service VPC. Subnets are a range of IP addresses within a VPC. We recommend keeping your resources inside a custom VPC whenever possible to ensure secure network protection of your infrastructure. An Amazon VPC is a virtual network dedicated to your AWS account. With an Amazon VPC, you can control the network access and internet connectivity of your SageMaker Studio and notebook instances."
SageMaker.3,Users should not have root access to SageMaker notebook instances,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3(15), NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-6, NIST.800-53.r5 AC-6(10), NIST.800-53.r5 AC-6(2)",Protect > Secure access management > Root user access restrictions,High,AWS::SageMaker::NotebookInstance,sagemaker-notebook-instance-root-access-check,Change triggered,None," This control checks whether root access is turned on for an Amazon SageMaker notebook instance. The control fails if root access is turned on for a SageMaker notebook instance. In adherence to the principal of least privilege, it is a recommended security best practice to restrict root access to instance resources to avoid unintentionally over provisioning permissions."
SecretsManager.1,Secrets Manager secrets should have automatic rotation enabled,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3(15)",Protect > Secure development,Medium,AWS::SecretsManager::Secret,secretsmanager-rotation-enabled-check,Change triggered,," This control checks whether a secret stored in AWS Secrets Manager is configured with automatic rotation. The control fails if the secret isn't configured with automatic rotation. If you provide a custom value for the   maximumAllowedRotationFrequency   parameter, the control passes only if the secret is automatically rotated within the specified window of time. Secrets Manager helps you improve the security posture of your organization. Secrets include database credentials, passwords, and third-party API keys. You can use Secrets Manager to store secrets centrally, encrypt secrets automatically, control access to secrets, and rotate secrets safely and automatically. Secrets Manager can rotate secrets. You can use rotation to replace long-term secrets with short-term ones. Rotating your secrets limits how long an unauthorized user can use a compromised secret. For this reason, you should rotate your secrets frequently. To learn more about rotation, see   Rotating your AWS Secrets Manager secrets   in the   AWS Secrets Manager User Guide   ."
SecretsManager.2,Secrets Manager secrets configured with automatic rotation should rotate successfully,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3(15)",Protect > Secure development,Medium,AWS::SecretsManager::Secret,secretsmanager-scheduled-rotation-success-check,Change triggered,None," This control checks whether an AWS Secrets Manager secret rotated successfully based on the rotation schedule. The control fails if   RotationOccurringAsScheduled   is   false   . The control only evaluates secrets that have rotation turned on. Secrets Manager helps you improve the security posture of your organization. Secrets include database credentials, passwords, and third-party API keys. You can use Secrets Manager to store secrets centrally, encrypt secrets automatically, control access to secrets, and rotate secrets safely and automatically. Secrets Manager can rotate secrets. You can use rotation to replace long-term secrets with short-term ones. Rotating your secrets limits how long an unauthorized user can use a compromised secret. For this reason, you should rotate your secrets frequently. In addition to configuring secrets to rotate automatically, you should ensure that those secrets rotate successfully based on the rotation schedule. To learn more about rotation, see   Rotating your AWS Secrets Manager secrets   in the   AWS Secrets Manager User Guide   ."
SecretsManager.3,Remove unused Secrets Manager secrets,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3(15)",Protect > Secure access management,Medium,AWS::SecretsManager::Secret,secretsmanager-secret-unused,Periodic,," This control checks whether an AWS Secrets Manager secret has been accessed within the specified time frame. The control fails if a secret is unused beyond the specified time frame. Unless you provide a custom parameter value for the access period, Security Hub uses a default value of 90 days. Deleting unused secrets is as important as rotating secrets. Unused secrets can be abused by their former users, who no longer need access to these secrets. Also, as more users get access to a secret, someone might have mishandled and leaked it to an unauthorized entity, which increases the risk of abuse. Deleting unused secrets helps revoke secret access from users who no longer need it. It also helps to reduce the cost of using Secrets Manager. Therefore, it is essential to routinely delete unused secrets."
SecretsManager.4,Secrets Manager secrets should be rotated within a specified number of days,"NIST.800-53.r5 AC-2(1), NIST.800-53.r5 AC-3(15)",Protect > Secure access management,Medium,AWS::SecretsManager::Secret,secretsmanager-secret-periodic-rotation,Periodic,," This control checks whether an AWS Secrets Manager secret is rotated at least once within the specified time frame. The control fails if a secret isn't rotated at least this frequently. Unless you provide a custom parameter value for the rotation period, Security Hub uses a default value of 90 days. Rotating secrets can help you to reduce the risk of an unauthorized use of your secrets in your AWS account. Examples include database credentials, passwords, third-party API keys, and even arbitrary text. If you do not change your secrets for a long period of time, the secrets are more likely to be compromised. As more users get access to a secret, it can become more likely that someone mishandled and leaked it to an unauthorized entity. Secrets can be leaked through logs and cache data. They can be shared for debugging purposes and not changed or revoked once the debugging completes. For all these reasons, secrets should be rotated frequently. You can configure automatic rotation for secrets in AWS Secrets Manager. With automatic rotation, you can replace long-term secrets with short-term ones, significantly reducing the risk of compromise. We recommend that you configure automatic rotation for your Secrets Manager secrets. For more information, see   Rotating your AWS Secrets Manager secrets   in the   AWS Secrets Manager User Guide   ."
SNS.1,SNS topics should be encrypted at-rest using AWS KMS,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::SNS::Topic,sns-encrypted-kms,Change triggered,None," This control checks whether an SNS topic is encrypted at rest using AWS KMS. The controls fails if an SNS topic doesn't use a KMS key for server-side encryption (SSE). Encrypting data at rest reduces the risk of data stored on disk being accessed by a user not authenticated to AWS. It also adds another set of access controls to limit the ability of unauthorized users to access the data. For example, API permissions are required to decrypt the data before it can be read. SNS topics should be encrypted at-rest for an added layer of security."
SNS.2,Logging of delivery status should be enabled for notification messages sent to a topic,"NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2",Identify > Logging,Medium,AWS::SNS::Topic,sns-topic-message-delivery-notification-enabled,Change triggered,None, This control checks whether logging is enabled for the delivery status of notification messages sent to an Amazon SNS topic for the endpoints. This control fails if the delivery status notification for messages is not enabled.
SQS.1,Amazon SQS queues should be encrypted at rest,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-3(6), NIST.800-53.r5 SC-13, NIST.800-53.r5 SC-28, NIST.800-53.r5 SC-28(1), NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SI-7(6)",Protect > Data protection > Encryption of data at rest,Medium,AWS::SQS::Queue,sqs-queue-encrypted   (custom Security Hub rule),Change triggered,None, This control checks whether an Amazon SQS queue is encrypted at rest. The control fails if the queue isn't encrypted with an SQS-managed key (SSE-SQS) or an AWS Key Management Service (AWS KMS) key (SSE-KMS). Encrypting data at rest reduces the risk of an unauthorized user accessing data stored on disk. Server-side encryption (SSE) protects the contents of messages in SQS queues using SQS-managed encryption keys (SSE-SQS) or AWS KMS keys (SSE-KMS).
SSM.1,Amazon EC2 instances should be managed by AWS Systems Manager,"PCI DSS v3.2.1/2.4, NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2), NIST.800-53.r5 CM-8, NIST.800-53.r5 CM-8(1), NIST.800-53.r5 CM-8(2), NIST.800-53.r5 CM-8(3), NIST.800-53.r5 SA-15(2), NIST.800-53.r5 SA-15(8), NIST.800-53.r5 SA-3, NIST.800-53.r5 SI-2(3)",Identify > Inventory,Medium,,ec2-instance-managed-by-systems-manager,Change triggered,None," This control checks whether the stopped and running EC2 instances in your account are managed by AWS Systems Manager. Systems Manager is an AWS service that you can use to view and control your AWS infrastructure. To help you to maintain security and compliance, Systems Manager scans your stopped and running managed instances. A managed instance is a machine that is configured for use with Systems Manager. Systems Manager then reports or takes corrective action on any policy violations that it detects. Systems Manager also helps you to configure and maintain your managed instances. To learn more, see   AWS Systems Manager User Guide   ."
SSM.2,Amazon EC2 instances managed by Systems Manager should have a patch compliance status of COMPLIANT after a patch installation,"PCI DSS v3.2.1/6.2, NIST.800-53.r5 CM-8(3), NIST.800-53.r5 SI-2, NIST.800-53.r5 SI-2(2), NIST.800-53.r5 SI-2(3), NIST.800-53.r5 SI-2(4), NIST.800-53.r5 SI-2(5)",Detect > Detection services,High,AWS::SSM::PatchCompliance,ec2-managedinstance-patch-compliance-status-check,Change triggered,None, This control checks whether the compliance status of Systems Manager patch compliance is   COMPLIANT   or   NON_COMPLIANT   after the patch installation on the instance. The control fails if the compliance status is   NON_COMPLIANT   . The control only checks instances that are managed by Systems Manager Patch Manager. Patching your EC2 instances as required by your organization reduces the attack surface of your AWS accounts.
SSM.3,Amazon EC2 instances managed by Systems Manager should have an association compliance status of COMPLIANT,"PCI DSS v3.2.1/2.4, NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2, NIST.800-53.r5 CM-2(2), NIST.800-53.r5 CM-8, NIST.800-53.r5 CM-8(1), NIST.800-53.r5 CM-8(3), NIST.800-53.r5 SI-2(3)",Detect > Detection services,Low,AWS::SSM::AssociationCompliance,ec2-managedinstance-association-compliance-status-check,Change triggered,None," This control checks whether the status of the AWS Systems Manager association compliance is   COMPLIANT   or   NON_COMPLIANT   after the association is run on an instance. The control fails if the association compliance status is   NON_COMPLIANT   . A State Manager association is a configuration that is assigned to your managed instances. The configuration defines the state that you want to maintain on your instances. For example, an association can specify that antivirus software must be installed and running on your instances or that certain ports must be closed. After you create one or more State Manager associations, compliance status information is immediately available to you. You can view the compliance status in the console or in response to AWS CLI commands or corresponding Systems Manager API actions. For associations, Configuration Compliance shows the compliance status (   Compliant   or   Non-compliant   ). It also shows the severity level assigned to the association, such as   Critical   or   Medium   . To learn more about State Manager association compliance, see   About State Manager association compliance   in the   AWS Systems Manager User Guide   ."
SSM.4,SSM documents should not be public,"NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)",Protect > Secure network configuration > Resources not publicly accessible,Critical,AWS::SSM::Document,ssm-document-not-public,Periodic,None," This control checks whether AWS Systems Manager documents that are owned by the account are public. This control fails if SSM documents with the owner   Self   are public. SSM documents that are public might allow unintended access to your documents. A public SSM document can expose valuable information about your account, resources, and internal processes. Unless your use case requires public sharing, we recommend that you block public sharing setting for Systems Manager documents that are owned by   Self   ."
StepFunctions.1,Step Functions state machines should have logging turned on,,Identify > Logging,Medium,AWS::StepFunctions::StateMachine,step-functions-state-machine-logging-enabled,Change triggered,," This controls checks whether an AWS Step Functions state machine has logging turned on. The control fails if a state machine doesn't have logging turned on. If you provide a custom value for the   logLevel   parameter, the control passes only if the state machine has the specified logging level turned on. Monitoring helps you maintain the reliability, availability, and performance of Step Functions. You should collect as much monitoring data from the AWS services that you use so you can more easily debug multi-point failures. Having a logging configuration defined for your Step Functions state machines allows for you to track execution history and results in Amazon CloudWatch Logs. Optionally, you can track only errors or fatal events."
WAF.1,AWS WAF Classic Global Web ACL logging should be enabled,"NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::WAF::WebACL,waf-classic-logging-enabled,Periodic,None," This control checks whether logging is enabled for an AWS WAF global web ACL. This control fails if logging is not enabled for the web ACL. Logging is an important part of maintaining the reliability, availability, and performance of AWS WAF globally. It is a business and compliance requirement in many organizations, and allows you to troubleshoot application behavior. It also provides detailed information about the traffic that is analyzed by the web ACL that is attached to AWS WAF."
WAF.2,AWS WAF Classic Regional rules should have at least one condition,"NIST.800-53.r5 AC-4(21), NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21)",Protect > Secure network configuration,Medium,AWS::WAFRegional::Rule,waf-regional-rule-not-empty,Change triggered,None," This control checks whether an AWS WAF Regional rule has at least one condition. The control fails if no conditions are present within a rule. A WAF Regional rule can contain multiple conditions. The rule's conditions allow for traffic inspection and take a defined action (allow, block, or count). Without any conditions, the traffic passes without inspection. A WAF Regional rule with no conditions, but with a name or tag suggesting allow, block, or count, could lead to the wrong assumption that one of those actions is occurring."
WAF.3,AWS WAF Classic Regional rule groups should have at least one rule,"NIST.800-53.r5 AC-4(21), NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21)",Protect > Secure network configuration,Medium,AWS::WAFRegional::RuleGroup,waf-regional-rulegroup-not-empty,Change triggered,None," This control checks whether an AWS WAF Regional rule group has at least one rule. The control fails if no rules are present within a rule group. A WAF Regional rule group can contain multiple rules. The rule's conditions allow for traffic inspection and take a defined action (allow, block, or count). Without any rules, the traffic passes without inspection. A WAF Regional rule group with no rules, but with a name or tag suggesting allow, block, or count, could lead to the wrong assumption that one of those actions is occurring."
WAF.4,AWS WAF Classic Regional web ACLs should have at least one rule or rule group,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure network configuration,Medium,AWS::WAFRegional::WebACL,waf-regional-webacl-not-empty,Change triggered,None," This control checks whether an AWS WAF Classic Regional web ACL contains any WAF rules or WAF rule groups. This control fails if a web ACL does not contain any WAF rules or rule groups. A WAF Regional web ACL can contain a collection of rules and rule groups that inspect and control web requests. If a web ACL is empty, the web traffic can pass without being detected or acted upon by WAF depending on the default action."
WAF.6,AWS WAF Classic global rules should have at least one condition,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure network configuration,Medium,AWS::WAF::Rule,waf-global-rule-not-empty,Change triggered,None," This control checks whether an AWS WAF global rule contains any conditions. The control fails if no conditions are present within a rule. A WAF global rule can contain multiple conditions. A rule's conditions allow for traffic inspection and take a defined action (allow, block, or count). Without any conditions, the traffic passes without inspection. A WAF global rule with no conditions, but with a name or tag suggesting allow, block, or count, could lead to the wrong assumption that one of those actions is occurring."
WAF.7,AWS WAF Classic global rule groups should have at least one rule,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure network configuration,Medium,AWS::WAF::RuleGroup,waf-global-rulegroup-not-empty,Change triggered,None," This control checks whether an AWS WAF global rule group has at least one rule. The control fails if no rules are present within a rule group. A WAF global rule group can contain multiple rules. The rule's conditions allow for traffic inspection and take a defined action (allow, block, or count). Without any rules, the traffic passes without inspection. A WAF global rule group with no rules, but with a name or tag suggesting allow, block, or count, could lead to the wrong assumption that one of those actions is occurring."
WAF.8,AWS WAF Classic global web ACLs should have at least one rule or rule group,"NIST.800-53.r5 AC-4(21), NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(21)",Protect > Secure network configuration,Medium,AWS::WAF::WebACL,waf-global-webacl-not-empty,Change triggered,None," This control checks whether an AWS WAF global web ACL contains at least one WAF rule or WAF rule group. The control fails if a web ACL does not contain any WAF rules or rule groups. A WAF global web ACL can contain a collection of rules and rule groups that inspect and control web requests. If a web ACL is empty, the web traffic can pass without being detected or acted upon by WAF depending on the default action."
WAF.10,AWS WAF web ACLs should have at least one rule or rule group,"NIST.800-53.r5 CA-9(1), NIST.800-53.r5 CM-2",Protect > Secure network configuration,Medium,AWS::WAFv2::WebACL,wafv2-webacl-not-empty,Change triggered,None," This control checks whether an AWS WAFV2 web access control list (web ACL) contains at least one rule or rule group. The control fails if a web ACL does not contain any rules or rule groups. A web ACL gives you fine-grained control over all of the HTTP(S) web requests that your protected resource responds to. A web ACL should contain a collection of rules and rule groups that inspect and control web requests. If a web ACL is empty, the web traffic can pass without being detected or acted upon by AWS WAF depending on the default action."
WAF.11,AWS WAF web ACL logging should be enabled,"NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-7(8)",Identify > Logging,Low,AWS::WAFv2::WebACL,wafv2-logging-enabled,Periodic,None," This control checks whether logging is activated for an AWS WAFV2 web access control list (web ACL). This control fails if logging is deactivated for the web ACL. Logging maintains the reliability, availability, and performance of AWS WAF. In addition, logging is a business and compliance requirement in many organizations. By logging traffic that's analyzed by your web ACL, you can troubleshoot application behavior."
WAF.12,AWS WAF rules should have CloudWatch metrics enabled,"NIST.800-53.r5 AC-4(26), NIST.800-53.r5 AU-10, NIST.800-53.r5 AU-12, NIST.800-53.r5 AU-2, NIST.800-53.r5 AU-3, NIST.800-53.r5 AU-6(3), NIST.800-53.r5 AU-6(4), NIST.800-53.r5 CA-7, NIST.800-53.r5 SC-7(10), NIST.800-53.r5 SC-7(9), NIST.800-53.r5 SI-7(8)",Identify > Logging,Medium,AWS::WAFv2::RuleGroup,wafv2-rulegroup-logging-enabled,Change triggered,None, This control checks whether an AWS WAF rule or rule group has Amazon CloudWatch metrics enabled. The control fails if the rule or rule group doesn't have CloudWatch metrics enabled. Configuring CloudWatch metrics on AWS WAF rules and rule groups provides visibility into traffic flow. You can see which ACL rules are triggered and which requests are accepted and blocked. This visibility can help you identify malicious activity on your associated resources.
